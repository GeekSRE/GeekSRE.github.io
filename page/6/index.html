<!DOCTYPE html>
<html lang="zh-Hans">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.1.1">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"yoursite.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":true,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},"path":"search.xml"};
  </script>

  <meta name="description" content="GeekSRE">
<meta property="og:type" content="website">
<meta property="og:title" content="GeekSRE">
<meta property="og:url" content="http://yoursite.com/page/6/index.html">
<meta property="og:site_name" content="GeekSRE">
<meta property="og:description" content="GeekSRE">
<meta property="og:locale">
<meta property="article:author" content="GeekSRE">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://yoursite.com/page/6/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'zh-Hans'
  };
</script>

  <title>GeekSRE</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">GeekSRE</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
        <i class="fa fa-search fa-fw fa-lg"></i>
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
      <li class="menu-item menu-item-search">
        <a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>Search
        </a>
      </li>
  </ul>
</nav>



  <div class="search-pop-overlay">
    <div class="popup search-popup">
        <div class="search-header">
  <span class="search-icon">
    <i class="fa fa-search"></i>
  </span>
  <div class="search-input-container">
    <input autocomplete="off" autocapitalize="off"
           placeholder="Searching..." spellcheck="false"
           type="search" class="search-input">
  </div>
  <span class="popup-btn-close">
    <i class="fa fa-times-circle"></i>
  </span>
</div>
<div id="search-result">
  <div id="no-result">
    <i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>
  </div>
</div>

    </div>
  </div>

</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>

  <a href="https://github.com/GeekSRE" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/%E8%AE%B0%E4%B8%80%E6%AC%A1Java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%AE%B9%E5%99%A8%E5%8C%96%E7%BB%B4%E6%8A%A4%E5%B7%A5%E4%BD%9C/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GeekSRE">
      <meta itemprop="description" content="GeekSRE">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GeekSRE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/%E8%AE%B0%E4%B8%80%E6%AC%A1Java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%AE%B9%E5%99%A8%E5%8C%96%E7%BB%B4%E6%8A%A4%E5%B7%A5%E4%BD%9C/" class="post-title-link" itemprop="url">è®°ä¸€æ¬¡Javaå¾®æœåŠ¡å®¹å™¨åŒ–ç»´æŠ¤å·¥ä½œ</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-04-28 16:44:38 / Modified: 16:50:36" itemprop="dateCreated datePublished" datetime="2019-04-28T16:44:38+08:00">2019-04-28</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h4 id="äº‹ä»¶èƒŒæ™¯"><a href="#äº‹ä»¶èƒŒæ™¯" class="headerlink" title="äº‹ä»¶èƒŒæ™¯"></a>äº‹ä»¶èƒŒæ™¯</h4><hr>
<p>å®¹å™¨æ¶æ„ç”±Swarmè¿ç§»åˆ°Kubernetes</p>
<p>Swarmé›†ç¾¤ä¸­æœåŠ¡å‘ç°ã€æœåŠ¡æ³¨å†Œä½¿ç”¨Consulï¼Œè¿ç§»åˆ°K8såæ³¨å†Œå‘ç°æ˜¯çš„K8sçš„kube-dnsåŸºç¡€ç»„ä»¶å®ç°ã€‚</p>
<p>utilservice-vcg-comè¿™ä¸ªå¾®æœåŠ¡éƒ¨ç½²åœ¨ä¸¤å°ecsä¸Šï¼Œjava -jar å¯åŠ¨å  æ‰‹åŠ¨æ³¨å†Œåˆ°consulä¸­ï¼Œè¿™æ ·å®ç°Swarmé›†ç¾¤ä¸­çš„åº”ç”¨å¯ä»¥é€šè¿‡Consulè®¿é—®utilæœåŠ¡ã€‚</p>
<h4 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h4><hr>
<p>ä¸ç›¸å…³ç ”å‘æ²Ÿé€šï¼Œç¡®å®šutilserviceç¨‹åºä¸€äº›åŸºç¡€ä¿¡æ¯ï¼šæ¯”å¦‚</p>
<p>â€‹    éœ€è¦å“ªäº›åŸºç¡€ç»„ä»¶ï¼Œåœ¨ecsä¸Šéƒ¨ç½²é‡åˆ°ä»€ä¹ˆé—®é¢˜ï¼Œå¦‚ä½•å¤„ç†çš„</p>
<p>â€‹    gitä»“åº“åœ°å€ã€æœåŠ¡å¯åŠ¨å‘½ä»¤ã€æœåŠ¡ç«¯å£ã€æ˜¯å¦è¿æ¥æ•°æ®åº“ã€æœåŠ¡è°ƒç”¨å…³ç³»ã€‚</p>
<p>ç¡®å®šä½¿ç”¨jdkç¯å¢ƒï¼Œéœ€è¦ä½¿ç”¨åˆ° wkhtmltopdf è¿™ä¸ªå‘½ä»¤ï¼Œç”¨äºç”Ÿæˆpdfï¼›</p>
<p>ç”Ÿæˆçš„pdfè¿‡ç¨‹ä¼šæœ‰ å­—ä½“å’Œè¯­è¨€çš„é—®é¢˜ï¼Œéœ€æå‰å¤„ç†ã€‚</p>
<h4 id="æ“ä½œ"><a href="#æ“ä½œ" class="headerlink" title="æ“ä½œ"></a>æ“ä½œ</h4><hr>
<h5 id="ç¡®å®šåŸºç¡€é•œåƒ"><a href="#ç¡®å®šåŸºç¡€é•œåƒ" class="headerlink" title="ç¡®å®šåŸºç¡€é•œåƒ"></a>ç¡®å®šåŸºç¡€é•œåƒ</h5><p>è®¿é—®<a target="_blank" rel="noopener" href="https://hub.docker.com/">https://hub.docker.com</a>ï¼Œæœç´¢ wkhtmltopdf å…³é”®è¯</p>
<p><img src="/%E8%AE%B0%E4%B8%80%E6%AC%A1Java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%AE%B9%E5%99%A8%E5%8C%96%E7%BB%B4%E6%8A%A4%E5%B7%A5%E4%BD%9C/1.png" alt="1"></p>
<p>ç¡®å®šåŸºç¡€é•œåƒä½¿ç”¨ buildo/java8-wkhtmltopdf ã€‚</p>
<h6 id="Dockerfile-ç¬¬ä¸€ç‰ˆ"><a href="#Dockerfile-ç¬¬ä¸€ç‰ˆ" class="headerlink" title="Dockerfile (ç¬¬ä¸€ç‰ˆ)"></a>Dockerfile (ç¬¬ä¸€ç‰ˆ)</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">FROM buildo&#x2F;java8-wkhtmltopdf</span><br></pre></td></tr></table></figure>
<h5 id="ä¸‹è½½JCE"><a href="#ä¸‹è½½JCE" class="headerlink" title="ä¸‹è½½JCE"></a>ä¸‹è½½JCE</h5><p>éœ€è¦ä½¿ç”¨åˆ°JCEï¼Œåœ¨oracleå®˜ç½‘ä¸‹è½½ã€‚</p>
<p>JDK7çš„ä¸‹è½½åœ°å€: <a target="_blank" rel="noopener" href="http://www.oracle.com/technetwork/java/javase/downloads/jce-7-download-432124.html">http://www.oracle.com/technetwork/java/javase/downloads/jce-7-download-432124.html</a><br>JDK8çš„ä¸‹è½½åœ°å€: <a target="_blank" rel="noopener" href="http://www.oracle.com/technetwork/java/javase/downloads/jce8-download-2133166.html">http://www.oracle.com/technetwork/java/javase/downloads/jce8-download-2133166.html</a></p>
<p>Java Cryptography Extension (JCE) æ— é™å¼ºåº¦æƒé™ç­–ç•¥æ–‡ä»¶ 8 ä¸‹è½½</p>
<h6 id="Dockerfile-ç¬¬äºŒç‰ˆ"><a href="#Dockerfile-ç¬¬äºŒç‰ˆ" class="headerlink" title="Dockerfile (ç¬¬äºŒç‰ˆ)"></a>Dockerfile (ç¬¬äºŒç‰ˆ)</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">FROM buildo&#x2F;java8-wkhtmltopdf</span><br><span class="line">MAINTAINER hongye.zhao@vcg.com</span><br><span class="line">RUN mkdir -p &#x2F;application&#x2F;</span><br><span class="line">WORKDIR &#x2F;application&#x2F;</span><br><span class="line">ADD . .</span><br><span class="line">RUN unzip jce_policy-8.zip &amp;&amp; \</span><br><span class="line">        cp UnlimitedJCEPolicyJDK8&#x2F;US_export_policy.jar &#x2F;docker-java-home&#x2F;jre&#x2F;lib&#x2F;security &amp;&amp; \</span><br><span class="line">        cp UnlimitedJCEPolicyJDK8&#x2F;local_policy.jar &#x2F;docker-java-home&#x2F;jre&#x2F;lib&#x2F;security &amp;&amp; \</span><br></pre></td></tr></table></figure>
<h5 id="å¤„ç†ç¨‹åºæŠ¥é”™"><a href="#å¤„ç†ç¨‹åºæŠ¥é”™" class="headerlink" title="å¤„ç†ç¨‹åºæŠ¥é”™"></a>å¤„ç†ç¨‹åºæŠ¥é”™</h5><h6 id="1ã€æ‰¾åˆ°ä¸åˆ°-iSignature-pfx-è¯ä¹¦ï¼š"><a href="#1ã€æ‰¾åˆ°ä¸åˆ°-iSignature-pfx-è¯ä¹¦ï¼š" class="headerlink" title="1ã€æ‰¾åˆ°ä¸åˆ° iSignature.pfx è¯ä¹¦ï¼š"></a>1ã€æ‰¾åˆ°ä¸åˆ° iSignature.pfx è¯ä¹¦ï¼š</h6><p>æŠ¥é”™æˆªå›¾ï¼š</p>
<h5 id><a href="#" class="headerlink" title></a><img src="/%E8%AE%B0%E4%B8%80%E6%AC%A1Java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%AE%B9%E5%99%A8%E5%8C%96%E7%BB%B4%E6%8A%A4%E5%B7%A5%E4%BD%9C/2.png" alt="2"></h5><p>å¯ä»¥çœ‹åˆ°æ‰¾ä¸åˆ°/media/providerstamp/signature/iSignature.pfx è¯ä¹¦æ–‡ä»¶ï¼Œç®€å•ï¼Œä»è€æœåŠ¡å™¨ä¸Šæ‰¾åˆ°å¯¹åº”æ–‡ä»¶ï¼Œæ‹·è´è¿‡æ¥ã€‚</p>
<h6 id="Dockerfile-ç¬¬ä¸‰ç‰ˆ"><a href="#Dockerfile-ç¬¬ä¸‰ç‰ˆ" class="headerlink" title="Dockerfile (ç¬¬ä¸‰ç‰ˆ)"></a>Dockerfile (ç¬¬ä¸‰ç‰ˆ)</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">FROM buildo&#x2F;java8-wkhtmltopdf</span><br><span class="line">MAINTAINER hongye.zhao@vcg.com</span><br><span class="line">RUN mkdir -p &#x2F;application&#x2F;</span><br><span class="line">WORKDIR &#x2F;application&#x2F;</span><br><span class="line">ADD . .</span><br><span class="line">RUN unzip jce_policy-8.zip &amp;&amp; \</span><br><span class="line">        cp UnlimitedJCEPolicyJDK8&#x2F;US_export_policy.jar &#x2F;docker-java-home&#x2F;jre&#x2F;lib&#x2F;security &amp;&amp; \</span><br><span class="line">        cp UnlimitedJCEPolicyJDK8&#x2F;local_policy.jar &#x2F;docker-java-home&#x2F;jre&#x2F;lib&#x2F;security &amp;&amp; \</span><br><span class="line">        mkdir -p &#x2F;media&#x2F;providerstamp&#x2F;signature&#x2F;  &amp;&amp; \</span><br><span class="line">        cp iSignature.pfx &#x2F;media&#x2F;providerstamp&#x2F;signature&#x2F; &amp;&amp; \</span><br></pre></td></tr></table></figure>
<h6 id="2ã€tmpDicä¸æ˜¯æ–‡ä»¶å¤¹"><a href="#2ã€tmpDicä¸æ˜¯æ–‡ä»¶å¤¹" class="headerlink" title="2ã€tmpDicä¸æ˜¯æ–‡ä»¶å¤¹"></a>2ã€tmpDicä¸æ˜¯æ–‡ä»¶å¤¹</h6><p><img src="/%E8%AE%B0%E4%B8%80%E6%AC%A1Java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%AE%B9%E5%99%A8%E5%8C%96%E7%BB%B4%E6%8A%A4%E5%B7%A5%E4%BD%9C/3.png" alt="3"></p>
<p>ç ”å‘æŸ¥çœ‹ä»£ç åç¡®å®šæ˜¯è¦ä½¿ç”¨ /media/providerstamp/temp/ ç›®å½•ï¼Œç´¢æ€§ç™»å½•è€æœåŠ¡å™¨ä¸ŠæŸ¥çœ‹/media/providerstampä¸‹æ‰€æœ‰ç›®å½•ï¼Œéƒ½åˆ›å»ºå¥½ï¼Œå¹¶å°†éœ€è¦çš„æ–‡ä»¶scpæ‹·è´è¿‡æ¥ã€‚</p>
<p><img src="/%E8%AE%B0%E4%B8%80%E6%AC%A1Java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%AE%B9%E5%99%A8%E5%8C%96%E7%BB%B4%E6%8A%A4%E5%B7%A5%E4%BD%9C/4.png" alt="4"></p>
<p>çœ‹åˆ°è¿˜æœ‰ done ã€unitrustç›®å½•ï¼Œå¹¶ä¸”unitrustç›®å½•ä¸­çš„unitrust.key ç¨‹åºä¹Ÿä¼šç”¨åˆ°ã€‚</p>
<h6 id="Dockerfile-ç¬¬å››ç‰ˆ"><a href="#Dockerfile-ç¬¬å››ç‰ˆ" class="headerlink" title="Dockerfile (ç¬¬å››ç‰ˆ)"></a>Dockerfile (ç¬¬å››ç‰ˆ)</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">FROM buildo&#x2F;java8-wkhtmltopdf</span><br><span class="line">MAINTAINER hongye.zhao@vcg.com</span><br><span class="line">RUN mkdir -p &#x2F;application&#x2F;</span><br><span class="line">WORKDIR &#x2F;application&#x2F;</span><br><span class="line">ADD . .</span><br><span class="line">RUN unzip jce_policy-8.zip &amp;&amp; \</span><br><span class="line">        cp UnlimitedJCEPolicyJDK8&#x2F;US_export_policy.jar &#x2F;docker-java-home&#x2F;jre&#x2F;lib&#x2F;security &amp;&amp; \</span><br><span class="line">        cp UnlimitedJCEPolicyJDK8&#x2F;local_policy.jar &#x2F;docker-java-home&#x2F;jre&#x2F;lib&#x2F;security &amp;&amp; \</span><br><span class="line">        mkdir -p &#x2F;media&#x2F;providerstamp&#x2F;signature&#x2F;  &amp;&amp; \</span><br><span class="line">        mkdir -p &#x2F;media&#x2F;providerstamp&#x2F;done&#x2F;  &amp;&amp; \</span><br><span class="line">        mkdir -p &#x2F;media&#x2F;providerstamp&#x2F;unitrust&#x2F;  &amp;&amp; \</span><br><span class="line">        mkdir -p &#x2F;media&#x2F;providerstamp&#x2F;temp&#x2F;  &amp;&amp; \</span><br><span class="line">        cp unitrust.key &#x2F;media&#x2F;providerstamp&#x2F;unitrust &amp;&amp; \</span><br><span class="line">        cp iSignature.pfx &#x2F;media&#x2F;providerstamp&#x2F;signature&#x2F; &amp;&amp; \</span><br></pre></td></tr></table></figure>
<h6 id="3ã€pdfå†…å®¹ä¹±ç "><a href="#3ã€pdfå†…å®¹ä¹±ç " class="headerlink" title="3ã€pdfå†…å®¹ä¹±ç "></a>3ã€pdfå†…å®¹ä¹±ç </h6><p>ä¹±ç æ˜¯ç”±äºå­—ä½“é—®é¢˜ï¼Œç®€å•ç›´æ¥ï¼Œç›´æ¥ä»è€æœåŠ¡å™¨ä¸Šæ‹·è´ /usr/share/fonts ç›®å½•ã€‚</p>
<h6 id="Dockerfile-ç¬¬äº”ç‰ˆ"><a href="#Dockerfile-ç¬¬äº”ç‰ˆ" class="headerlink" title="Dockerfile (ç¬¬äº”ç‰ˆ)"></a>Dockerfile (ç¬¬äº”ç‰ˆ)</h6><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">FROM buildo&#x2F;java8-wkhtmltopdf</span><br><span class="line">MAINTAINER hongye.zhao@vcg.com</span><br><span class="line">RUN mkdir -p &#x2F;application&#x2F;</span><br><span class="line">WORKDIR &#x2F;application&#x2F;</span><br><span class="line">ADD . .</span><br><span class="line">RUN unzip jce_policy-8.zip &amp;&amp; \</span><br><span class="line">        cp UnlimitedJCEPolicyJDK8&#x2F;US_export_policy.jar &#x2F;docker-java-home&#x2F;jre&#x2F;lib&#x2F;security &amp;&amp; \</span><br><span class="line">        cp UnlimitedJCEPolicyJDK8&#x2F;local_policy.jar &#x2F;docker-java-home&#x2F;jre&#x2F;lib&#x2F;security &amp;&amp; \</span><br><span class="line">        mkdir -p &#x2F;media&#x2F;providerstamp&#x2F;signature&#x2F;  &amp;&amp; \</span><br><span class="line">        mkdir -p &#x2F;media&#x2F;providerstamp&#x2F;done&#x2F;  &amp;&amp; \</span><br><span class="line">        mkdir -p &#x2F;media&#x2F;providerstamp&#x2F;unitrust&#x2F;  &amp;&amp; \</span><br><span class="line">        mkdir -p &#x2F;media&#x2F;providerstamp&#x2F;temp&#x2F;  &amp;&amp; \</span><br><span class="line">        cp unitrust.key &#x2F;media&#x2F;providerstamp&#x2F;unitrust &amp;&amp; \</span><br><span class="line">        cp iSignature.pfx &#x2F;media&#x2F;providerstamp&#x2F;signature&#x2F; &amp;&amp; \</span><br><span class="line">        rm -f &#x2F;usr&#x2F;local&#x2F;bin&#x2F;wkhtmltopdf &amp;&amp; \</span><br><span class="line">        rm -rf &#x2F;usr&#x2F;share&#x2F;fonts &amp;&amp; \</span><br><span class="line">        cp wkhtmltopdf &#x2F;usr&#x2F;local&#x2F;bin&#x2F; &amp;&amp; \</span><br><span class="line">        tar zxf fonts.tar.gz &amp;&amp; \</span><br><span class="line">        mv fonts&#x2F; &#x2F;usr&#x2F;share&#x2F;</span><br></pre></td></tr></table></figure>
<p>è‡³æ­¤ï¼Œæ­¤å¾®æœåŠ¡å®¹å™¨åŒ–å·²å®Œæˆã€‚ğŸ‘ğŸ‘ğŸ‘</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/Docker-%E9%95%9C%E5%83%8Fimage/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GeekSRE">
      <meta itemprop="description" content="GeekSRE">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GeekSRE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/Docker-%E9%95%9C%E5%83%8Fimage/" class="post-title-link" itemprop="url">Docker-é•œåƒimage</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-04-23 11:17:48 / Modified: 11:24:43" itemprop="dateCreated datePublished" datetime="2019-04-23T11:17:48+08:00">2019-04-23</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Docker/" itemprop="url" rel="index"><span itemprop="name">Docker</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Dockeré•œåƒæ˜¯å¯åŠ¨å®¹å™¨çš„åŸºçŸ³ã€‚</p>
<h4 id="ä»€ä¹ˆæ˜¯Dockeré•œåƒ"><a href="#ä»€ä¹ˆæ˜¯Dockeré•œåƒ" class="headerlink" title="ä»€ä¹ˆæ˜¯Dockeré•œåƒ"></a>ä»€ä¹ˆæ˜¯Dockeré•œåƒ</h4><hr>
<p>Dockeré•œåƒæ˜¯ç”±æ–‡ä»¶ç³»ç»Ÿå åŠ è€Œæˆã€‚æœ€åº•ç«¯æ˜¯ä¸€ä¸ªæ–‡ä»¶å¼•å¯¼ç³»ç»Ÿï¼Œå³bootfsã€‚Dockerç”¨æˆ·ä¸ä¼šä¸å¼•å¯¼æ–‡ä»¶ç³»ç»Ÿæœ‰ç›´æ¥çš„äº¤äº’ã€‚Dockeré•œåƒçš„ç¬¬äºŒå±‚æ˜¯rootæ–‡ä»¶ç³»ç»Ÿrootfsï¼Œé€šå¸¸æ˜¯ä¸€ç§æˆ–å¤šç§æ“ä½œç³»ç»Ÿï¼Œä¾‹å¦‚ubuntuç­‰ã€‚åœ¨Dockerä¸­ï¼Œæ–‡ä»¶ç³»ç»Ÿæ°¸è¿œéƒ½æ˜¯åªè¯»çš„ï¼Œåœ¨æ¯æ¬¡ä¿®æ”¹æ—¶ï¼Œéƒ½æ˜¯è¿›è¡Œæ‹·è´å åŠ ä»è€Œå½¢æˆæœ€ç»ˆçš„æ–‡ä»¶ç³»ç»Ÿã€‚Dockerç§°è¿™æ ·çš„æ–‡ä»¶ä¸ºé•œåƒã€‚ä¸€ä¸ªé•œåƒå¯ä»¥è¿­ä»£åœ¨å¦ä¸€ä¸ªé•œåƒçš„é¡¶éƒ¨ã€‚ä½äºä¸‹æ–¹çš„é•œåƒç§°ä¹‹ä¸ºçˆ¶é•œåƒï¼Œæœ€åº•å±‚çš„é•œåƒç§°ä¹‹ä¸º<strong>åŸºç¡€é•œåƒ</strong>ã€‚æœ€åï¼Œå½“ä»ä¸€ä¸ªé•œåƒå¯åŠ¨å®¹å™¨æ—¶ï¼ŒDockerä¼šåœ¨æœ€é¡¶å±‚åŠ è½½ä¸€ä¸ªè¯»å†™æ–‡ä»¶ç³»ç»Ÿä½œä¸ºå®¹å™¨ã€‚</p>
<p><img src="/Docker-%E9%95%9C%E5%83%8Fimage/Dockeré•œåƒ.JPEG" alt="Dockeré•œåƒ"></p>
<p>Dockerçš„è¿™ç§æœºåˆ¶æˆ‘ä»¬ç§°ä¹‹ä¸º<strong>å†™æ—¶å¤åˆ¶</strong>ã€‚</p>
<h4 id="æŸ¥çœ‹é•œåƒåˆ—è¡¨"><a href="#æŸ¥çœ‹é•œåƒåˆ—è¡¨" class="headerlink" title="æŸ¥çœ‹é•œåƒåˆ—è¡¨"></a>æŸ¥çœ‹é•œåƒåˆ—è¡¨</h4><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker images </span><br></pre></td></tr></table></figure>
<p>è¯¥å‘½ä»¤å¯ä»¥ç”¨äºæŸ¥æ‰¾å½“å‰ç³»ç»Ÿä¸­æ‰€æœ‰å­˜åœ¨çš„é•œåƒåˆ—è¡¨ã€‚</p>
<p>Psï¼šæœ¬åœ°é•œåƒé»˜è®¤ä¿å­˜åœ¨Dockerå®¿ä¸»æœºçš„/var/lib/dockerç›®å½•ä¸‹ã€‚æ‰€æœ‰çš„é•œåƒéƒ½æ˜¯ä¿å­˜åœ¨ä»“åº“ä¸­ï¼Œè€Œä»“åº“ä½äºRegistryä¸­ã€‚é»˜è®¤çš„Registryæ˜¯Dockerå…¬å¸è¿è¥çš„Docker Hubã€‚æ¯ä¸ªé•œåƒä»“åº“éƒ½å¯ä»¥å­˜æ”¾å¾ˆå¤šçš„é•œåƒã€‚</p>
<h4 id="æ‹‰å–é•œåƒ"><a href="#æ‹‰å–é•œåƒ" class="headerlink" title="æ‹‰å–é•œåƒ"></a>æ‹‰å–é•œåƒ</h4><hr>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull centos</span><br></pre></td></tr></table></figure>
<p>ä¸Šè¿°å‘½ä»¤ä¼šæ‹‰å–é•œåƒåˆ°æœ¬åœ°ã€‚</p>
<p>ä¸ºäº†åŒºåˆ†åŒä¸€ä¸ªä»“åº“ä¸­ä¸åŒçš„é•œåƒï¼ŒDockeræä¾›äº†ä¸€ç§tagçš„åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥ç»™æ¯ä¸ªç‰ˆæœ¬çš„é•œåƒæ·»åŠ ä¸€ä¸ªå”¯ä¸€çš„tagæ¥æ ‡è¯†è¯¥é•œåƒã€‚æ­¤æ—¶ï¼Œé•œåƒçš„åç§°å¦‚ä¸‹ï¼šä»“åº“åç§°:tagã€‚æˆ‘ä»¬åœ¨è¿è¡Œé•œåƒæˆ–æ‹‰å–é•œåƒæ—¶ï¼Œå¯ä»¥ç›´æ¥æŒ‡å®šå¯¹åº”çš„æ ‡ç­¾ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker pull registry-vpc.cn-beijing.aliyuncs.com&#x2F;vcgcs&#x2F;jdk8:util</span><br></pre></td></tr></table></figure>
<h4 id="æŸ¥æ‰¾é•œåƒ"><a href="#æŸ¥æ‰¾é•œåƒ" class="headerlink" title="æŸ¥æ‰¾é•œåƒ"></a>æŸ¥æ‰¾é•œåƒ</h4><hr>
<p>ä»Docker HubæŸ¥æ‰¾æœ‰å“ªäº›å…¬å…±çš„å¯ç”¨é•œåƒ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker search keywords</span><br></pre></td></tr></table></figure>
<h4 id="æ„å»ºDockeré•œåƒ"><a href="#æ„å»ºDockeré•œåƒ" class="headerlink" title="æ„å»ºDockeré•œåƒ"></a>æ„å»ºDockeré•œåƒ</h4><hr>
<p><strong>docker build</strong> å‘½ä»¤ç”¨äºä½¿ç”¨ Dockerfile åˆ›å»ºé•œåƒã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -t runoob/ubuntu:v1 . </span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨URL <strong>github.com/creack/docker-firefox</strong> çš„ Dockerfile åˆ›å»ºé•œåƒã€‚</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build github.com/creack/docker-firefox</span><br></pre></td></tr></table></figure>
<p>ä¹Ÿå¯ä»¥é€šè¿‡ -f Dockerfile æ–‡ä»¶çš„ä½ç½®ï¼š</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker build -f /path/to/a/Dockerfile .</span><br></pre></td></tr></table></figure>
<h4 id="ç™»å½•é•œåƒä»“åº“"><a href="#ç™»å½•é•œåƒä»“åº“" class="headerlink" title="ç™»å½•é•œåƒä»“åº“"></a>ç™»å½•é•œåƒä»“åº“</h4><p>ä½¿ç”¨é˜¿é‡Œäº‘å®¹å™¨é•œåƒæœåŠ¡</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker login --username=&quot;ops@vcg.com&quot; --password=&quot;******&quot; registry-vpc.cn-beijing.aliyuncs.com</span><br></pre></td></tr></table></figure>
<h4 id="æ¨é€é•œåƒåˆ°ä»“åº“"><a href="#æ¨é€é•œåƒåˆ°ä»“åº“" class="headerlink" title="æ¨é€é•œåƒåˆ°ä»“åº“"></a>æ¨é€é•œåƒåˆ°ä»“åº“</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker push registry-vpc.cn-beijing.aliyuncs.com&#x2F;vcgcs&#x2F;jdk8:util</span><br></pre></td></tr></table></figure>
<h4 id="ä¿®æ”¹é•œåƒTag"><a href="#ä¿®æ”¹é•œåƒTag" class="headerlink" title="ä¿®æ”¹é•œåƒTag"></a>ä¿®æ”¹é•œåƒTag</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker images  # è·å–ImageId</span><br><span class="line">docker tag [ImageId] registry.cn-beijing.aliyuncs.com/vcg/500px-vcg-com:[é•œåƒç‰ˆæœ¬å·]</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/Ansible-%E6%89%B9%E9%87%8F%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GeekSRE">
      <meta itemprop="description" content="GeekSRE">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GeekSRE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/Ansible-%E6%89%B9%E9%87%8F%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81/" class="post-title-link" itemprop="url">Ansible-æ‰¹é‡ä¿®æ”¹å¯†ç </a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-04-23 11:13:07 / Modified: 11:29:56" itemprop="dateCreated datePublished" datetime="2019-04-23T11:13:07+08:00">2019-04-23</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Ansible/" itemprop="url" rel="index"><span itemprop="name">Ansible</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ä»‹ç»ä½¿ç”¨ansibleæ‰¹é‡ä¿®æ”¹ç”¨æˆ·å¯†ç çš„æ–¹æ³•ï¼Œå› ä¸ºåœ¨ä½¿ç”¨ansibleä¿®æ”¹ç”¨æˆ·å¯†ç çš„æ—¶å€™ä¸èƒ½ä½¿ç”¨æ˜æ–‡çš„æ–¹å¼ï¼Œéœ€è¦å…ˆåŠ å¯†ï¼Œæ‰€ä»¥å°±éœ€è¦ä½¿ç”¨ä¸€ä¸ªæ–¹æ³•å¯¹è¾“å…¥çš„æ˜æ–‡çš„å¯†ç è¿›è¡ŒåŠ å¯†ï¼Œä¸‹é¢å°±ç›´æ¥ä¸Šå¹²è´§ã€‚</p>
<h5 id="æ›´æ”¹å¤šä¸ªå›ºå®šåŸŸå"><a href="#æ›´æ”¹å¤šä¸ªå›ºå®šåŸŸå" class="headerlink" title="æ›´æ”¹å¤šä¸ªå›ºå®šåŸŸå"></a>æ›´æ”¹å¤šä¸ªå›ºå®šåŸŸå</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cat changePasswd.yaml</span><br></pre></td></tr></table></figure>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">---</span></span><br><span class="line"><span class="bullet">-</span> <span class="attr">hosts:</span> <span class="string">ops</span></span><br><span class="line">  <span class="attr">gather_facts:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">tasks:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">change</span> <span class="string">user</span> <span class="string">passwd</span></span><br><span class="line">    <span class="attr">user:</span> <span class="string">name=&#123;&#123;</span> <span class="string">item.name</span> <span class="string">&#125;&#125;</span> <span class="string">password=&#123;&#123;</span> <span class="string">item.chpass</span> <span class="string">|</span> <span class="string">password_hash(&#x27;sha512&#x27;)</span> <span class="string">&#125;&#125;</span>  <span class="string">update_password=always</span></span><br><span class="line">    <span class="attr">with_items:</span></span><br><span class="line">         <span class="bullet">-</span> &#123; <span class="attr">name:</span> <span class="string">&#x27;root&#x27;</span>, <span class="attr">chpass:</span> <span class="string">&#x27;***********&#x27;</span> &#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ansible-playbook changePasswd.yaml</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/%E9%98%BF%E9%87%8C%E4%BA%91WAF-Kubernetes-Ingress-%E6%9E%B6%E6%9E%84%E4%B8%8B%E6%97%A0%E6%B3%95%E6%8B%BF%E5%88%B0%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9C%9F%E5%AE%9EIP%E7%9A%84%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GeekSRE">
      <meta itemprop="description" content="GeekSRE">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GeekSRE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/%E9%98%BF%E9%87%8C%E4%BA%91WAF-Kubernetes-Ingress-%E6%9E%B6%E6%9E%84%E4%B8%8B%E6%97%A0%E6%B3%95%E6%8B%BF%E5%88%B0%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9C%9F%E5%AE%9EIP%E7%9A%84%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86/" class="post-title-link" itemprop="url">é˜¿é‡Œäº‘WAF + Kubernetes Ingress æ¶æ„ä¸‹æ— æ³•æ‹¿åˆ°å®¢æˆ·ç«¯çœŸå®IPçš„é—®é¢˜å¤„ç†</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-04-21 19:00:55" itemprop="dateCreated datePublished" datetime="2019-04-21T19:00:55+08:00">2019-04-21</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-04-29 10:19:47" itemprop="dateModified" datetime="2019-04-29T10:19:47+08:00">2019-04-29</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kubernetes/" itemprop="url" rel="index"><span itemprop="name">Kubernetes</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h5 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯:"></a>èƒŒæ™¯:</h5><p>2019å¹´04æœˆ19æ—¥æ™š21:10åˆ†è¿›è¡Œç½‘ç»œç»´æŠ¤ï¼Œå†…å®¹å¦‚ä¸‹ï¼š</p>
<p>â€‹    å°†åŸŸåCNAMEåˆ°é˜¿é‡Œäº‘çš„Webé˜²ç«å¢™ï¼ˆä»¥ä¸‹ç®€ç§°ä¸ºWAFï¼‰ï¼Œä¸šåŠ¡è¯·æ±‚ç»é˜²ç«å¢™è§£æåˆ°Kubernetes çš„ Ingress çš„è´Ÿè½½å‡è¡¡ï¼ˆSLBï¼‰åœ°å€</p>
<h5 id="æ•…éšœç°è±¡ï¼š"><a href="#æ•…éšœç°è±¡ï¼š" class="headerlink" title="æ•…éšœç°è±¡ï¼š"></a>æ•…éšœç°è±¡ï¼š</h5><p>â€‹    åç«¯åº”ç”¨é€šè¿‡è·å–è¯·æ±‚ä¸­çš„X-Forwarded-Forå­—æ®µï¼Œæ‹¿åˆ°çš„IPåœ°å€ä¸ºWAFå›æºåœ°å€ï¼Œéå®¢æˆ·ç«¯çœŸå®IPã€‚</p>
<h5 id="æ’æŸ¥è®°å½•"><a href="#æ’æŸ¥è®°å½•" class="headerlink" title="æ’æŸ¥è®°å½•:"></a>æ’æŸ¥è®°å½•:</h5><ol>
<li><p>21:15 æŸ¥çœ‹Ingressæ—¥å¿—ï¼Œå‘ç°Ingressæ‹¿åˆ°çš„IPå°±æ˜¯WAFå›æºåœ°å€ï¼Œä¸ºé”™è¯¯IPï¼Œç¡®å®šéå‰ç«¯nodejsä»£ç bugã€‚</p>
</li>
<li><p>21:33  è”ç³»é˜¿é‡Œäº‘æŠ€æœ¯å›¢é˜Ÿä¸€èµ·æ’æŸ¥é—®é¢˜ã€‚</p>
</li>
<li><p>22:20  ç¡®è®¤Ingressçš„æ¨¡æ¿æ–‡ä»¶ä¸­ the_real_ip å˜é‡æ˜¯æ‹¿çš„ remote_addr å­—æ®µï¼Œç­‰å¾…é˜¿é‡ŒæŠ€æœ¯è”ç³»Ingreeç ”å‘åŒå­¦ï¼Œç»™å‡ºå›å¤ã€‚</p>
</li>
<li><p>23:23 Ingreeç ”å‘åŒå­¦è”ç³»ä¸Šåç¡®è®¤Ingressæ²¡é—®é¢˜ï¼Œå¯èƒ½æ˜¯WAFæ²¡ä¼ çœŸå®IPåˆ°Ingressã€‚</p>
</li>
<li><p>23:50 åœ¨Ingresså®¹å™¨å’Œå‰ç«¯nodejsæ‰€åœ¨å®¿ä¸»æœºtcpdumpå·¥å…·æŠ“åŒ…ååˆ†æå¾—å‡ºï¼š</p>
<p>(1)ã€WAFå·²ç»å°†çœŸå®å®¢æˆ·ç«¯åœ°å€æ”¾åˆ°äº† x-Forwarded-For çš„å­—æ®µä¸­ä¼ ç»™äº†ECS<br>(2)ã€ECS(å®¹å™¨çš„ingress)å°†çœŸå®çš„å®¢æˆ·ç«¯IPï¼Œæ”¾åˆ°äº†x-Original-Forwarded-Forï¼›è€Œå°†WAFçš„å›æºåœ°å€æ”¾åˆ°äº† x-Forwarded-For</p>
</li>
<li><p>4æœˆ20æ—¥ 00:29 å°†compute-full-forwarded-foré…ç½®åˆ°Ingressçš„ConfigMapä¸­ï¼Œé—®é¢˜è§£å†³ã€‚</p>
</li>
</ol>
<h5 id="æ“ä½œï¼š"><a href="#æ“ä½œï¼š" class="headerlink" title="æ“ä½œï¼š"></a>æ“ä½œï¼š</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubectl -n kube-system edit cm nginx-configuration</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">åœ¨dataæ ‡ç­¾ä¸‹æ·»åŠ å¦‚ä¸‹ï¼š</span><br><span class="line">compute-full-forwarded-for: &quot;true&quot;</span><br><span class="line">forwarded-for-header: &quot;X-Forwarded-For&quot;</span><br><span class="line">use-forwarded-headers: &quot;true&quot;</span><br></pre></td></tr></table></figure>
<h5 id="ç»“è®ºï¼š"><a href="#ç»“è®ºï¼š" class="headerlink" title="ç»“è®ºï¼š"></a>ç»“è®ºï¼š</h5><p>é˜¿é‡Œäº‘å®¹å™¨æœåŠ¡Kubernetesé›†ç¾¤çš„Ingressé»˜è®¤ConfigMapä¸­æœªé…ç½® compute-full-forwarded-forå‚æ•°ï¼Œå¯¼è‡´å°†ingressæ‹¿åˆ°çš„WAFå›æºIPæ›¿æ¢ä¸ºXFFï¼Œè€Œéé™„åŠ åˆ°XFFä¸­ã€‚</p>
<p><a target="_blank" rel="noopener" href="https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/configmap/#compute-full-forwarded-for">https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/configmap/#compute-full-forwarded-for</a></p>
<h5 id="åæ€ï¼š"><a href="#åæ€ï¼š" class="headerlink" title="åæ€ï¼š"></a>åæ€ï¼š</h5><ol>
<li><p>é¢„è§ˆç¯å¢ƒå’Œçº¿ä¸Šç¯å¢ƒæ¶æ„ä¸ä¸€è‡´ï¼š</p>
<p>æ­¤æ¬¡æ•…éšœä¸­ï¼Œé¢„è§ˆç¯å¢ƒæœªä½¿ç”¨WAFé˜²æŠ¤ï¼Œç›´æ¥è§£æåˆ°K8Sé›†ç¾¤ï¼Œæœªæå‰å‘ç°æ­¤æ¬¡é—®é¢˜ï¼Œå·²ä¿®æ­£ï¼Œä»¥åå°½é‡ç»´æŒç¯å¢ƒç»Ÿä¸€ï¼Œé¿å…æ­¤ç±»é—®é¢˜å‡ºç°ã€‚</p>
</li>
<li><p>æ•…éšœç‚¹å®šä½é€Ÿåº¦æ…¢ï¼š</p>
<p>ç½‘ç»œè¯·æ±‚é—®é¢˜ä¼˜å…ˆæŠ“åŒ…åˆ†æï¼Œæå‡æ•…éšœå®šä½é€Ÿåº¦ï¼Œåç»­å¤¯å®åŸºç¡€çŸ¥è¯†ï¼Œæå‡é—®é¢˜æ’æŸ¥èƒ½åŠ›ã€‚</p>
</li>
<li><p>Kubernetesä¸“ä¸šçŸ¥è¯†æŒæ¡ç¨‹åº¦è¾ƒä½</p>
<p>ç›®å‰ä»…ä»…åœ¨ä½¿ç”¨å±‚é¢ä¸Šèƒ½åŠ›okï¼Œä½†æ˜¯å…¶å®ç°åŸç†ã€ç»„ä»¶å®ç°æ–¹å¼ç­‰çŸ¥è¯†ç‚¹è–„å¼±ï¼Œåç»­è¿˜éœ€åœ¨K8Så­¦ä¹ ä¸­å¤šæ€»ç»“ï¼Œå¤šå­¦ä¹ ï¼Œäº‰å–å‡å°‘æ•…éšœï¼Œæå‡è¿ç»´èƒ½åŠ›ã€‚</p>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/Kubernetes-kubectl/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GeekSRE">
      <meta itemprop="description" content="GeekSRE">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GeekSRE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/Kubernetes-kubectl/" class="post-title-link" itemprop="url">Kubernetes-kubectl</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-04-21 15:02:52 / Modified: 15:49:35" itemprop="dateCreated datePublished" datetime="2019-04-21T15:02:52+08:00">2019-04-21</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Kubernetes/" itemprop="url" rel="index"><span itemprop="name">Kubernetes</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>ç®¡ç†Kubernetesé›†ç¾¤çš„å·¥å…·</p>
<hr>
<h5 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h5><ol>
<li><h6 id="ä¸‹è½½æœ€æ–°ç‰ˆçš„kubectlå®¢æˆ·ç«¯"><a href="#ä¸‹è½½æœ€æ–°ç‰ˆçš„kubectlå®¢æˆ·ç«¯" class="headerlink" title="ä¸‹è½½æœ€æ–°ç‰ˆçš„kubectlå®¢æˆ·ç«¯"></a>ä¸‹è½½æœ€æ–°ç‰ˆçš„kubectlå®¢æˆ·ç«¯</h6><p><a target="_blank" rel="noopener" href="https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG.md&gt;">https://github.com/kubernetes/kubernetes/blob/master/CHANGELOG.md&gt;</a></p>
</li>
<li><h6 id="å®‰è£…å’Œé…ç½®"><a href="#å®‰è£…å’Œé…ç½®" class="headerlink" title="å®‰è£…å’Œé…ç½®"></a>å®‰è£…å’Œé…ç½®</h6><p><a target="_blank" rel="noopener" href="https://kubernetes.io/docs/tasks/tools/install-kubectl/&gt;">https://kubernetes.io/docs/tasks/tools/install-kubectl/&gt;</a></p>
</li>
<li><p>éªŒè¯å®‰è£…</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kuberctl version</span><br></pre></td></tr></table></figure>
<p><img src="/Kubernetes-kubectl/kubectl-version.jpg" alt="kuberctl-version.jpg"></p>
</li>
<li><h6 id="é…ç½®é›†ç¾¤å‡­è¯"><a href="#é…ç½®é›†ç¾¤å‡­è¯" class="headerlink" title="é…ç½®é›†ç¾¤å‡­è¯"></a>é…ç½®é›†ç¾¤å‡­è¯</h6><p>æ‚¨å¯ä»¥ä½¿ç”¨<strong>scp</strong>å‘½ä»¤å®‰å…¨åœ°å°†ä¸»èŠ‚ç‚¹çš„é…ç½®ä» Kubernetes é›†ç¾¤ä¸» VM ä¸­çš„ <code>/etc/kubernetes/kube.conf</code> å¤åˆ¶åˆ°æœ¬åœ°è®¡ç®—æœºçš„ <code>$HOME/.kube/config</code>ï¼ˆ<code>kubectl</code> é¢„æœŸå‡­æ®æ‰€åœ¨çš„ä½ç½®ï¼‰ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">mkdir $HOME&#x2F;.kube</span><br><span class="line">scp root@&lt;master-public-ip&gt;:&#x2F;etc&#x2F;kubernetes&#x2F;kube.conf $HOME&#x2F;.kube&#x2F;config</span><br></pre></td></tr></table></figure>
<p>å…¬æœ‰äº‘ç¯å¢ƒä¹Ÿå¯ä»¥åœ¨é›†ç¾¤é…ç½®é¡µé¢è·å–åˆ°configé…ç½®</p>
</li>
<li><p>éªŒè¯è¿æ¥</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">kubect get all</span><br></pre></td></tr></table></figure>
</li>
</ol>
<h5 id="å‘½ä»¤å‚æ•°"><a href="#å‘½ä»¤å‚æ•°" class="headerlink" title="å‘½ä»¤å‚æ•°"></a>å‘½ä»¤å‚æ•°</h5><h6 id="help-è·å–å¸®åŠ©ä¿¡æ¯"><a href="#help-è·å–å¸®åŠ©ä¿¡æ¯" class="headerlink" title="help-è·å–å¸®åŠ©ä¿¡æ¯"></a>help-è·å–å¸®åŠ©ä¿¡æ¯</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">zhaohongye ~ ^-^ #kubectl help</span><br><span class="line">kubectl controls the Kubernetes cluster manager.</span><br><span class="line"></span><br><span class="line">Find more information at: https://kubernetes.io/docs/reference/kubectl/overview/</span><br><span class="line"></span><br><span class="line">Basic Commands (Beginner):</span><br><span class="line">  create         Create a resource from a file or from stdin.</span><br><span class="line">  expose         ä½¿ç”¨ replication controller, service, deployment æˆ–è€… pod</span><br><span class="line">å¹¶æš´éœ²å®ƒä½œä¸ºä¸€ä¸ª æ–°çš„ Kubernetes Service</span><br><span class="line">  run            åœ¨é›†ç¾¤ä¸­è¿è¡Œä¸€ä¸ªæŒ‡å®šçš„é•œåƒ</span><br><span class="line">  set            ä¸º objects è®¾ç½®ä¸€ä¸ªæŒ‡å®šçš„ç‰¹å¾</span><br><span class="line">  run-container  åœ¨é›†ç¾¤ä¸­è¿è¡Œä¸€ä¸ªæŒ‡å®šçš„é•œåƒ. This command is</span><br><span class="line">deprecated, use &quot;run&quot; instead</span><br><span class="line"></span><br><span class="line">Basic Commands (Intermediate):</span><br><span class="line">  get            æ˜¾ç¤ºä¸€ä¸ªæˆ–æ›´å¤š resources</span><br><span class="line">  explain        æŸ¥çœ‹èµ„æºçš„æ–‡æ¡£</span><br><span class="line">  edit           åœ¨æœåŠ¡å™¨ä¸Šç¼–è¾‘ä¸€ä¸ªèµ„æº</span><br><span class="line">  delete         Delete resources by filenames, stdin, resources and names, or</span><br><span class="line">by resources and label selector</span><br><span class="line"></span><br><span class="line">Deploy Commands:</span><br><span class="line">  rollout        Manage the rollout of a resource</span><br><span class="line">  rolling-update å®ŒæˆæŒ‡å®šçš„ ReplicationController çš„æ»šåŠ¨å‡çº§</span><br><span class="line">  scale          ä¸º Deployment, ReplicaSet, Replication Controller æˆ–è€… Job</span><br><span class="line">è®¾ç½®ä¸€ä¸ªæ–°çš„å‰¯æœ¬æ•°é‡</span><br><span class="line">  autoscale      è‡ªåŠ¨è°ƒæ•´ä¸€ä¸ª Deployment, ReplicaSet, æˆ–è€…</span><br><span class="line">ReplicationController çš„å‰¯æœ¬æ•°é‡</span><br><span class="line"></span><br><span class="line">Cluster Management Commands:</span><br><span class="line">  certificate    ä¿®æ”¹ certificate èµ„æº.</span><br><span class="line">  cluster-info   æ˜¾ç¤ºé›†ç¾¤ä¿¡æ¯</span><br><span class="line">  top            Display Resource (CPU/Memory/Storage) usage.</span><br><span class="line">  cordon         æ ‡è®° node ä¸º unschedulable</span><br><span class="line">  uncordon       æ ‡è®° node ä¸º schedulable</span><br><span class="line">  drain          Drain node in preparation for maintenance</span><br><span class="line">  taint          æ›´æ–°ä¸€ä¸ªæˆ–è€…å¤šä¸ª node ä¸Šçš„ taints</span><br><span class="line"></span><br><span class="line">Troubleshooting and Debugging Commands:</span><br><span class="line">  describe       æ˜¾ç¤ºä¸€ä¸ªæŒ‡å®š resource æˆ–è€… group çš„ resources è¯¦æƒ…</span><br><span class="line">  logs           è¾“å‡ºå®¹å™¨åœ¨ pod ä¸­çš„æ—¥å¿—</span><br><span class="line">  attach         Attach åˆ°ä¸€ä¸ªè¿è¡Œä¸­çš„ container</span><br><span class="line">  exec           åœ¨ä¸€ä¸ª container ä¸­æ‰§è¡Œä¸€ä¸ªå‘½ä»¤</span><br><span class="line">  port-forward   Forward one or more local ports to a pod</span><br><span class="line">  proxy          è¿è¡Œä¸€ä¸ª proxy åˆ° Kubernetes API server</span><br><span class="line">  cp             å¤åˆ¶ files å’Œ directories åˆ° containers</span><br><span class="line">å’Œä»å®¹å™¨ä¸­å¤åˆ¶ files å’Œ directories.</span><br><span class="line">  auth           Inspect authorization</span><br><span class="line"></span><br><span class="line">Advanced Commands:</span><br><span class="line">  apply          é€šè¿‡æ–‡ä»¶åæˆ–æ ‡å‡†è¾“å…¥æµ(stdin)å¯¹èµ„æºè¿›è¡Œé…ç½®</span><br><span class="line">  patch          ä½¿ç”¨ strategic merge patch æ›´æ–°ä¸€ä¸ªèµ„æºçš„ field(s)</span><br><span class="line">  replace        é€šè¿‡ filename æˆ–è€… stdinæ›¿æ¢ä¸€ä¸ªèµ„æº</span><br><span class="line">  convert        åœ¨ä¸åŒçš„ API versions è½¬æ¢é…ç½®æ–‡ä»¶</span><br><span class="line"></span><br><span class="line">Settings Commands:</span><br><span class="line">  label          æ›´æ–°åœ¨è¿™ä¸ªèµ„æºä¸Šçš„ labels</span><br><span class="line">  annotate       æ›´æ–°ä¸€ä¸ªèµ„æºçš„æ³¨è§£</span><br><span class="line">  completion     Output shell completion code for the specified shell (bash or</span><br><span class="line">zsh)</span><br><span class="line"></span><br><span class="line">Other Commands:</span><br><span class="line">  api-versions   Print the supported API versions on the server, in the form of</span><br><span class="line">&quot;group/version&quot;</span><br><span class="line">  config         ä¿®æ”¹ kubeconfig æ–‡ä»¶</span><br><span class="line">  help           Help about any command</span><br><span class="line">  plugin         Runs a command-line plugin</span><br><span class="line">  version        è¾“å‡º client å’Œ server çš„ç‰ˆæœ¬ä¿¡æ¯</span><br><span class="line"></span><br><span class="line">Usage:</span><br><span class="line">  kubectl [flags] [options]</span><br><span class="line"></span><br><span class="line">Use &quot;kubectl &lt;command&gt; --help&quot; for more information about a given command.</span><br><span class="line">Use &quot;kubectl options&quot; for a list of global command-line options (applies to all</span><br><span class="line">commands).</span><br></pre></td></tr></table></figure>
<h6 id="get-è·å–ä¿¡æ¯"><a href="#get-è·å–ä¿¡æ¯" class="headerlink" title="get-è·å–ä¿¡æ¯"></a>get-è·å–ä¿¡æ¯</h6><p>Display one or many resources</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Examples:</span><br><span class="line"><span class="meta">  #</span><span class="bash"> List all pods <span class="keyword">in</span> ps output format.</span></span><br><span class="line">  kubectl get pods</span><br><span class="line"></span><br><span class="line"><span class="meta">  #</span><span class="bash"> List all pods <span class="keyword">in</span> ps output format with more information (such as node name).</span></span><br><span class="line">  kubectl get pods -o wide</span><br><span class="line"></span><br><span class="line"><span class="meta">  #</span><span class="bash"> List a single replication controller with specified NAME <span class="keyword">in</span> ps output format.</span></span><br><span class="line">  kubectl get replicationcontroller web</span><br><span class="line"></span><br><span class="line"><span class="meta">  #</span><span class="bash"> List a single pod <span class="keyword">in</span> JSON output format.</span></span><br><span class="line">  kubectl get -o json pod web-pod-13je7</span><br><span class="line"></span><br><span class="line"><span class="meta">  #</span><span class="bash"> List a pod identified by <span class="built_in">type</span> and name specified <span class="keyword">in</span> <span class="string">&quot;pod.yaml&quot;</span> <span class="keyword">in</span> JSON output format.</span></span><br><span class="line">  kubectl get -f pod.yaml -o json</span><br><span class="line"></span><br><span class="line"><span class="meta">  #</span><span class="bash"> Return only the phase value of the specified pod.</span></span><br><span class="line">  kubectl get -o template pod/web-pod-13je7 --template=&#123;&#123;.status.phase&#125;&#125;</span><br><span class="line"></span><br><span class="line"><span class="meta">  #</span><span class="bash"> List all replication controllers and services together <span class="keyword">in</span> ps output format.</span></span><br><span class="line">  kubectl get rc,services</span><br><span class="line"></span><br><span class="line"><span class="meta">  #</span><span class="bash"> List one or more resources by their <span class="built_in">type</span> and names.</span></span><br><span class="line">  kubectl get rc/web service/frontend pods/web-pod-13je7</span><br><span class="line"></span><br><span class="line"><span class="meta">  #</span><span class="bash"> List all resources with different types.</span></span><br><span class="line">  kubectl get all</span><br></pre></td></tr></table></figure>
<h6 id="scale-æ‰©ç¼©å®¹"><a href="#scale-æ‰©ç¼©å®¹" class="headerlink" title="scale-æ‰©ç¼©å®¹"></a>scale-æ‰©ç¼©å®¹</h6><p>Set a new size for a Deployment, ReplicaSet, Replication Controller, or StatefulSet.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Examples:</span><br><span class="line">  # Scale a replicaset named &#39;foo&#39; to 3.</span><br><span class="line">  kubectl scale --replicas&#x3D;3 rs&#x2F;foo</span><br><span class="line"></span><br><span class="line">  # Scale a resource identified by type and name specified in &quot;foo.yaml&quot; to 3.</span><br><span class="line">  kubectl scale --replicas&#x3D;3 -f foo.yaml</span><br><span class="line"></span><br><span class="line">  # If the deployment named mysql&#39;s current size is 2, scale mysql to 3.</span><br><span class="line">  kubectl scale --current-replicas&#x3D;2 --replicas&#x3D;3 deployment&#x2F;mysql</span><br><span class="line"></span><br><span class="line">  # Scale multiple replication controllers.</span><br><span class="line">  kubectl scale --replicas&#x3D;5 rc&#x2F;foo rc&#x2F;bar rc&#x2F;baz</span><br><span class="line"></span><br><span class="line">  # Scale statefulset named &#39;web&#39; to 3.</span><br><span class="line">  kubectl scale --replicas&#x3D;3 statefulset&#x2F;web</span><br><span class="line">  </span><br><span class="line">  kubectl scale Deployment node-vcg-web --replicas&#x3D;1</span><br><span class="line">  kubectl scale Deployment node-vcg-web --replicas&#x3D;10</span><br></pre></td></tr></table></figure>
<p>æ‰¹é‡æ‰©ç¼©å®¹    </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for i in `kubectl get deployment | awk &#x27;&#123;print $1&#125;&#x27; |grep -v NAME`; do</span><br><span class="line">   kubectl scale Deployment $i --replicas=1</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<h6 id="exec-åœ¨containerä¸­æ‰§è¡Œå‘½ä»¤"><a href="#exec-åœ¨containerä¸­æ‰§è¡Œå‘½ä»¤" class="headerlink" title="exec-åœ¨containerä¸­æ‰§è¡Œå‘½ä»¤"></a>exec-åœ¨containerä¸­æ‰§è¡Œå‘½ä»¤</h6><p>Execute a command in a container.</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Options:</span><br><span class="line">  -c, --container=&#x27;&#x27;: Container name. If omitted, the first container in the pod will be chosen</span><br><span class="line">  -p, --pod=&#x27;&#x27;: Pod name</span><br><span class="line">  -i, --stdin=false: Pass stdin to the container</span><br><span class="line">  -t, --tty=false: Stdin is a TTY</span><br><span class="line">Examples:</span><br><span class="line">  kubectl exec 123456-7890 -c ruby-container -it -- bash -il</span><br><span class="line">Usage:</span><br><span class="line">  kubectl exec POD [-c CONTAINER] -- COMMAND [args...] [options]</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/Hexo-%E5%8D%9A%E5%AE%A2%E4%B8%AD%E6%B7%BB%E5%8A%A0%E5%9B%BE%E7%89%87%E7%AD%89%E8%B5%84%E6%BA%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GeekSRE">
      <meta itemprop="description" content="GeekSRE">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GeekSRE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/Hexo-%E5%8D%9A%E5%AE%A2%E4%B8%AD%E6%B7%BB%E5%8A%A0%E5%9B%BE%E7%89%87%E7%AD%89%E8%B5%84%E6%BA%90/" class="post-title-link" itemprop="url">Hexo-åšå®¢ä¸­æ·»åŠ å›¾ç‰‡ç­‰èµ„æº</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-04-21 14:28:55 / Modified: 14:37:28" itemprop="dateCreated datePublished" datetime="2019-04-21T14:28:55+08:00">2019-04-21</time>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>å¼•ç”¨äº <a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_40265501/article/details/80019774">https://blog.csdn.net/qq_40265501/article/details/80019774</a></p>
<p>å®˜æ–¹ä»‹ç»ï¼š<a target="_blank" rel="noopener" href="https://hexo.io/zh-cn/docs/asset-folders.html">https://hexo.io/zh-cn/docs/asset-folders.html</a></p>
</blockquote>
<p>ä¸€å›¾èƒœä¸‡è¨€</p>
<p>åšå®¢ä¸­æœ‰æ—¶å€™å›¾ç‰‡æ¯”æ–‡å­—æ›´æœ‰è¯´æœåŠ›ï¼Œæ¯”å¦‚ï¼šä»£ç è¿è¡Œç»“æœï¼Œä»£ç è¿è¡Œæ•ˆæœç­‰</p>
<h5 id="å¼€å¯â€™èµ„æºæ–‡ä»¶ç®¡ç†â€™åŠŸèƒ½"><a href="#å¼€å¯â€™èµ„æºæ–‡ä»¶ç®¡ç†â€™åŠŸèƒ½" class="headerlink" title="å¼€å¯â€™èµ„æºæ–‡ä»¶ç®¡ç†â€™åŠŸèƒ½"></a>å¼€å¯â€™èµ„æºæ–‡ä»¶ç®¡ç†â€™åŠŸèƒ½</h5><p>å°† <code>config.yml</code>æ–‡ä»¶ä¸­çš„ <code>post_asset_folder</code> é€‰é¡¹è®¾ä¸º <code>true</code></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">_config.yml</span><br><span class="line">post_asset_folder: true</span><br></pre></td></tr></table></figure>
<h5 id="å®‰è£…Hexoæ’ä»¶"><a href="#å®‰è£…Hexoæ’ä»¶" class="headerlink" title="å®‰è£…Hexoæ’ä»¶"></a>å®‰è£…Hexoæ’ä»¶</h5><p>æ’ä»¶åœ°å€ï¼š<a target="_blank" rel="noopener" href="https://github.com/dangxuandev/hexo-asset-image">https://github.com/dangxuandev/hexo-asset-image</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install hexo-asset-image --save</span><br></pre></td></tr></table></figure>
<h5 id="åœ¨åšå®¢ä¸­æ·»åŠ å›¾ç‰‡"><a href="#åœ¨åšå®¢ä¸­æ·»åŠ å›¾ç‰‡" class="headerlink" title="åœ¨åšå®¢ä¸­æ·»åŠ å›¾ç‰‡"></a>åœ¨åšå®¢ä¸­æ·»åŠ å›¾ç‰‡</h5><ol>
<li><p>æ–°å»ºåšå®¢</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo n test</span><br></pre></td></tr></table></figure>
</li>
<li><p>æŸ¥çœ‹ç›®å½•ç»“æ„</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">[root@nginx GeekSRE]# ls -l source&#x2F;_posts&#x2F; |grep test</span><br><span class="line">drwxr-xr-x 2 root root 4096 4æœˆ  17 17:29 test</span><br><span class="line">-rw-r--r-- 1 root root   96 4æœˆ  17 17:35 test.md</span><br></pre></td></tr></table></figure>
<p>å¯ä»¥çœ‹åˆ° ä¼šåœ¨ source/_posts ç›®å½•åˆ›å»º test.md å’Œ testç›®å½•</p>
<p>ä¸åšå®¢åŒåç›®å½•ç”¨äºå­˜æ”¾èµ„æºæ–‡ä»¶ï¼Œå¦‚å›¾ç‰‡ã€CSSã€JS æ–‡ä»¶ç­‰</p>
</li>
<li><p>ä¸Šä¼ å›¾ç‰‡åˆ°â€æ–‡ç« èµ„æºæ–‡ä»¶å¤¹â€</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> æ¯”å¦‚ä½¿ç”¨CSDNåšå®¢ä¸­çš„å›¾ç‰‡ï¼š</span></span><br><span class="line">cd source/_posts/test</span><br><span class="line">wget https://img-blog.csdn.net/20180420154609543</span><br><span class="line"></span><br></pre></td></tr></table></figure>
</li>
<li><p>å¼•ç”¨</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vim source/_posts/test.md</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> ![ä½ æƒ³è¦è¾“å…¥çš„æ›¿ä»£æ–‡å­—](å›¾ç‰‡æ–‡ä»¶)</span></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ¯”å¦‚ï¼š</span></span><br><span class="line">![å›¾ç‰‡](test.jpg)</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä¿å­˜</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hexo clean &amp;&amp; hexo g &amp;&amp; hexo d</span><br></pre></td></tr></table></figure>
</li>
<li><p>éªŒè¯æ•ˆæœ<br><img src="/Hexo-%E5%8D%9A%E5%AE%A2%E4%B8%AD%E6%B7%BB%E5%8A%A0%E5%9B%BE%E7%89%87%E7%AD%89%E8%B5%84%E6%BA%90/test.jpg" alt="å›¾ç‰‡"></p>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/GitLab%E4%BB%A3%E7%A0%81%E6%89%98%E7%AE%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GeekSRE">
      <meta itemprop="description" content="GeekSRE">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GeekSRE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/GitLab%E4%BB%A3%E7%A0%81%E6%89%98%E7%AE%A1/" class="post-title-link" itemprop="url">GitLabä»£ç æ‰˜ç®¡</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-04-16 16:28:46" itemprop="dateCreated datePublished" datetime="2019-04-16T16:28:46+08:00">2019-04-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-04-23 10:02:42" itemprop="dateModified" datetime="2019-04-23T10:02:42+08:00">2019-04-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/GitLab/" itemprop="url" rel="index"><span itemprop="name">GitLab</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>GitLab æ˜¯ä¸€ä¸ªç”¨äºä»“åº“ç®¡ç†ç³»ç»Ÿçš„å¼€æºé¡¹ç›®ï¼Œä½¿ç”¨<a target="_blank" rel="noopener" href="https://baike.baidu.com/item/Git">Git</a>ä½œä¸ºä»£ç ç®¡ç†å·¥å…·ï¼Œå¹¶åœ¨æ­¤åŸºç¡€ä¸Šæ­å»ºèµ·æ¥çš„webæœåŠ¡ã€‚</p>
<p>å®˜ç½‘ï¼š<a target="_blank" rel="noopener" href="https://about.gitlab.com/stages-devops-lifecycle/">https://about.gitlab.com/stages-devops-lifecycle/</a></p>
<hr>
<h4 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h4><h5 id="é…ç½®Yumæº"><a href="#é…ç½®Yumæº" class="headerlink" title="é…ç½®Yumæº"></a>é…ç½®Yumæº</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">vim /etc/yum.repos.d/gitlab_gitlab-ee.repo</span><br><span class="line">[gitlab-ce]</span><br><span class="line">name=Gitlab CE Repository</span><br><span class="line">baseurl=https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el$releasever/</span><br><span class="line">gpgcheck=0</span><br><span class="line">enabled=1</span><br></pre></td></tr></table></figure>
<h5 id="å®‰è£…-1"><a href="#å®‰è£…-1" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install -y postfix</span><br><span class="line">yum install gitlab-ce -y</span><br></pre></td></tr></table></figure>
<h5 id="é…ç½®"><a href="#é…ç½®" class="headerlink" title="é…ç½®"></a>é…ç½®</h5><p>é…ç½®æ–‡ä»¶ï¼š/etc/gitlab/gitlab.rb    (å»ºè®®æ¯æ¬¡ä¿®æ”¹å‰å¤‡ä»½æ­¤æ–‡ä»¶)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">	external_url &#x27;https://git.visualchina.com&#x27;    # åŸŸåé…ç½®</span><br><span class="line">	gitlab_rails[&#x27;time_zone&#x27;] = &#x27;Asia/Shanghai&#x27;   # æ—¶åŒº</span><br><span class="line">	</span><br><span class="line">	nginx[&#x27;redirect_http_to_https&#x27;] = true        # SSLè¯ä¹¦</span><br><span class="line">	nginx[&#x27;ssl_certificate&#x27;] = &quot;/data/vcg/ssl/visualchina.pem&quot;</span><br><span class="line">	nginx[&#x27;ssl_certificate_key&#x27;] = &quot;/data/vcg/ssl/visualchina.key&quot;</span><br><span class="line">	</span><br><span class="line">	gitlab_rails[&#x27;ldap_enabled&#x27;] = true</span><br><span class="line">gitlab_rails[&#x27;ldap_servers&#x27;] = YAML.load &lt;&lt;-&#x27;EOS&#x27; # remember to close this block with &#x27;EOS&#x27; below</span><br><span class="line">  main: # &#x27;main&#x27; is the GitLab &#x27;provider ID&#x27; of this LDAP server</span><br><span class="line">    label: &#x27;LDAP&#x27;</span><br><span class="line">    host: &#x27;172.16.239.3&#x27;</span><br><span class="line">    port: 389</span><br><span class="line">    uid: &#x27;cn&#x27;</span><br><span class="line">    method: &#x27;plain&#x27; # &quot;tls&quot; or &quot;ssl&quot; or &quot;plain&quot;</span><br><span class="line">    bind_dn: &#x27;cn=root,dc=vcg,dc=com&#x27;</span><br><span class="line">    password: &#x27;vcg@2018&#x27;</span><br><span class="line">    active_directory: true</span><br><span class="line">    allow_username_or_email_login: false</span><br><span class="line">    block_auto_created_users: false</span><br><span class="line">    base: &#x27;ou=People,dc=vcg,dc=com&#x27;</span><br><span class="line">    user_filter: &#x27;&#x27;</span><br><span class="line">    attributes:</span><br><span class="line">      username: [&#x27;cn&#x27;]</span><br><span class="line">      email:    [&#x27;mail&#x27;]</span><br><span class="line">      name:       &#x27;cn&#x27;</span><br><span class="line">      first_name: &#x27;givenName&#x27;</span><br><span class="line">      last_name:  &#x27;sn&#x27;</span><br><span class="line">EOS</span><br></pre></td></tr></table></figure>
<h5 id="é…ç½®å®Œæˆåè¿›è¡Œé…ç½®æ›´æ–°"><a href="#é…ç½®å®Œæˆåè¿›è¡Œé…ç½®æ›´æ–°" class="headerlink" title="é…ç½®å®Œæˆåè¿›è¡Œé…ç½®æ›´æ–°"></a>é…ç½®å®Œæˆåè¿›è¡Œé…ç½®æ›´æ–°</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl reconfigure</span><br></pre></td></tr></table></figure>
<h5 id="æ£€æŸ¥æ˜¯å¦é…ç½®æˆåŠŸ"><a href="#æ£€æŸ¥æ˜¯å¦é…ç½®æˆåŠŸ" class="headerlink" title="æ£€æŸ¥æ˜¯å¦é…ç½®æˆåŠŸ"></a>æ£€æŸ¥æ˜¯å¦é…ç½®æˆåŠŸ</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-rake gitlab:ldap:checkï¼ˆåˆ—å‡ºå‰100ä¸ªç”¨æˆ·ï¼‰</span><br></pre></td></tr></table></figure>
<h5 id="é‡å¯gitlabæœåŠ¡"><a href="#é‡å¯gitlabæœåŠ¡" class="headerlink" title="é‡å¯gitlabæœåŠ¡"></a>é‡å¯gitlabæœåŠ¡</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gitlab-ctl restart</span><br></pre></td></tr></table></figure>
<h5 id="è®¿é—®"><a href="#è®¿é—®" class="headerlink" title="è®¿é—®"></a>è®¿é—®</h5><p>è®¿é—®ip:80ç«¯å£ é…ç½®rootå¯†ç ï¼Œè‡³æ­¤éƒ¨ç½²å®Œæˆã€‚</p>
<h4 id="å‡çº§"><a href="#å‡çº§" class="headerlink" title="å‡çº§"></a>å‡çº§</h4><h5 id="å‡çº§è§„èŒƒå’Œå»ºè®®"><a href="#å‡çº§è§„èŒƒå’Œå»ºè®®" class="headerlink" title="å‡çº§è§„èŒƒå’Œå»ºè®®"></a>å‡çº§è§„èŒƒå’Œå»ºè®®</h5><p><a target="_blank" rel="noopener" href="https://docs.gitlab.com/ee/policy/maintenance.html#upgrade-recommendations">https://docs.gitlab.com/ee/policy/maintenance.html#upgrade-recommendations</a></p>
<p>é¦–å…ˆå‡çº§åˆ°ä¸»è¦ç‰ˆæœ¬ä¸­çš„æœ€æ–°å¯ç”¨æ¬¡è¦ç‰ˆæœ¬</p>
<p>ä¾‹å¦‚ï¼š8.13.4 å‡çº§åˆ° 11.3.4 ï¼Œå‡çº§è·¯å¾„ä¸º 8.13.4 -&gt; 8.17.7 -&gt; 9.5.10 -&gt; 10.8.7 -&gt; 11.3.4</p>
<p>â€‹    å³ï¼š<code>8.17.7</code>æ˜¯ç‰ˆæœ¬<code>8</code>ä¸­çš„æœ€åä¸€ä¸ªç‰ˆæœ¬, <code>9.5.10</code>æ˜¯ç‰ˆæœ¬<code>9</code>ä¸­çš„æœ€åä¸€ä¸ªç‰ˆæœ¬, <code>10.8.7</code>æ˜¯ç‰ˆæœ¬<code>10</code>ä¸­çš„æœ€åä¸€ä¸ªç‰ˆæœ¬</p>
<h5 id="å‡çº§æ“ä½œ"><a href="#å‡çº§æ“ä½œ" class="headerlink" title="å‡çº§æ“ä½œ"></a>å‡çº§æ“ä½œ</h5><p>æœ¬æ¬¡å‡çº§ç‰ˆæœ¬ä¸º 10.7.0 ï¼Œå‡çº§åˆ°æœ€æ–°ç‰ˆæœ¬ 11.9.8 ï¼Œæ³¨ï¼š2019å¹´04æœˆ16æ—¥</p>
<h6 id="1ã€ä¸‹è½½10-8-7ç‰ˆæœ¬çš„rpmåŒ…"><a href="#1ã€ä¸‹è½½10-8-7ç‰ˆæœ¬çš„rpmåŒ…" class="headerlink" title="1ã€ä¸‹è½½10.8.7ç‰ˆæœ¬çš„rpmåŒ…"></a>1ã€ä¸‹è½½10.8.7ç‰ˆæœ¬çš„rpmåŒ…</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">wget https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el7/gitlab-ce-10.8.7-ce.0.el7.x86_64.rpm</span><br></pre></td></tr></table></figure>
<h6 id="2ã€å®‰è£…å‡çº§åˆ°10-8-7ç‰ˆæœ¬"><a href="#2ã€å®‰è£…å‡çº§åˆ°10-8-7ç‰ˆæœ¬" class="headerlink" title="2ã€å®‰è£…å‡çº§åˆ°10.8.7ç‰ˆæœ¬"></a>2ã€å®‰è£…å‡çº§åˆ°10.8.7ç‰ˆæœ¬</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rpm -Uvh gitlab-ce-10.8.7-ce.0.el7.x86_64.rpm</span><br></pre></td></tr></table></figure>
<h6 id="3ã€å†å‡çº§åˆ°11-9-8ç‰ˆæœ¬"><a href="#3ã€å†å‡çº§åˆ°11-9-8ç‰ˆæœ¬" class="headerlink" title="3ã€å†å‡çº§åˆ°11.9.8ç‰ˆæœ¬"></a>3ã€å†å‡çº§åˆ°11.9.8ç‰ˆæœ¬</h6><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install gitlab-ce.x86_64</span><br></pre></td></tr></table></figure>
<h4 id="è¿ç§»"><a href="#è¿ç§»" class="headerlink" title="è¿ç§»"></a>è¿ç§»</h4><h5 id="å¤‡ä»½æºGitLabæ•°æ®"><a href="#å¤‡ä»½æºGitLabæ•°æ®" class="headerlink" title="å¤‡ä»½æºGitLabæ•°æ®"></a>å¤‡ä»½æºGitLabæ•°æ®</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gitlab-rake gitlab:backup:create RAILS_ENV=production</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> Creating backup archive: 1555983152_2019_04_23_11.9.8_gitlab_backup.tar ...</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> æ•°æ®ä¿å­˜åœ¨ /var/opt/gitlab/backupsï¼Œè‡ªåŠ¨ç”Ÿæˆæ–‡ä»¶åï¼Œæ¯”å¦‚æœ¬æ¬¡çš„ 1555983152_2019_04_23_11.9.8_gitlab_backup.tar</span></span><br></pre></td></tr></table></figure>
<h5 id="SCPè¿ç§»æ•°æ®"><a href="#SCPè¿ç§»æ•°æ®" class="headerlink" title="SCPè¿ç§»æ•°æ®"></a>SCPè¿ç§»æ•°æ®</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">æŒ‰éœ€æ›¿æ¢ç›®æ ‡åœ°å€</span></span><br><span class="line">scp /var/opt/gitlab/backups/1555983152_2019_04_23_11.9.8_gitlab_backup.tar root@1.1.1.1:/root/var/opt/gitlab/backups</span><br></pre></td></tr></table></figure>
<h5 id="å®‰è£…GitLab"><a href="#å®‰è£…GitLab" class="headerlink" title="å®‰è£…GitLab"></a>å®‰è£…GitLab</h5><p>è¯·å‚è€ƒ å®‰è£… ç« èŠ‚</p>
<h5 id="æ¢å¤æ•°æ®"><a href="#æ¢å¤æ•°æ®" class="headerlink" title="æ¢å¤æ•°æ®"></a>æ¢å¤æ•°æ®</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">gitlab-rake gitlab:backup:restore RAILS_ENV=production BACKUP=1555983152_2019_04_23_11.9.8</span><br><span class="line"><span class="meta">#</span><span class="bash"> BACKUPçš„æ—¶é—´ç‚¹å¿…é¡»ä¸åŸæœåŠ¡å™¨å¤‡ä»½åçš„æ–‡ä»¶åä¸€è‡´</span></span><br></pre></td></tr></table></figure>
<h4 id="ç»´æŠ¤"><a href="#ç»´æŠ¤" class="headerlink" title="ç»´æŠ¤"></a>ç»´æŠ¤</h4><h5 id="å®šæœŸå¤‡ä»½"><a href="#å®šæœŸå¤‡ä»½" class="headerlink" title="å®šæœŸå¤‡ä»½"></a>å®šæœŸå¤‡ä»½</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">crontab -l</span><br><span class="line"></span><br><span class="line">0 14 * * * /usr/bin/gitlab-rake gitlab:backup:create</span><br><span class="line">0 15 * * * find /var/opt/gitlab/backups/* -type f -mtime +3 -exec rm &#123;&#125; \;</span><br></pre></td></tr></table></figure>
<h5 id="gitlab-ctlå‘½ä»¤"><a href="#gitlab-ctlå‘½ä»¤" class="headerlink" title="gitlab-ctlå‘½ä»¤"></a>gitlab-ctlå‘½ä»¤</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line">[root@iZ2ze4cng635a2k047qus5Z ~]# gitlab-ctl --help</span><br><span class="line">omnibus-ctl: command (subcommand)</span><br><span class="line">check-config</span><br><span class="line">  Check if there are any configuration in gitlab.rb that is removed in specified version</span><br><span class="line">deploy-page</span><br><span class="line">  Put up the deploy page</span><br><span class="line">diff-config</span><br><span class="line">  Compare the user configuration with package available configuration</span><br><span class="line">prometheus-upgrade</span><br><span class="line">  Upgrade the Prometheus data to the latest supported version</span><br><span class="line">remove-accounts</span><br><span class="line">  Delete *all* users and groups used by this package</span><br><span class="line">upgrade</span><br><span class="line">  Run migrations after a package upgrade</span><br><span class="line">General Commands:</span><br><span class="line">  cleanse</span><br><span class="line">    Delete *all* gitlab data, and start from scratch.</span><br><span class="line">  help</span><br><span class="line">    Print this help message.</span><br><span class="line">  reconfigure</span><br><span class="line">    Reconfigure the application.</span><br><span class="line">  show-config</span><br><span class="line">    Show the configuration that would be generated by reconfigure.</span><br><span class="line">  uninstall</span><br><span class="line">    Kill all processes and uninstall the process supervisor (data will be preserved).</span><br><span class="line">Service Management Commands:</span><br><span class="line">  graceful-kill</span><br><span class="line">    Attempt a graceful stop, then SIGKILL the entire process group.</span><br><span class="line">  hup</span><br><span class="line">    Send the services a HUP.</span><br><span class="line">  int</span><br><span class="line">    Send the services an INT.</span><br><span class="line">  kill</span><br><span class="line">    Send the services a KILL.</span><br><span class="line">  once</span><br><span class="line">    Start the services if they are down. Do not restart them if they stop.</span><br><span class="line">  restart</span><br><span class="line">    Stop the services if they are running, then start them again.</span><br><span class="line">  service-list</span><br><span class="line">    List all the services (enabled services appear with a *.)</span><br><span class="line">  start</span><br><span class="line">    Start services if they are down, and restart them if they stop.</span><br><span class="line">  status</span><br><span class="line">    Show the status of all the services.</span><br><span class="line">  stop</span><br><span class="line">    Stop the services, and do not restart them.</span><br><span class="line">  tail</span><br><span class="line">    Watch the service logs of all enabled services.</span><br><span class="line">  term</span><br><span class="line">    Send the services a TERM.</span><br><span class="line">  usr1</span><br><span class="line">    Send the services a USR1.</span><br><span class="line">  usr2</span><br><span class="line">    Send the services a USR2.</span><br><span class="line">Container Registry Commands:</span><br><span class="line">  registry-garbage-collect</span><br><span class="line">    Run Container Registry garbage collection.</span><br><span class="line">Database Commands:</span><br><span class="line">  pg-password-md5</span><br><span class="line">    Generate MD5 Hash of user password in PostgreSQL format</span><br><span class="line">  pg-upgrade</span><br><span class="line">    Upgrade the PostgreSQL DB to the latest supported version</span><br><span class="line">  revert-pg-upgrade</span><br><span class="line">    Run this to revert to the previous version of the database</span><br><span class="line">  set-replication-password</span><br><span class="line">    Set database replication password</span><br><span class="line">Let&#x27;s Encrypt Commands:</span><br><span class="line">  renew-le-certs</span><br><span class="line">    Renew the existing Let&#x27;s Encrypt certificates</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/%E5%9F%9F%E5%90%8DSSL%E8%AF%81%E4%B9%A6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GeekSRE">
      <meta itemprop="description" content="GeekSRE">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GeekSRE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/%E5%9F%9F%E5%90%8DSSL%E8%AF%81%E4%B9%A6/" class="post-title-link" itemprop="url">åŸŸåSSLè¯ä¹¦</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2019-04-16 15:04:09" itemprop="dateCreated datePublished" datetime="2019-04-16T15:04:09+08:00">2019-04-16</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2019-04-23 09:51:30" itemprop="dateModified" datetime="2019-04-23T09:51:30+08:00">2019-04-23</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/SSL%E8%AF%81%E4%B9%A6/" itemprop="url" rel="index"><span itemprop="name">SSLè¯ä¹¦</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h2 id="SSLè¯ä¹¦"><a href="#SSLè¯ä¹¦" class="headerlink" title="SSLè¯ä¹¦"></a>SSLè¯ä¹¦</h2><ul>
<li><p>ä»€ä¹ˆæ˜¯æ•°å­—è¯ä¹¦ï¼Ÿ</p>
<p>æ•°å­—è¯ä¹¦æ˜¯ä¸€ä¸ªç»æƒå¨æˆæƒæœºæ„æ•°å­—ç­¾åã€åŒ…å«å…¬å¼€å¯†é’¥æ‹¥æœ‰è€…ä¿¡æ¯ä»¥åŠå…¬å¼€å¯†é’¥çš„æ–‡ä»¶ï¼Œæ˜¯æƒå¨æœºæ„é¢å‘ç»™ç½‘ç«™çš„å¯ä¿¡å‡­è¯ã€‚æœ€ç®€å•çš„è¯ä¹¦åŒ…å«ä¸€ä¸ªå…¬å¼€å¯†é’¥ã€è¯ä¹¦åç§°ä»¥åŠè¯ä¹¦æˆæƒä¸­å¿ƒçš„æ•°å­—ç­¾åã€‚</p>
<p>æ•°å­—è¯ä¹¦è¿˜æœ‰ä¸€ä¸ªé‡è¦çš„ç‰¹å¾ï¼šåªåœ¨ç‰¹å®šçš„æ—¶é—´æ®µå†…æœ‰æ•ˆã€‚</p>
</li>
<li><p>ä»€ä¹ˆæ˜¯SSLï¼Ÿ</p>
<p>SSLåè®®æ˜¯ä¸€ç§å¯å®ç°ç½‘ç»œé€šä¿¡åŠ å¯†çš„å®‰å…¨åè®®ï¼Œå¯åœ¨æµè§ˆå™¨å’Œç½‘ç«™ä¹‹é—´å»ºç«‹åŠ å¯†é€šé“ï¼Œä¿éšœæ•°æ®åœ¨ä¼ è¾“çš„è¿‡ç¨‹ä¸­ä¸è¢«ç¯¡æ”¹æˆ–çªƒå–ã€‚</p>
</li>
<li><p>ä»€ä¹ˆæ˜¯SSLè¯ä¹¦ï¼Ÿ</p>
<p>SSLè¯ä¹¦é‡‡ç”¨SSLåè®®è¿›è¡Œé€šä¿¡ï¼Œæ˜¯ç”±æƒå¨æœºæ„é¢å‘ç»™ç½‘ç«™çš„å¯ä¿¡å‡­è¯ã€‚</p>
<p>SSLè¯ä¹¦é‡‡ç”¨SSLåè®®è¿›è¡Œé€šä¿¡ã€‚SSLè¯ä¹¦éƒ¨ç½²åˆ°WebæœåŠ¡å™¨åï¼ŒWebæœåŠ¡å™¨è®¿é—®å°†å¯ç”¨HTTPSåè®®ã€‚æ‚¨çš„ç½‘ç«™å°†ä¼šé€šè¿‡ HTTPS åŠ å¯†åè®®æ¥ä¼ è¾“æ•°æ®ï¼Œå¯å¸®åŠ©WebæœåŠ¡å™¨å’Œç½‘ç«™é—´å»ºç«‹å¯ä¿¡çš„åŠ å¯†é“¾æ¥ï¼Œä»è€Œä¿è¯ç½‘ç»œæ•°æ®ä¼ è¾“çš„å®‰å…¨ã€‚</p>
</li>
<li><p>ä»€ä¹ˆæ˜¯HTTPSï¼Ÿ</p>
<p>HTTPSæ˜¯ä¸€ç§åŸºäºSSLåè®®çš„ç½‘ç«™åŠ å¯†ä¼ è¾“åè®®ã€‚</p>
<p>ç½‘ç«™å®‰è£…SSLè¯ä¹¦åï¼Œä½¿ç”¨HTTPSåŠ å¯†åè®®è®¿é—®ï¼Œå¯æ¿€æ´»å®¢æˆ·ç«¯æµè§ˆå™¨åˆ°ç½‘ç«™æœåŠ¡å™¨ä¹‹é—´çš„<strong>SSLåŠ å¯†é€šé“</strong>ï¼ˆSSLåè®®ï¼‰ï¼Œä»è€Œå®ç°é«˜å¼ºåº¦åŒå‘åŠ å¯†ä¼ è¾“ï¼Œé˜²æ­¢ä¼ è¾“æ•°æ®è¢«æ³„éœ²æˆ–ç¯¡æ”¹ã€‚HTTPS ä¹Ÿå°±æ˜¯HTTP + SSLï¼Œæ˜¯HTTPçš„å®‰å…¨ç‰ˆã€‚</p>
</li>
<li><p>ä»€ä¹ˆæ˜¯CAè®¤è¯ä¸­å¿ƒï¼Ÿ</p>
<p>CAè®¤è¯ä¸­å¿ƒï¼ˆCAæœºæ„ï¼‰ï¼Œå³è¯ä¹¦æˆæƒä¸­å¿ƒï¼ˆCertificate Authorityï¼‰ï¼Œæˆ–ç§°è¯ä¹¦æˆæƒæœºæ„ã€‚</p>
<p>CAè®¤è¯ä¸­å¿ƒä½œä¸ºç”µå­å•†åŠ¡äº¤æ˜“ä¸­å—ä¿¡ä»»çš„ç¬¬ä¸‰æ–¹ï¼Œæ‰¿æ‹…å…¬é’¥ä½“ç³»ä¸­å…¬é’¥åˆæ³•æ€§æ£€éªŒçš„è´£ä»»ã€‚</p>
</li>
</ul>
<h2 id="SSLè¯ä¹¦ç±»å‹é…ç½®è¡¨"><a href="#SSLè¯ä¹¦ç±»å‹é…ç½®è¡¨" class="headerlink" title="SSLè¯ä¹¦ç±»å‹é…ç½®è¡¨"></a>SSLè¯ä¹¦ç±»å‹é…ç½®è¡¨</h2><p>è¯ä¹¦æ ¹æ®ä¸åŒçš„éªŒè¯çº§åˆ«ï¼Œåˆ†ä¸ºä»¥ä¸‹ä¸‰ç±»ï¼š</p>
<ul>
<li>åŸŸåå‹SSLï¼ˆDV SSLï¼‰</li>
<li>ä¼ä¸šå‹SSLï¼ˆOV SSLï¼‰</li>
<li>å¢å¼ºå‹SSLï¼ˆEV SSLï¼‰</li>
</ul>
<p>æ ¹æ®ä¿æŠ¤åŸŸåçš„æ•°é‡éœ€æ±‚ï¼ŒSSL è¯ä¹¦åˆåˆ†ä¸ºï¼š</p>
<ul>
<li>å•åŸŸåç‰ˆï¼šåªä¿æŠ¤ä¸€ä¸ªåŸŸåï¼Œä¾‹å¦‚ <a target="_blank" rel="noopener" href="http://www.abc.com">www.abc.com</a> æˆ–è€… login.abc.com ä¹‹ç±»çš„å•ä¸ªåŸŸå</li>
<li>å¤šåŸŸåç‰ˆï¼šä¸€å¼ è¯ä¹¦å¯ä»¥ä¿æŠ¤å¤šä¸ªåŸŸåï¼Œä¾‹å¦‚åŒæ—¶ä¿æŠ¤ <a target="_blank" rel="noopener" href="http://www.abc.com">www.abc.com</a> , <a target="_blank" rel="noopener" href="http://www.bcd.com">www.bcd.com</a>, pay.efg.com ç­‰</li>
<li>é€šé…ç¬¦ç‰ˆï¼šä¸€å¼ è¯ä¹¦ä¿æŠ¤åŒä¸€ä¸ªä¸»åŸŸåä¸‹åŒä¸€çº§çš„æ‰€æœ‰å­åŸŸåï¼Œä¸é™ä¸ªæ•°ï¼Œå½¢å¦‚ *.abc.com ã€‚æ³¨æ„ï¼Œé€šé…ç¬¦ç‰ˆåªæœ‰ DVSSL å’Œ OVSSL å…·æœ‰ï¼Œ EVSSL ä¸å…·æœ‰é€šé…ç¬¦ç‰ˆæœ¬ã€‚</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:left">è¯ä¹¦å“ç‰Œ</th>
<th style="text-align:left">è¯ä¹¦ç±»å‹</th>
<th style="text-align:left">ä¿æŠ¤åŸŸåçš„ç±»å‹</th>
<th style="text-align:left">è¯´æ˜</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">GeoTrust</td>
<td style="text-align:left">ä¸“ä¸šç‰ˆOV SSL</td>
<td style="text-align:left">1ä¸ªå¸¦é€šé…ç¬¦çš„åŸŸå1ä¸ªæ˜ç»†åŸŸåå¤šä¸ªæ˜ç»†åŸŸå</td>
<td style="text-align:left">æä¾›åŠ å¯†åŠŸèƒ½ï¼Œå¯¹ç”³è¯·è€…çš„èº«ä»½è¿›è¡Œä¸¥æ ¼çš„å®¡æ ¸éªŒè¯ï¼Œå¯æä¾›å¯ä¿¡èº«ä»½è¯æ˜ã€‚å¤šä¸ªåŸŸåä¾‹ä¸Šé™ä¸º300ä¸ªã€‚å¦‚: buy1.example.com, buy2.example.com, next.buy.example2.com, ä¸Šè¿°3ä¸ªæ˜ç»†å­åŸŸåè®¡ç®—ä¸º3ä¸ªåŸŸåã€‚</td>
</tr>
<tr>
<td style="text-align:left">é«˜çº§ç‰ˆEV SSL</td>
<td style="text-align:left">1ä¸ªåŸŸåå¤šä¸ªåŸŸå</td>
<td style="text-align:left">æä¾›åŠ å¯†åŠŸèƒ½ï¼Œå¯¹ç”³è¯·è€…åšæœ€ä¸¥æ ¼çš„èº«ä»½å®¡æ ¸éªŒè¯ï¼Œæä¾›æœ€é«˜åº¦å¯ä¿¡èº«ä»½è¯æ˜ï¼Œæä¾›æµè§ˆå™¨ç»¿è‰²åœ°å€æ ã€‚</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">GlobalSign</td>
<td style="text-align:left">ä¸“ä¸šç‰ˆOV SSL</td>
<td style="text-align:left">é€šé…ç¬¦åŸŸå</td>
<td style="text-align:left">æä¾›åŠ å¯†åŠŸèƒ½ï¼Œå¯¹ç”³è¯·è€…è¿›è¡Œä¸¥æ ¼çš„èº«ä»½å®¡æ ¸éªŒè¯ï¼Œæä¾›å¯ä¿¡èº«ä»½è¯æ˜ã€‚</td>
</tr>
<tr>
<td style="text-align:left">CFCA</td>
<td style="text-align:left">ä¸“ä¸šç‰ˆOV SSL</td>
<td style="text-align:left">é€šé…ç¬¦åŸŸå1ä¸ªåŸŸåå¤šä¸ªåŸŸå</td>
<td style="text-align:left">æä¾›åŠ å¯†åŠŸèƒ½ï¼Œå¯¹ç”³è¯·è€…è¿›è¡Œä¸¥æ ¼çš„èº«ä»½å®¡æ ¸éªŒè¯ï¼Œæä¾›å¯ä¿¡èº«ä»½è¯æ˜ã€‚</td>
</tr>
<tr>
<td style="text-align:left">é«˜çº§ç‰ˆEV SSL</td>
<td style="text-align:left">1ä¸ªåŸŸåå¤šä¸ªåŸŸå</td>
<td style="text-align:left">æä¾›åŠ å¯†åŠŸèƒ½ï¼Œå¯¹ç”³è¯·è€…åšæœ€ä¸¥æ ¼çš„èº«ä»½å®¡æ ¸éªŒè¯ï¼Œæä¾›æœ€é«˜åº¦å¯ä¿¡èº«ä»½è¯æ˜ï¼Œæä¾›æµè§ˆå™¨ç»¿è‰²åœ°å€æ ã€‚</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">Symantec</td>
<td style="text-align:left">ä¸“ä¸šç‰ˆOV SSL</td>
<td style="text-align:left">é€šé…ç¬¦åŸŸå1ä¸ªåŸŸåå¤šä¸ªåŸŸå</td>
<td style="text-align:left">æä¾›åŠ å¯†åŠŸèƒ½ï¼Œå¯¹ç”³è¯·è€…è¿›è¡Œä¸¥æ ¼çš„èº«ä»½å®¡æ ¸éªŒè¯ï¼Œæä¾›å¯ä¿¡èº«ä»½è¯æ˜ã€‚</td>
</tr>
<tr>
<td style="text-align:left">é€šé…ç¬¦DV SSL</td>
<td style="text-align:left">é€šé…ç¬¦åŸŸå</td>
<td style="text-align:left"></td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">å¢å¼ºå‹OV SSL</td>
<td style="text-align:left">1ä¸ªåŸŸåå¤šä¸ªåŸŸå</td>
<td style="text-align:left">æä¾›ç«™ç‚¹åŠ å¯†åŠŸèƒ½ï¼Œéœ€è¦æ ¸éªŒç»„ç»‡æ³¨å†Œä¿¡æ¯ï¼Œè¯ä¹¦ä¸­ä¼šæ˜¾ç¤ºç»„ç»‡åç§°ã€‚ç»„ç»‡ä¿¡æ¯éªŒè¯é€šè¿‡åï¼Œ3ä¸ªå·¥ä½œæ—¥å†…é¢å‘è¯ä¹¦ã€‚</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">é«˜çº§ç‰ˆEV SSL</td>
<td style="text-align:left">1ä¸ªåŸŸåå¤šä¸ªåŸŸå</td>
<td style="text-align:left">æä¾›åŠ å¯†åŠŸèƒ½ï¼Œå¯¹ç”³è¯·è€…åšæœ€ä¸¥æ ¼çš„èº«ä»½å®¡æ ¸éªŒè¯ï¼Œæä¾›æœ€é«˜åº¦å¯ä¿¡èº«ä»½è¯æ˜ï¼Œæä¾›æµè§ˆå™¨ç»¿è‰²åœ°å€æ ã€‚</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">å¢å¼ºå‹EV SSL</td>
<td style="text-align:left">1ä¸ªåŸŸåå¤šä¸ªåŸŸå</td>
<td style="text-align:left">å¢å¼ºå‹EV SSLæä¾›ç«™ç‚¹åŠ å¯†åŠŸèƒ½ï¼Œæµè§ˆå™¨ç»¿è‰²åœ°å€æ æ˜¾ç¤ºç»„ç»‡ä¿¡æ¯å¼ºåŒ–ä¿¡ä»»ã€‚ç»„ç»‡ä¿¡æ¯éªŒè¯é€šè¿‡å7ä¸ªå·¥ä½œæ—¥å†…é¢å‘è¯ä¹¦ã€‚</td>
<td style="text-align:left"></td>
</tr>
<tr>
<td style="text-align:left">å…è´¹å‹DV SSL</td>
<td style="text-align:left">1ä¸ªåŸŸå</td>
<td style="text-align:left">å…è´¹æ–°æ ¹è¯ä¹¦ï¼Œåˆ‡å…¥DigiCert PKIä½“ç³»ï¼Œå…¼å®¹æ€§æ“ä½œç³»ç»Ÿç‰ˆæœ¬IOS 5.0+ã€Android 2.3.3+ã€JRE 1.6.5+ã€WIN 7+ã€‚æœ€å¤šä¿æŠ¤ä¸€ä¸ªæ˜ç»†å­åŸŸåï¼Œä¸æ”¯æŒé€šé…ç¬¦ï¼Œä¸€ä¸ªé˜¿é‡Œäº‘å¸æˆ·æœ€å¤šç­¾å‘20å¼ å…è´¹è¯ä¹¦ã€‚</td>
</tr>
</tbody>
</table>
<h2 id="SSLè¯ä¹¦è´­ä¹°"><a href="#SSLè¯ä¹¦è´­ä¹°" class="headerlink" title="SSLè¯ä¹¦è´­ä¹°"></a>SSLè¯ä¹¦è´­ä¹°</h2><p>ç™»å½•é˜¿é‡Œäº‘æ§åˆ¶å°ï¼Œè¿›å…¥SSLè¯ä¹¦æœåŠ¡ã€‚</p>
<p><img src="/%E5%9F%9F%E5%90%8DSSL%E8%AF%81%E4%B9%A6/å…è´¹SSLè¯ä¹¦è´­ä¹°.jpg" alt="å…è´¹SSLè¯ä¹¦è´­ä¹°"></p>
<h2 id="SSLè¯ä¹¦æ›´æ–°"><a href="#SSLè¯ä¹¦æ›´æ–°" class="headerlink" title="SSLè¯ä¹¦æ›´æ–°"></a>SSLè¯ä¹¦æ›´æ–°</h2><p>å…¬å¸åŸŸåSSLè¯ä¹¦å³å°†åˆ°æœŸï¼Œæ›¿æ¢SSLè¯ä¹¦éœ€çŸ¥é“å“ªäº›äºŒçº§åŸŸåä½¿ç”¨äº†HTTPSè®¿é—®ï¼Œå¹¶ä¸”è·å–SSLè¯ä¹¦è¿‡æœŸæ—¶é—´ï¼Œæ¥éªŒè¯è¯ä¹¦æ˜¯å¦æ›´æ–°ã€‚</p>
<h5 id="è·å–åŸŸåä¸‹çš„è§£æä¿¡æ¯"><a href="#è·å–åŸŸåä¸‹çš„è§£æä¿¡æ¯" class="headerlink" title="è·å–åŸŸåä¸‹çš„è§£æä¿¡æ¯"></a>è·å–åŸŸåä¸‹çš„è§£æä¿¡æ¯</h5><p>ç™»å½•åŸŸåæœåŠ¡å•†æ§åˆ¶æ¡â€”äº‘è§£æâ€”åŸŸåè§£æåˆ—è¡¨â€”å¯¼å‡ºè§£æè®°å½•</p>
<p>å°†äºŒçº§åŸŸåçš„è®°å½•å†™å…¥domains.txtæ–‡ä»¶å¤‡ç”¨</p>
<h5 id="ç¼–å†™è„šæœ¬"><a href="#ç¼–å†™è„šæœ¬" class="headerlink" title="ç¼–å†™è„šæœ¬"></a>ç¼–å†™è„šæœ¬</h5><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash">!/bin/bash</span></span><br><span class="line">for domain in `cat domains.txt` #è¯»å–å­˜å‚¨äº†éœ€è¦ç›‘æµ‹çš„åŸŸåçš„æ–‡ä»¶</span><br><span class="line">do</span><br><span class="line">    curl $domain.vcg.com:443 1&gt;/dev/null 2&gt;/dev/null --connect-timeout 3</span><br><span class="line">    if [[ $? -eq 0  ]]; then</span><br><span class="line">      END_TIME=$(echo | openssl s_client -servername $domain.vcg.com  -connect $domain.vcg.com:443 2&gt;/dev/null | openssl x509 -noout -dates |grep &#x27;After&#x27;| awk -F &#x27;=&#x27; &#x27;&#123;print $2&#125;&#x27;| awk -F &#x27; +&#x27; &#x27;&#123;print $1,$2,$4 &#125;&#x27; )</span><br><span class="line">      echo &quot;$domain.vcg.com çš„SSLè¯ä¹¦åˆ°æœŸæ—¶é—´ä¸º $END_TIME  &quot;  &gt;&gt; result1.txt</span><br><span class="line">    else</span><br><span class="line">      echo &quot;$domain.vcg.com æ²¡https &quot; &gt;&gt; result1.txt</span><br><span class="line">    fi</span><br><span class="line">done</span><br></pre></td></tr></table></figure>
<h5 id="æ ¹æ®è¾“å‡ºæ–‡ä»¶æŸ¥çœ‹SSLè¯ä¹¦è¿‡æœŸæ—¶é—´ï¼Œè¿›è¡Œè¯ä¹¦æ›¿æ¢å·¥ä½œ"><a href="#æ ¹æ®è¾“å‡ºæ–‡ä»¶æŸ¥çœ‹SSLè¯ä¹¦è¿‡æœŸæ—¶é—´ï¼Œè¿›è¡Œè¯ä¹¦æ›¿æ¢å·¥ä½œ" class="headerlink" title="æ ¹æ®è¾“å‡ºæ–‡ä»¶æŸ¥çœ‹SSLè¯ä¹¦è¿‡æœŸæ—¶é—´ï¼Œè¿›è¡Œè¯ä¹¦æ›¿æ¢å·¥ä½œ"></a>æ ¹æ®è¾“å‡ºæ–‡ä»¶æŸ¥çœ‹SSLè¯ä¹¦è¿‡æœŸæ—¶é—´ï¼Œè¿›è¡Œè¯ä¹¦æ›¿æ¢å·¥ä½œ</h5><h5 id="SSLè¯ä¹¦æ›´æ–°çš„é…ç½®è·¯å¾„"><a href="#SSLè¯ä¹¦æ›´æ–°çš„é…ç½®è·¯å¾„" class="headerlink" title="SSLè¯ä¹¦æ›´æ–°çš„é…ç½®è·¯å¾„"></a>SSLè¯ä¹¦æ›´æ–°çš„é…ç½®è·¯å¾„</h5><ul>
<li>é˜¿é‡Œäº‘OSS-å¯¹è±¡å­˜å‚¨</li>
<li>é˜¿é‡Œäº‘WAF-Webé˜²ç«å¢™</li>
<li>é˜¿é‡Œäº‘SLB-è´Ÿè½½å‡è¡¡</li>
<li>Nginx</li>
</ul>
<p>##### </p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E5%92%8C%E9%98%B2%E5%BE%A1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GeekSRE">
      <meta itemprop="description" content="GeekSRE">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GeekSRE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E5%92%8C%E9%98%B2%E5%BE%A1/" class="post-title-link" itemprop="url">æš´åŠ›ç ´è§£æ”»å‡»å’Œé˜²å¾¡</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-04-16 14:27:48 / Modified: 16:49:51" itemprop="dateCreated datePublished" datetime="2019-04-16T14:27:48+08:00">2019-04-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/" itemprop="url" rel="index"><span itemprop="name">Linux</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Linux/%E5%AE%89%E5%85%A8/" itemprop="url" rel="index"><span itemprop="name">å®‰å…¨</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>å¼•ç”¨è‡ªé˜¿é‡Œäº‘<a target="_blank" rel="noopener" href="https://help.aliyun.com/knowledge_detail/56269.html">https://help.aliyun.com/knowledge_detail/56269.html</a></p>
</blockquote>
<h3 id="ä»€ä¹ˆæ˜¯æš´åŠ›ç ´è§£æ”»å‡»"><a href="#ä»€ä¹ˆæ˜¯æš´åŠ›ç ´è§£æ”»å‡»" class="headerlink" title="ä»€ä¹ˆæ˜¯æš´åŠ›ç ´è§£æ”»å‡»"></a>ä»€ä¹ˆæ˜¯æš´åŠ›ç ´è§£æ”»å‡»</h3><p>æš´åŠ›ç ´è§£æ”»å‡»æ˜¯æŒ‡æ”»å‡»è€…é€šè¿‡ç³»ç»Ÿåœ°ç»„åˆå¹¶å°è¯•æ‰€æœ‰çš„å¯èƒ½æ€§ä»¥ç ´è§£ç”¨æˆ·çš„ç”¨æˆ·åã€å¯†ç ç­‰æ•æ„Ÿä¿¡æ¯ã€‚æ”»å‡»è€…å¾€å¾€å€ŸåŠ©è‡ªåŠ¨åŒ–è„šæœ¬å·¥å…·æ¥å‘åŠ¨æš´åŠ›ç ´è§£æ”»å‡»ã€‚</p>
<h4 id="æ”»å‡»è¡Œä¸ºç±»å‹"><a href="#æ”»å‡»è¡Œä¸ºç±»å‹" class="headerlink" title="æ”»å‡»è¡Œä¸ºç±»å‹"></a>æ”»å‡»è¡Œä¸ºç±»å‹</h4><p>æ ¹æ®æš´åŠ›ç ´è§£çš„ç©·ä¸¾æ–¹å¼ï¼Œå…¶æ”»å‡»è¡Œä¸ºå¯ä»¥åˆ†ä¸ºï¼š</p>
<ul>
<li><strong>å­—å…¸æ”»å‡»æ³•</strong>ã€‚å¤§å¤šæ”»å‡»è€…å¹¶æ²¡æœ‰é«˜æ€§èƒ½çš„ç ´è§£ç®—æ³•å’ŒCPU/GPUï¼Œä¸ºèŠ‚çœæ—¶é—´å’Œæé«˜æ•ˆç‡ï¼Œä¼šåˆ©ç”¨ç¤¾ä¼šå·¥ç¨‹å­¦æˆ–å…¶å®ƒæ–¹å¼å»ºç«‹ç ´è¯‘å­—å…¸ï¼Œä½¿ç”¨å­—å…¸ä¸­å·²å­˜åœ¨çš„ç”¨æˆ·åã€å¯†ç è¿›è¡ŒçŒœç ´ã€‚</li>
<li><strong>ç©·ä¸¾æ³•</strong>ã€‚æ”»å‡»è€…é¦–å…ˆåˆ—å‡ºå¯†ç ç»„åˆçš„å¯èƒ½æ€§ï¼ˆå¦‚æ•°å­—ã€å¤§å†™å­—æ¯ã€å°å†™å­—æ¯ã€ç‰¹æ®Šå­—ç¬¦ç­‰ï¼‰ï¼Œç„¶åæŒ‰å¯†ç é•¿åº¦ä»1ä½ã€2ä½â€¦.æ„æˆä¸åŒçš„è´¦å·å’Œå¯†ç å¯¹ï¼Œç„¶åé€ä¸ªçŒœè¯•ã€‚è¯¥æ–¹æ³•éœ€è¦é«˜æ€§èƒ½çš„ç ´è§£ç®—æ³•å’ŒCPU/GPUä½œæ”¯æŒã€‚</li>
<li><strong>ç»„åˆå¼æ”»å‡»æ³•</strong>ã€‚ä½¿ç”¨å­—å…¸æ”»å‡»å’Œç©·ä¸¾æ³•çš„ç»„åˆæ”»å‡»æ–¹å¼ã€‚</li>
</ul>
<p>ç†è®ºä¸Šï¼Œåªè¦æ‹¥æœ‰æ€§èƒ½è¶³å¤Ÿå¼ºçš„è®¡ç®—æœºå’Œè¶³å¤Ÿé•¿çš„æ—¶é—´ï¼Œå¤§å¤šå¯†ç å‡å¯ä»¥è¢«ç ´è§£å‡ºæ¥ã€‚</p>
<h4 id="æ”»å‡»ä¸šåŠ¡ç±»å‹"><a href="#æ”»å‡»ä¸šåŠ¡ç±»å‹" class="headerlink" title="æ”»å‡»ä¸šåŠ¡ç±»å‹"></a>æ”»å‡»ä¸šåŠ¡ç±»å‹</h4><ul>
<li>é’ˆå¯¹Windowsæ“ä½œç³»ç»Ÿçš„è¿œç¨‹æ¡Œé¢ç®¡ç†åè®®ï¼ˆRDPï¼‰ã€Linuxæ“ä½œç³»ç»Ÿçš„ç®¡ç†åè®®ï¼ˆSSHï¼‰çš„æš´åŠ›ç ´è§£æ”»å‡»</li>
<li>é’ˆå¯¹å…·æœ‰ç™»å½•è®¤è¯æœºåˆ¶çš„è½¯ä»¶æœåŠ¡ï¼ˆå¦‚Mysqlã€SQLserverã€FTPã€Webå‰åç«¯ç™»å½•æ¥å£ç­‰åº”ç”¨æœåŠ¡ï¼‰çš„æš´åŠ›ç ´è§£æ”»å‡»</li>
</ul>
<p>å¯¹äºé˜²å¾¡è€…è€Œè¨€ï¼Œç»™æ”»å‡»è€…ç•™å¾—æ—¶é—´è¶Šé•¿ï¼Œå…¶ç»„åˆå‡ºæ­£ç¡®çš„ç”¨æˆ·åå’Œå¯†ç çš„å¯èƒ½æ€§å°±è¶Šå¤§ã€‚å› æ­¤ï¼Œæ—¶é—´åœ¨æ£€æµ‹æš´åŠ›ç ´è§£æ”»å‡»æ—¶å¾ˆé‡è¦ã€‚</p>
<h3 id="æš´åŠ›ç ´è§£æ”»å‡»æœ‰ä»€ä¹ˆå±å®³"><a href="#æš´åŠ›ç ´è§£æ”»å‡»æœ‰ä»€ä¹ˆå±å®³" class="headerlink" title="æš´åŠ›ç ´è§£æ”»å‡»æœ‰ä»€ä¹ˆå±å®³"></a>æš´åŠ›ç ´è§£æ”»å‡»æœ‰ä»€ä¹ˆå±å®³</h3><p>é€šè¿‡è‡ªåŠ¨åŒ–å·¥å…·å‘èµ·çš„æš´åŠ›ç ´è§£æ”»å‡»å¯ä»¥è·å–ç”¨æˆ·è´¦å·å’Œå¯†ç ã€‚</p>
<h3 id="å¦‚ä½•é˜²å¾¡æš´åŠ›ç ´è§£æ”»å‡»"><a href="#å¦‚ä½•é˜²å¾¡æš´åŠ›ç ´è§£æ”»å‡»" class="headerlink" title="å¦‚ä½•é˜²å¾¡æš´åŠ›ç ´è§£æ”»å‡»"></a>å¦‚ä½•é˜²å¾¡æš´åŠ›ç ´è§£æ”»å‡»</h3><ul>
<li>åˆ¶å®šå¯†ç å¤æ‚åº¦ç­–ç•¥ï¼Œå¹¶è¿›è¡ŒæœåŠ¡åŠ å›ºã€‚å¯†ç çš„é•¿åº¦è¦å¤§äº 8 ä½ï¼Œä¸”æœ€å¥½å¤§äº 20 ä½ï¼›å¯†ç åº”ç”±æ•°å­—ã€å¤§å°å†™å­—æ¯å’Œç‰¹æ®Šç¬¦å·æ··åˆç»„æˆï¼›å¯†ç çš„æœ€é•¿æœ‰æ•ˆæœŸä¸º 90 å¤©ã€‚</li>
<li>é…ç½®å¥½ç½‘ç»œè®¿é—®æ§åˆ¶ã€‚ä¸¥æ ¼é™åˆ¶å°†é«˜å±æœåŠ¡ç®¡ç†ç«¯å£ç›´æ¥å‘å¸ƒåˆ°äº’è”ç½‘ï¼›å»ºè®®æ‚¨ä½¿ç”¨ VPN å’Œå ¡å’æœºçš„æ–¹å¼é›†ä¸­ç®¡ç†å’Œå®¡è®¡ã€‚</li>
<li>æé«˜å†…éƒ¨å…¨å‘˜å®‰å…¨æ„è¯†ï¼Œç¦æ­¢å€Ÿç”¨æˆ–å…±äº«ä½¿ç”¨è´¦å·ã€‚</li>
</ul>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-Hans">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/Elasticsearch%E6%9C%8D%E5%8A%A1%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="GeekSRE">
      <meta itemprop="description" content="GeekSRE">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="GeekSRE">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/Elasticsearch%E6%9C%8D%E5%8A%A1%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA/" class="post-title-link" itemprop="url">ElasticsearchæœåŠ¡å®‰å…¨åŠ å›º</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2019-04-16 14:23:34 / Modified: 16:47:57" itemprop="dateCreated datePublished" datetime="2019-04-16T14:23:34+08:00">2019-04-16</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Elasticsearch/" itemprop="url" rel="index"><span itemprop="name">Elasticsearch</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <blockquote>
<p>å¼•ç”¨è‡ªé˜¿é‡Œäº‘<a target="_blank" rel="noopener" href="https://help.aliyun.com/knowledge_detail/49913.html">https://help.aliyun.com/knowledge_detail/49913.html</a>&gt;</p>
</blockquote>
<p>Elasticsearch æ˜¯ä¸€ä¸ªåŸºäº Lucene çš„æœç´¢æœåŠ¡ï¼Œå®ƒæä¾›äº† RESTful web æ¥å£çš„åˆ†å¸ƒå¼ã€å¤šç”¨æˆ·å…¨æ–‡æœç´¢å¼•æ“ ã€‚Elasticsearch æ˜¯ç”¨ Java å¼€å‘çš„ï¼Œå¹¶ä½œä¸º Apache è®¸å¯æ¡æ¬¾ä¸‹çš„å¼€æ”¾æºç å‘å¸ƒï¼Œæ˜¯ç¬¬äºŒå¤§æœ€æµè¡Œçš„ä¼ä¸šæœç´¢å¼•æ“ã€‚</p>
<p>Elasticsearch åº”ç”¨äºäº‘è®¡ç®—ä¸­ï¼Œå…·æœ‰å®æ—¶æœç´¢ã€ç¨³å®šã€å¯é ã€å¿«é€Ÿã€å®‰è£…ä½¿ç”¨æ–¹ä¾¿ç­‰ä¼˜åŠ¿ï¼›ä½†ä¹Ÿå­˜åœ¨ä¸€äº›å®‰å…¨éšæ‚£ï¼šé»˜è®¤å®‰è£…å®Œæˆåï¼ŒElasticsearch å¯ä»¥ä½¿ç”¨ 9200 ç«¯å£é€šå‘Š web çš„æ–¹å¼è®¿é—®æŸ¥çœ‹æ•°æ®ä¿¡æ¯ã€‚</p>
<h3 id="æ¼æ´è¯¦æƒ…"><a href="#æ¼æ´è¯¦æƒ…" class="headerlink" title="æ¼æ´è¯¦æƒ…"></a>æ¼æ´è¯¦æƒ…</h3><p>Elasticsearch ä¸­å­˜åœ¨ä»¥ä¸‹é«˜å±æ¼æ´ã€‚</p>
<table>
<thead>
<tr>
<th style="text-align:left">ç±»å‹</th>
<th style="text-align:left">CVE</th>
<th style="text-align:left">å—å½±å“ç‰ˆæœ¬</th>
<th style="text-align:left">æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:left">è¿œç¨‹å‘½ä»¤æ‰§è¡Œ</td>
<td style="text-align:left">CVE-2014-3120</td>
<td style="text-align:left">-</td>
<td style="text-align:left">Elasticsearch çš„è„šæœ¬æ‰§è¡Œ (scripting) åŠŸèƒ½ï¼Œå¯ä»¥å¾ˆæ–¹ä¾¿åœ°å¯¹æŸ¥è¯¢å‡ºæ¥çš„æ•°æ®è¿›è¡Œå†åŠ å·¥å¤„ç†ã€‚ä½†æ˜¯ï¼Œå…¶ä½¿ç”¨çš„ MVEL è„šæœ¬å¼•æ“æ²¡æœ‰åšè¿‡ä»»ä½•é˜²æŠ¤ï¼ˆæˆ–è€…æ²™ç›’åŒ…è£…ï¼‰ï¼Œå¯ä»¥ç›´æ¥æ‰§è¡Œä»»æ„ä»£ç ã€‚</td>
</tr>
<tr>
<td style="text-align:left">è¿œç¨‹ä»£ç æ‰§è¡Œ</td>
<td style="text-align:left">-</td>
<td style="text-align:left">1.3.0-1.3.7ï¼Œ1.4.0-1.4</td>
<td style="text-align:left">Elasticsearch ä½¿ç”¨ Groovy ä½œä¸ºè„šæœ¬è¯­è¨€ï¼Œè™½ç„¶åŠ å…¥äº†æ²™ç›’è¿›è¡Œæ§åˆ¶ï¼Œå±é™©çš„ä»£ç ä¼šè¢«æ‹¦æˆªã€‚ä½†æ˜¯ç”±äºæ²™ç›’é™åˆ¶ä¸ä¸¥æ ¼ï¼Œä»…é€šè¿‡é»‘ç™½åå•æ¥åˆ¤æ–­ï¼Œå¯¼è‡´æ”»å‡»è€…å¯ä»¥ç»•è¿‡æ²™ç›’ï¼Œæ‰§è¡Œè¿œç¨‹ä»£ç ã€‚</td>
</tr>
<tr>
<td style="text-align:left">æœªæˆæƒè®¿é—®</td>
<td style="text-align:left">-</td>
<td style="text-align:left">-</td>
<td style="text-align:left">Elasticsearch åœ¨å®‰è£…äº† River æœºåˆ¶ä¹‹åå¯ä»¥åŒæ­¥å¤šç§æ•°æ®åº“æ•°æ®ï¼ˆåŒ…æ‹¬å…³ç³»å‹çš„MySQLã€MongoDB ç­‰ï¼‰ã€‚å¦‚æœ <code>http://localhost:9200/cat/indices</code>ä¸­ <code>indices</code> åŒ…å«äº† <code>_river</code>ï¼Œåˆ™ä»£è¡¨ Elasticsearch å·²å®‰è£… River æœºåˆ¶ã€‚è€Œé€šè¿‡æ³„éœ²çš„ <code>http://localhost:9200/_rvier/_search</code> URL åœ°å€ï¼Œæ”»å‡»è€…å¯ä»¥è·å–åˆ°æ•æ„Ÿä¿¡æ¯ã€‚</td>
</tr>
</tbody>
</table>
<h3 id="æ¼æ´æˆå› ä¸å±å®³"><a href="#æ¼æ´æˆå› ä¸å±å®³" class="headerlink" title="æ¼æ´æˆå› ä¸å±å®³"></a>æ¼æ´æˆå› ä¸å±å®³</h3><p>ç”±äº Elasticsearch çš„ HTTP è¿æ¥æ²¡æœ‰æä¾›ä»»ä½•çš„æƒé™æ§åˆ¶æªæ–½ï¼Œä¸€æ—¦éƒ¨ç½²åœ¨å…¬å…±ç½‘ç»œå°±å®¹æ˜“æœ‰æ•°æ®æ³„éœ²çš„é£é™©ã€‚</p>
<h3 id="å®‰å…¨åŠ å›ºæ–¹æ¡ˆ"><a href="#å®‰å…¨åŠ å›ºæ–¹æ¡ˆ" class="headerlink" title="å®‰å…¨åŠ å›ºæ–¹æ¡ˆ"></a>å®‰å…¨åŠ å›ºæ–¹æ¡ˆ</h3><h4 id="ä½¿ç”¨æœ€æ–°çš„-Elasticsearch-ç‰ˆæœ¬"><a href="#ä½¿ç”¨æœ€æ–°çš„-Elasticsearch-ç‰ˆæœ¬" class="headerlink" title="ä½¿ç”¨æœ€æ–°çš„ Elasticsearch ç‰ˆæœ¬"></a>ä½¿ç”¨æœ€æ–°çš„ Elasticsearch ç‰ˆæœ¬</h4><p>é€šè¿‡æ­£è§„æ¸ é“ï¼ˆå¦‚ <a target="_blank" rel="noopener" href="https://www.elastic.co/downloads">Elastic å®˜ç½‘</a>ï¼‰ä¸‹è½½ Elasticsearch çš„æœ€æ–°ç‰ˆæœ¬ã€‚</p>
<ul>
<li>ä¸‹è½½å®Œæˆåï¼Œå°†ä¸‹è½½æ–‡ä»¶çš„ sha1 å€¼å’Œä¸‹è½½æ—¶å®˜ç½‘é¡µé¢æä¾›çš„ sha1 å€¼è¿›è¡Œå¯¹æ¯”ï¼Œé¿å…ä¸‹è½½è¿‡ç¨‹ä¸­è¢«æ¶æ„æ”»å‡»è€…æ‹¦æˆªç ´åæ–‡ä»¶ï¼Œç”šè‡³æ³¨å…¥æ¶æ„ä»£ç ã€‚</li>
<li>ä¸è¦éšä¾¿å®‰è£…ç¬¬ä¸‰æ–¹çš„æ’ä»¶ï¼Œæ’ä»¶æœ‰å¯èƒ½å¼•å…¥å®‰å…¨æ¼æ´ç”šè‡³æœ¬èº«è‡ªå¸¦åé—¨ï¼Œéœ€è°¨æ…ä½¿ç”¨ã€‚</li>
<li>å…³æ³¨ Elastic ç½‘ç«™ï¼ŒåŠæ—¶æ›´æ–° Elasticsearch è‡³æœ€æ–°ç‰ˆæœ¬ã€‚Elasticsearch æ¯æ¬¡ç‰ˆæœ¬å‘å¸ƒéƒ½ä¼šä¼˜åŒ–å’Œæ”¹è¿›ä¸€éƒ¨åˆ†åŠŸèƒ½ï¼Œå°¤å…¶æ˜¯å®‰å…¨æ¼æ´çš„è¡¥ä¸ã€‚åŒæ—¶ï¼Œä»”ç»†é˜…è¯» Elasticsearch çš„ç‰ˆæœ¬æ›´æ–°è®°å½•ã€‚</li>
</ul>
<p><strong>æ³¨æ„</strong>ï¼šæ›´æ–°å‡çº§å‰ï¼Œå»ºè®®æ‚¨å…ˆè¿›è¡Œå¿«ç…§å¤‡ä»½ï¼ŒåŠæœ¬åœ°æµ‹è¯•ã€‚</p>
<h4 id="ï¼ˆæ¨èï¼‰ç½‘ç»œè®¿é—®æ§åˆ¶"><a href="#ï¼ˆæ¨èï¼‰ç½‘ç»œè®¿é—®æ§åˆ¶" class="headerlink" title="ï¼ˆæ¨èï¼‰ç½‘ç»œè®¿é—®æ§åˆ¶"></a>ï¼ˆæ¨èï¼‰ç½‘ç»œè®¿é—®æ§åˆ¶</h4><p>Elasticsearch é»˜è®¤ç«¯å£æ˜¯ 9200ã€‚</p>
<ul>
<li>ä¸è¦æŠŠ Elasticsearch çš„ 9200 ç«¯å£æœåŠ¡å‘å¸ƒåˆ°äº’è”ç½‘ä¸Šã€‚</li>
<li>ä½¿ç”¨ <a target="_blank" rel="noopener" href="https://help.aliyun.com/document_detail/25475.html">é˜¿é‡Œäº‘å®‰å…¨ç»„é˜²ç«å¢™</a> æˆ–æœ¬åœ°æ“ä½œç³»ç»Ÿé˜²ç«å¢™å¯¹è®¿é—®æº IP è¿›è¡Œéš”ç¦»æ§åˆ¶ã€‚</li>
</ul>
<h4 id="ç»‘å®šè®¿é—®æº-IP"><a href="#ç»‘å®šè®¿é—®æº-IP" class="headerlink" title="ç»‘å®šè®¿é—®æº IP"></a>ç»‘å®šè®¿é—®æº IP</h4><p>è¿›å…¥ <code>config</code> ç›®å½•ï¼Œä¿®æ”¹ <code>elasticsearch.yml</code> é…ç½®æ–‡ä»¶ä¸­ä»¥ä¸‹å‚æ•°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">network.bind_host: 192.168.0.1</span><br><span class="line"># è®¾ç½®ç»‘å®šçš„ IP åœ°å€ï¼Œå¯ä»¥æ˜¯ IPv4 æˆ– IPv6 åœ°å€ï¼Œé»˜è®¤ä¸º 0.0.0.0ã€‚</span><br><span class="line">network.publish_host: 192.168.0.1</span><br><span class="line"># è®¾ç½®å…¶å®ƒèŠ‚ç‚¹å’Œè¯¥èŠ‚ç‚¹äº¤äº’çš„ IP åœ°å€ï¼Œå¦‚æœä¸è®¾ç½®å®ƒä¼šè‡ªåŠ¨åˆ¤æ–­ï¼Œå€¼å¿…é¡»æ˜¯ä¸ªçœŸå®çš„ IP åœ°å€ã€‚</span><br><span class="line">network.host: 192.168.0.1</span><br><span class="line"># åŒæ—¶è®¾ç½®ä¸Šè¿°ä¸¤ä¸ªå‚æ•°ï¼šbind_host å’Œ publish_hostã€‚</span><br></pre></td></tr></table></figure>
<h4 id="ä¿®æ”¹é»˜è®¤ç«¯å£"><a href="#ä¿®æ”¹é»˜è®¤ç«¯å£" class="headerlink" title="ä¿®æ”¹é»˜è®¤ç«¯å£"></a>ä¿®æ”¹é»˜è®¤ç«¯å£</h4><p>è¿›å…¥ <code>config</code> ç›®å½•ï¼Œä¿®æ”¹ <code>elasticsearch.yml</code> é…ç½®æ–‡ä»¶ä¸­ä»¥ä¸‹å‚æ•°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">ransport.tcp.port: 9300</span><br><span class="line"># è®¾ç½®èŠ‚ç‚¹é—´äº¤äº’çš„ TCP ç«¯å£ï¼Œé»˜è®¤æ˜¯ 9300ã€‚</span><br><span class="line">transport.tcp.compress: true</span><br><span class="line"># è®¾ç½®æ˜¯å¦å‹ç¼© TCP ä¼ è¾“æ—¶çš„æ•°æ®ï¼Œé»˜è®¤ä¸º falseï¼Œå³ä¸å‹ç¼©ã€‚</span><br><span class="line">http.port: 9200</span><br><span class="line"># è®¾ç½®å¯¹å¤–æœåŠ¡çš„ HTTP ç«¯å£ï¼Œé»˜è®¤ä¸º 9200ã€‚</span><br></pre></td></tr></table></figure>
<h4 id="å…³é—­-HTTP-è®¿é—®"><a href="#å…³é—­-HTTP-è®¿é—®" class="headerlink" title="å…³é—­ HTTP è®¿é—®"></a>å…³é—­ HTTP è®¿é—®</h4><p>è¿›å…¥ <code>config</code> ç›®å½•ï¼Œä¿®æ”¹ <code>elasticsearch.yml</code> é…ç½®æ–‡ä»¶ä¸­ä»¥ä¸‹å‚æ•°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">http.enabled: false</span><br><span class="line"># æ˜¯å¦ä½¿ç”¨ HTTP åè®®å¯¹å¤–æä¾›æœåŠ¡ï¼Œé»˜è®¤ä¸º trueï¼Œå³å¼€å¯ã€‚</span><br></pre></td></tr></table></figure>
<h4 id="ä½¿ç”¨-Shield-å®‰å…¨æ’ä»¶"><a href="#ä½¿ç”¨-Shield-å®‰å…¨æ’ä»¶" class="headerlink" title="ä½¿ç”¨ Shield å®‰å…¨æ’ä»¶"></a>ä½¿ç”¨ Shield å®‰å…¨æ’ä»¶</h4><p>Shield æ˜¯ Elastic å…¬å¸ä¸º Elasticsearch å¼€å‘çš„ä¸€ä¸ªå®‰å…¨æ’ä»¶ã€‚åœ¨å®‰è£…æ­¤æ’ä»¶åï¼ŒShield ä¼šæ‹¦æˆªæ‰€æœ‰å¯¹ Elasticsearch çš„è¯·æ±‚ï¼Œå¹¶è¿›è¡Œè®¤è¯ä¸åŠ å¯†ï¼Œä¿éšœ Elasticsearch åŠç›¸å…³ç³»ç»Ÿçš„å®‰å…¨æ€§ã€‚Shield æ˜¯å•†ä¸šæ’ä»¶ï¼Œéœ€è¦ Elasticsearch çš„å•†ä¸šè®¸å¯ã€‚ç¬¬ä¸€æ¬¡å®‰è£…è®¸å¯çš„æ—¶å€™ï¼Œä¼šæä¾› 30 å¤©çš„å…è´¹è¯•ç”¨æƒé™ã€‚30 å¤©åï¼ŒShield å°†ä¼šå±è”½ clusterhealth, cluster stats, index stats ç­‰ APIï¼Œå…¶ä½™åŠŸèƒ½ä¸å—å½±å“ã€‚</p>
<h5 id="ç”¨æˆ·è®¤è¯"><a href="#ç”¨æˆ·è®¤è¯" class="headerlink" title="ç”¨æˆ·è®¤è¯"></a>ç”¨æˆ·è®¤è¯</h5><p>ä½¿ç”¨ Shield å¯ä»¥å®šä¹‰ä¸€ç³»åˆ—å·²çŸ¥çš„ç”¨æˆ·ï¼Œå¹¶ç”¨å…¶è®¤è¯ç”¨æˆ·è¯·æ±‚ã€‚è¿™äº›ç”¨æˆ·å­˜åœ¨äºæŠ½è±¡çš„â€œåŸŸâ€ä¸­ã€‚ä¸€ä¸ªâ€œåŸŸâ€å¯ä»¥æ˜¯ä¸‹é¢å‡ ç§ç±»å‹ï¼š</p>
<ul>
<li>LDAP æœåŠ¡</li>
<li>ActiveDirectory æœåŠ¡</li>
<li>æœ¬åœ° <code>esusers</code> é…ç½®æ–‡ä»¶ï¼ˆç±»ä¼¼ <code>/etc/passwd</code>)</li>
</ul>
<h5 id="æƒé™æ§åˆ¶"><a href="#æƒé™æ§åˆ¶" class="headerlink" title="æƒé™æ§åˆ¶"></a>æƒé™æ§åˆ¶</h5><p>Shield çš„æƒé™æ§åˆ¶åŒ…å«ä¸‹é¢å‡ ç§å…ƒç´ ï¼š</p>
<ul>
<li>è¢«ä¿æŠ¤çš„èµ„æº <strong>SecuredResource</strong>ï¼šæƒé™æ‰€åº”ç”¨åˆ°çš„å¯¹è±¡ï¼Œæ¯”å¦‚æŸä¸ª indexï¼Œcluster ç­‰ã€‚</li>
<li>ç‰¹æƒ <strong>Priviliege</strong>ï¼šè§’è‰²å¯¹å¯¹è±¡å¯ä»¥æ‰§è¡Œçš„ä¸€ç§æˆ–å¤šç§æ“ä½œï¼Œæ¯”å¦‚ readï¼Œwrite ç­‰ã€‚è¿˜å¯ä»¥æ˜¯ <code>indicies:/data/read/perlocate</code> ç­‰å¯¹æŸç§å¯¹è±¡ç‰¹æœ‰çš„æ“ä½œã€‚</li>
<li>è®¸å¯ <strong>Permissions</strong>ï¼šå¯¹è¢«ä¿æŠ¤çš„èµ„æºæ‹¥æœ‰çš„ä¸€ä¸ªæˆ–å¤šä¸ªç‰¹æƒï¼Œå¦‚ <code>read on the&quot;products&quot; index</code>ã€‚</li>
<li>è§’è‰² <strong>Role</strong>ï¼šä¸€ç»„è®¸å¯çš„é›†æˆï¼Œå…·æœ‰ç‹¬ç«‹çš„åç§°ã€‚</li>
<li>ç”¨æˆ· <strong>Users</strong>ï¼šç”¨æˆ·å®ä½“ï¼Œå¯ä»¥è¢«èµ‹äºˆå¤šç§è§’è‰²ï¼Œä»–ä»¬å¯ä»¥å¯¹è¢«ä¿æŠ¤çš„èµ„æºæ‰§è¡Œç›¸åº”è§’è‰²æ‰€æ‹¥æœ‰çš„å„ç§ç‰¹æƒã€‚</li>
</ul>
<h5 id="å®‰è£…-Shield"><a href="#å®‰è£…-Shield" class="headerlink" title="å®‰è£… Shield"></a>å®‰è£… Shield</h5><p>æ‰§è¡Œå®‰è£…æ­¥éª¤å‰ï¼Œè¯·ç¡®ä¿æ»¡è¶³ä»¥ä¸‹å®‰è£…ç¯å¢ƒæ¡ä»¶ï¼š</p>
<ul>
<li>æ‚¨å®‰è£…äº† Java7 æˆ–æ›´æ–°ç‰ˆæœ¬ã€‚</li>
<li>æ‚¨å°† Elasticsearch 1.5.0+ è§£å‹å®‰è£…åˆ°äº†æœ¬æœºä¸Šã€‚å¦‚æœæ‚¨ä½¿ç”¨ APT æˆ– YUM å®‰è£…ï¼Œé»˜è®¤çš„å®‰è£…ç›®å½•å¯èƒ½åœ¨ <code>/usr/share/elasticsearch</code>ã€‚</li>
</ul>
<p>å‚ç…§ä»¥ä¸‹æ­¥éª¤å®Œæˆå®‰è£…ï¼š</p>
<ol>
<li><p>è¿›å…¥ Elasticsearch å®‰è£…ç›®å½•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd &#x2F;usr&#x2F;share&#x2F;elasticsearch</span><br></pre></td></tr></table></figure>
</li>
<li><p>å®‰è£… Elasticsearch è®¸å¯æ’ä»¶ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin&#x2F;plugin -i elasticsearch&#x2F;license&#x2F;latest</span><br></pre></td></tr></table></figure>
</li>
<li><p>å®‰è£… Shield æ’ä»¶ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin&#x2F;plugin -i elasticsearch&#x2F;shield&#x2F;latest</span><br></pre></td></tr></table></figure>
</li>
<li><p>å°† Shield é…ç½®æ–‡ä»¶ç§»åŠ¨æˆ–é“¾æ¥è‡³ <code>/etc/elasticsearch/shield</code> ç›®å½•ä¸­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ln -s &#x2F;usr&#x2F;share&#x2F;elasticsearch&#x2F;config&#x2F;shield &#x2F;etc&#x2F;elasticsearch&#x2F;shield</span><br></pre></td></tr></table></figure>
<p><strong>è¯´æ˜</strong>ï¼šElasticsearch æœåŠ¡åœ¨å¯åŠ¨æ—¶ä¼šåœ¨ <code>/etc/elasticsearch/shield</code> ç›®å½•ä¸‹å¯»æ‰¾ Shield é…ç½®æ–‡ä»¶ï¼Œè€Œè¿™äº›é…ç½®æ–‡ä»¶åœ¨å®‰è£… Shield æ—¶ä¼šå‡ºç°åœ¨ <code>/usr/share/elasticsearch/config/shield</code> ä¸­ï¼Œå› æ­¤éœ€è¦å°†é…ç½®æ–‡ä»¶ç§»åŠ¨æˆ–é“¾æ¥è‡³è¯¥ç›®å½•ã€‚</p>
</li>
<li><p>é‡å¯ Elasticsearch æœåŠ¡ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service elasticsearch restart</span><br></pre></td></tr></table></figure>
</li>
<li><p>æ–°å»ºä¸€ä¸ª Elasticsearch ç®¡ç†å‘˜è´¦æˆ·ï¼Œå¡«å†™æ–°å¯†ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">bin&#x2F;shield&#x2F;esusersuseradd es_admin -r admin</span><br></pre></td></tr></table></figure>
</li>
<li><p>ç›´æ¥ä½¿ç”¨ RESTFUL API è®¿é—® Elasticsearch çš„è¯·æ±‚éƒ½ä¼šè¢«æ‹’ç»ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -XGET&#39;http:&#x2F;&#x2F;localhost:9200&#x2F;&#39;</span><br></pre></td></tr></table></figure>
<p>éœ€è¦åœ¨è¯·æ±‚ä¸­æ·»åŠ ç”¨æˆ·åå’Œå¯†ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -u es_admin -XGET &#39;http:&#x2F;&#x2F;localhost:9200&#x2F;&#39;</span><br></pre></td></tr></table></figure>
</li>
</ol>
<p>æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è€ƒï¼š</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://www.elastic.co/downloads/shield">Shield å®˜æ–¹å®‰è£…æŒ‡å—</a></li>
<li><a target="_blank" rel="noopener" href="https://www.elastic.co/guide/en/shield/current/getting-started.html">Shield å®˜æ–¹ä½¿ç”¨é…ç½®æŒ‡å—</a></li>
</ul>
<h4 id="ä¿®æ”¹é»˜è®¤çš„-Elasticsearch-é›†ç¾¤åç§°"><a href="#ä¿®æ”¹é»˜è®¤çš„-Elasticsearch-é›†ç¾¤åç§°" class="headerlink" title="ä¿®æ”¹é»˜è®¤çš„ Elasticsearch é›†ç¾¤åç§°"></a>ä¿®æ”¹é»˜è®¤çš„ Elasticsearch é›†ç¾¤åç§°</h4><p>Elasticsearch é»˜è®¤çš„é›†ç¾¤åç§°æ˜¯ elasticsearchï¼Œè¯·åœ¨æ‚¨çš„ç”Ÿäº§ç¯å¢ƒä¸­å°†å…¶ä¿®æ”¹æˆå…¶ä»–åç§°ã€‚ç¡®ä¿åœ¨ä¸åŒçš„ç¯å¢ƒå’Œä¸åŒçš„é›†ç¾¤ä¸‹ä½¿ç”¨ä¸åŒçš„åç§°ï¼›å¹¶ä¸”åœ¨ç›‘æ§é›†ç¾¤èŠ‚ç‚¹æ—¶ï¼Œå¦‚æœæœ‰æœªçŸ¥èŠ‚ç‚¹åŠ å…¥ï¼Œä¸€å®šè¦åŠæ—¶é¢„è­¦ã€‚</p>
<h4 id="ä¸è¦ä»¥-root-èº«ä»½è¿è¡Œ-Elasticsearch"><a href="#ä¸è¦ä»¥-root-èº«ä»½è¿è¡Œ-Elasticsearch" class="headerlink" title="ä¸è¦ä»¥ root èº«ä»½è¿è¡Œ Elasticsearch"></a>ä¸è¦ä»¥ root èº«ä»½è¿è¡Œ Elasticsearch</h4><p>ä¸è¦ä»¥ root èº«ä»½æ¥è¿è¡Œ Elasticsearchï¼Œä¸è¦å’Œå…¶ä»–æœåŠ¡å…±ç”¨ç›¸åŒçš„ç”¨æˆ·ï¼Œå¹¶æŠŠç”¨æˆ·çš„æƒé™æœ€å°åŒ–ã€‚</p>
<p>åº”ç”¨ç¤ºä¾‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo -u es-user ES_JAVA_OPTS&#x3D;&quot;-Xms1024m -Xmx1024m&quot;&#x2F;opt&#x2F;elasticsearch&#x2F;bin&#x2F;elasticsearc</span><br></pre></td></tr></table></figure>
<h4 id="æ­£ç¡®è®¾ç½®-Elasticsearch-çš„æ•°æ®ç›®å½•"><a href="#æ­£ç¡®è®¾ç½®-Elasticsearch-çš„æ•°æ®ç›®å½•" class="headerlink" title="æ­£ç¡®è®¾ç½® Elasticsearch çš„æ•°æ®ç›®å½•"></a>æ­£ç¡®è®¾ç½® Elasticsearch çš„æ•°æ®ç›®å½•</h4><p>è¯·ç¡®ä¿ä¸º Elasticsearch çš„ç›®å½•åˆ†é…äº†åˆç†çš„è¯»å†™æƒé™ï¼Œé¿å…ä½¿ç”¨å…±äº«æ–‡ä»¶ç³»ç»Ÿã€‚ç¡®ä¿åªæœ‰ Elasticsearch çš„å¯åŠ¨ç”¨æˆ·æ‰æœ‰æƒè®¿é—®ç›®å½•ã€‚æ—¥å¿—ç›®å½•ä¹Ÿéœ€è¦æ­£ç¡®é…ç½®ï¼Œé¿å…æ³„éœ²æ•æ„Ÿä¿¡æ¯ã€‚</p>
<h4 id="å®šæœŸå¯¹-Elasticsearch-è¿›è¡Œå¤‡ä»½"><a href="#å®šæœŸå¯¹-Elasticsearch-è¿›è¡Œå¤‡ä»½" class="headerlink" title="å®šæœŸå¯¹ Elasticsearch è¿›è¡Œå¤‡ä»½"></a>å®šæœŸå¯¹ Elasticsearch è¿›è¡Œå¤‡ä»½</h4><p>ä½¿ç”¨ Elasticsearch æä¾›çš„å¤‡ä»½è¿˜åŸæœºåˆ¶ï¼Œå®šæœŸå¯¹ Elasticsearch çš„æ•°æ®è¿›è¡Œå¿«ç…§å¤‡ä»½ã€‚</p>
<h4 id="ç¦ç”¨æ‰¹é‡åˆ é™¤ç´¢å¼•"><a href="#ç¦ç”¨æ‰¹é‡åˆ é™¤ç´¢å¼•" class="headerlink" title="ç¦ç”¨æ‰¹é‡åˆ é™¤ç´¢å¼•"></a>ç¦ç”¨æ‰¹é‡åˆ é™¤ç´¢å¼•</h4><p>Elasticsearch æ”¯æŒä½¿ç”¨å…¨éƒ¨ï¼ˆ<code>_all</code>ï¼‰å’Œé€šé…ç¬¦ï¼ˆ<code>*</code>ï¼‰æ¥æ‰¹é‡åˆ é™¤ç´¢å¼•ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒï¼Œè¯¥æ“ä½œå­˜åœ¨ä¸€å®šé£é™©ï¼Œä½ å¯ä»¥é€šè¿‡è®¾ç½® <code>action.destructive_requires_name: true</code> å‚æ•°æ¥ç¦ç”¨å®ƒã€‚</p>
<h4 id="å¯ç”¨æ—¥å¿—è®°å½•åŠŸèƒ½"><a href="#å¯ç”¨æ—¥å¿—è®°å½•åŠŸèƒ½" class="headerlink" title="å¯ç”¨æ—¥å¿—è®°å½•åŠŸèƒ½"></a>å¯ç”¨æ—¥å¿—è®°å½•åŠŸèƒ½</h4><p>Elasticsearch çš„ <code>config</code> æ–‡ä»¶å¤¹é‡Œé¢æœ‰ä¸¤ä¸ªé…ç½®æ–‡ä»¶ï¼š</p>
<ul>
<li><code>elasticsearch.yml</code>ï¼šåŸºæœ¬é…ç½®æ–‡ä»¶ã€‚</li>
<li><code>logging.yml</code>ï¼šæ—¥å¿—é…ç½®æ–‡ä»¶ã€‚ç”±äº Elasticsearch ä½¿ç”¨ log4j æ¥è®°å½•æ—¥å¿—çš„ï¼Œ<code>logging.yml</code> ä¸­çš„è®¾ç½®è¯·æŒ‰æ™®é€š log4j é…ç½®æ–‡ä»¶è¿›è¡Œè®¾ç½®ã€‚</li>
</ul>
<p>å¯ç”¨æ—¥å¿—åŠŸèƒ½éœ€è¦ä¿®æ”¹ <code>elasticsearch.yml</code> é…ç½®æ–‡ä»¶ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">path.logs: &#x2F;path&#x2F;to&#x2F;logs# è®¾ç½®æ—¥å¿—æ–‡ä»¶çš„å­˜å‚¨è·¯å¾„ï¼Œé»˜è®¤æ˜¯ Elasticsearch æ ¹ç›®å½•ä¸‹çš„ logs æ–‡ä»¶å¤¹</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">GeekSRE</p>
  <div class="site-description" itemprop="description">GeekSRE</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">68</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">14</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">21</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">GeekSRE</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  




  
<script src="/js/local-search.js"></script>













  

  

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"debug":false,"model":{"jsonPath":"/live2dw/assets/assets/haruto.model.json"},"display":{"position":"right","width":150,"height":300},"mobile":{"show":true},"log":false});</script></body>
</html>
