<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[test]]></title>
    <url>%2F2019%2F05%2F08%2Ftest%2F</url>
    <content type="text"></content>
  </entry>
  <entry>
    <title><![CDATA[Kubernetes-Secrets]]></title>
    <url>%2F2019%2F05%2F05%2FKubernetes-Secrets%2F</url>
    <content type="text"><![CDATA[ËÉåÊôØ‰ø°ÊÅØËã•ÊÇ®ÈúÄË¶ÅÂú® Kubernetes ÈõÜÁæ§‰∏≠‰ΩøÁî®‰∏Ä‰∫õÊïèÊÑüÁöÑÈÖçÁΩÆÔºåÊØîÂ¶ÇÂØÜÁ†Å„ÄÅËØÅ‰π¶Á≠â‰ø°ÊÅØÊó∂ÔºåÂª∫ËÆÆ‰ΩøÁî®ÂØÜÈí•ÔºàsecretÔºâÔºåÂç≥‰øùÂØÜÂ≠óÂÖ∏„ÄÇ ÂØÜÈí•ÊúâÂ§öÁßçÁ±ªÂûãÔºå‰æãÂ¶ÇÔºö Service AccountÔºöÁî®Êù•ËÆøÈóÆ Kubernetes APIÔºåÁî± Kubernetes Ëá™Âä®ÂàõÂª∫ÔºåÂπ∂‰∏î‰ºöËá™Âä®ÊåÇËΩΩÂà∞ Pod ÁöÑ/run/secrets/kubernetes.io/serviceaccountÁõÆÂΩï‰∏≠„ÄÇ OpaqueÔºöbase64 ÁºñÁ†ÅÊ†ºÂºèÁöÑ SecretÔºåÁî®Êù•Â≠òÂÇ®ÂØÜÁ†Å„ÄÅËØÅ‰π¶Á≠âÊïèÊÑü‰ø°ÊÅØ„ÄÇ Opaque Á±ªÂûãÁöÑÊï∞ÊçÆÊòØ‰∏Ä‰∏™ map Á±ªÂûãÔºåË¶ÅÊ±Çvalue ÊòØ base64 ÁºñÁ†ÅÊ†ºÂºè ÊÇ®‰πüÂèØÈÄöËøáÂëΩ‰ª§Ë°åÊâãÂä®ÂàõÂª∫ÂØÜÈí•ÔºåËØ∑ÂèÇËßÅ kubernetes secret ‰∫ÜËß£Êõ¥Â§ö‰ø°ÊÅØ„ÄÇ ÂëΩ‰ª§ÂàõÂª∫1234567891011kubectl create secretCreate a secret using specified subcommand.Available Commands: docker-registry Create a secret for use with a Docker registry generic Create a secret from a local file, directory or literal value tls Create a TLS secretUsage: kubectl create secret [flags] [options] Êü•ÁúãËØÅ‰π¶12345[cicd-jd@ops-jenkins-master ssl]$ kubectl get secretsNAME TYPE DATA AGEdefault-token-msfm9 kubernetes.io/service-account-token 3 24dregistry.cn-beijing.aliyuncs.com kubernetes.io/dockerconfigjson 1 24dveer-https kubernetes.io/tls 2 3h25m 123456789101112[cicd-jd@ops-jenkins-master ssl]$ kubectl describe secrets veer-httpsName: veer-httpsNamespace: defaultLabels: &lt;none&gt;Annotations: &lt;none&gt;Type: kubernetes.io/tlsData====tls.crt: 3941 bytestls.key: 1676 bytes Âà†Èô§1kubectl delete secret $NAME Á§∫‰æãÂàõÂª∫SSLËØÅ‰π¶ ÂáÜÂ§áÂÖ¨Èí•„ÄÅÁßÅÈí•Êñá‰ª∂12[cicd-jd@ops-jenkins-master ssl]$ lsveer.key veer.pem ÂàõÂª∫secret1kubectl create secret tls veer-https --cert=./veer.pem --key=./veer.key È™åËØÅ123[cicd-jd@ops-jenkins-master ssl]$ kubectl get secrets veer-httpsNAME TYPE DATA AGEveer-https kubernetes.io/tls 2 3h22m]]></content>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nginx-ingress controllerÈÉ®ÁΩ≤]]></title>
    <url>%2F2019%2F05%2F05%2FNginx-ingress-controller%E9%83%A8%E7%BD%B2%2F</url>
    <content type="text"><![CDATA[https://docs.jdcloud.com/cn/jcs-for-kubernetes/deploy-ingress-nginx-controller Ingress ÊòØ‰ªéKubernetesÈõÜÁæ§Â§ñÈÉ®ËÆøÈóÆÈõÜÁæ§ÂÜÖÈÉ®ÊúçÂä°ÁöÑÂÖ•Âè£ÔºåÊ¶ÇÂøµÁ§∫ÊÑèÂèØÂèÇËÄÉ‰∏ãÊñπËØ¥Êòé„ÄÇ‰Ω†ÂèØ‰ª•ÁªôIngressÈÖçÁΩÆÊèê‰æõÂ§ñÈÉ®ÂèØËÆøÈóÆÁöÑURL„ÄÅË¥üËΩΩÂùáË°°„ÄÅSSL„ÄÅÂü∫‰∫éÂêçÁß∞ÁöÑËôöÊãü‰∏ªÊú∫Á≠â„ÄÇÁî®Êà∑ÈÄöËøáPOST IngressËµÑÊ∫êÂà∞API serverÁöÑÊñπÂºèÊù•ËØ∑Ê±Çingress„ÄÇ 12345internet |[ Ingress ]--|-----|--[ Services ] Ingress controllerË¥üË¥£ÂÆûÁé∞Ingress„ÄÇIngress controllerÂú®KubernetesÈõÜÁæ§‰∏≠ÈªòËÆ§‰∏ç‰ºöËá™Âä®ÂêØÁî®ÔºåÊÇ®ÂèØ‰ª•Âú®‰∏Ä‰∏™pod‰∏≠ÈÉ®ÁΩ≤‰ªªÊÑèÁ±ªÂûãÁöÑËá™ÂÆö‰πâIngress Controller„ÄÇÊú¨ÊñáÂ∞Ü‰ª•Nginx-ingress controller‰∏∫‰æãÔºåËØ¥ÊòéControllerÈÉ®ÁΩ≤ÂíåIngressÂÆö‰πâ„ÄÇÊõ¥Â§öÂ§ñÈÉ®Á±ªÂûãÁöÑIngresss ControllerÂèÇËÄÉKubernetesÂÆòÊñπÊñáÊ°£„ÄÇ ÁéØÂ¢ÉÂáÜÂ§á ‰ªégithub‰∏ãËΩΩnginx-ingress controllerÊúÄÊñ∞ÁöÑÂÆâË£ÖÈÉ®ÁΩ≤Êñá‰ª∂,Âπ∂Â∞ÜÈÉ®ÁΩ≤Êñá‰ª∂Ëß£ÂéãÁº©Âà∞Êú¨Âú∞ÁõÆÂΩïÔºö123wget https://github.com/nginxinc/kubernetes-ingress/archive/v1.4.5.tar.gztar -zxvf v1.4.5.tar.gz ËØ¥ÊòéÔºöÊú¨ÊñáËØ¥ÊòéÂú®1.12.3ÁâàÊú¨ÁöÑÈõÜÁæ§‰∏äÂ¶Ç‰ΩïÈÉ®ÁΩ≤nginx-ingress controllerÔºåÂ¶ÇÈõÜÁæ§ÁâàÊú¨‰∏çÂêåÔºåÈÄâÊã©ÂÖ∂‰ªñÈÄÇÂêàÁöÑginx-ingress controllerÂÆâË£ÖÈÉ®ÁΩ≤Êñá‰ª∂„ÄÇ ËøõÂÖ•Ëß£ÂéãÁº©ÂêéÁöÑnginx-ingress controllerÂÆâË£ÖÁõÆÂΩïÔºõ1cd kubernetes-ingress-1.4.5/deployments ÂÆâË£Önginx-ingress controller ‰∏∫nginx-ingress controllerÂàõÂª∫‰∏Ä‰∏™namespaceÂíåservice accountÔºö1kubectl apply -f common/ns-and-sa.yaml ‰∏∫NGINXÈªòËÆ§ServerÈÖçÁΩÆTLSËØÅ‰π¶ÂíåkeyÔºåÂπ∂Â∞ÜTLSËØÅ‰π¶Âíåkey‰øùÂ≠òÂà∞secret‰∏≠Ôºö1kubectl apply -f common/default-server-secret.yaml ËØ¥ÊòéÔºöÂª∫ËÆÆ‰ΩøÁî®ÂêàÈÄÇÁöÑTLSËØÅ‰π¶ÂíåkeyÊõøÊç¢default-server-secret.yamlÊñá‰ª∂‰∏≠Ëá™Á≠æÂèëÁöÑËØÅ‰π¶Âíåkey„ÄÇ ÂàõÂª∫config map‰øùÂ≠òNGINXÁöÑËá™ÂÆö‰πâÈÖçÁΩÆÔºö1kubectl apply -f common/nginx-config.yaml ËØ¥ÊòéÔºöÁõÆÂâçÊèê‰æõÁöÑconfig map‰∏≠ÁöÑdata‰∏∫Á©∫ÔºåÊÇ®ÂèØ‰ª•ÊåâÈúÄÊ∑ªÂä†Ëá™ÂÆö‰πâÈÖçÁΩÆ„ÄÇ ‰∏∫Á¨¨1Ê≠•‰∏≠ÂàõÂª∫ÁöÑservice accountÈÖçÁΩÆRBACÔºö1kubectl apply -f rbac/rbac.yaml ‰ª•DeploymentÁöÑÊñπÂºèÈÉ®ÁΩ≤nginx-ingress controller:1kubectl apply -f deployment/nginx-ingress.yaml ÊâßË°åÂ¶Ç‰∏ãÂëΩ‰ª§ÔºåÁ°ÆÂÆöÈÉ®ÁΩ≤nginx-ingress controllerÁöÑDeploymentËøêË°åÊ≠£Â∏∏Ôºö1234 kubectl get deployment -n nginx-ingress NAME DESIRED CURRENT UP-TO-DATE AVAILABLE AGE nginx-ingress 1 1 1 1 24d ÂàõÂª∫ingressÁöÑLoadBalanceÂú® KubernetesÈõÜÁæ§‰∏≠ÔºåÊØè‰∏™PodÈÉΩÂÖ∑ÊúâÂîØ‰∏ÄÁöÑÂÜÖÈÉ® IP Âú∞ÂùÄÔºå‰ΩÜÊòØDeployment‰∏≠ÁöÑPodÈöèÊó∂ÂèØËÉΩË¢´Âà†Èô§ÊàñÂàõÂª∫ÔºåÂØºËá¥Pod IPÂú∞ÂùÄ‰∏çÊñ≠ÂèòÂåñ„ÄÇÂõ†Ê≠§ÈúÄË¶ÅÂàõÂª∫‰∏Ä‰∏™ServiceÂØπÂ§ñÊö¥Èú≤Pod‰∏≠ÁöÑÂ∫îÁî®„ÄÇServiceÂÖ∑ÊúâÂîØ‰∏ÄÁöÑÂõ∫ÂÆöIPÂú∞ÂùÄ‰∏îËÉΩÂ§ü‰∏∫ÂêéÁ´ØÊ∑ªÂä†ÁöÑÊàêÂëòPodÊèê‰æõË¥üËΩΩÂùáË°°„ÄÇÂú®‰∫¨‰∏ú‰∫ëKubernetesÈõÜÁæ§‰∏≠ÊÇ®ÂèØ‰ª•‰ΩøÁî®LoadBalanceÁ±ªÂûãÁöÑServiceÔºå‰∏∫ServiceÂÖ≥ËÅîÂàõÂª∫‰∏Ä‰∏™Â∫îÁî®Ë¥üËΩΩÂùáË°°ÔºåÂπ∂ÈÄöËøáË¥üËΩΩÂùáË°°ÁªëÂÆöÁöÑÂÖ¨ÁΩëIPÔºåÂ∞ÜServiceÂêéÁ´ØÂÖ≥ËÅîÁöÑnginx-ingress controllerÂ∫îÁî®Êö¥Èú≤Âà∞ÂÖ¨ÁΩëÔºö 123456789101112131415161718apiVersion: v1kind: Servicemetadata: name: nginx-ingress #Âª∫ËÆÆService‰ΩøÁî®‰∏énginx-ingress controllerÂØπÂ∫îÁöÑDeploymentÂêçÁß∞Áõ∏ÂêåÁöÑÂêçÁß∞ namespace: nginx-ingressspec: type: LoadBalancer ports: - port: 80 targetPort: 80 protocol: TCP name: http - port: 443 targetPort: 443 protocol: TCP name: https selector: app: nginx-ingress ËØ¥ÊòéÔºöÊú¨‰æã‰ΩøÁî®80Âíå443Á´ØÂè£ÁªëÂÆönginx-ingress controllerÂ∫îÁî® Â∞Ü‰∏äËø∞ServiceÂÆö‰πâÂà∞ingress.yamlÊñá‰ª∂ÔºåÊâßË°åÂ¶Ç‰∏ãÂëΩ‰ª§ÂàõÂª∫ÂØπÂ∫îÁöÑServiceÔºö 1kubectl create -f ingress.yaml Ëé∑ÂèñÂÖ¨ÁΩëIPÁ≠âÂæÖ‰∏ÄÊÆµÊó∂Èó¥ÔºåÁ°ÆÂÆöServiceÂ∑≤ÁªèÈÖçÁΩÆÂÆåÊàêÔºåÂπ∂Ëé∑ÂèñService‰∏äÈÖçÁΩÆÁöÑExternal IPÂ≠óÊÆµ 1234kubectl get svc -n nginx-ingressNAME TYPE CLUSTER-IP EXTERNAL-IP PORT(S) AGEnginx-ingress LoadBalancer 192.168.58.218 114.67.80.218 80:32436/TCP,443:30110/TCP 3h13m ËØ¥ÊòéÔºöServiceÁöÑExternal IPÂ∞Ü‰Ωú‰∏∫nginx-ingress controllerÁöÑVIPÔºå‰∏∫ÈõÜÁæ§‰∏≠‰ΩøÁî®nginx-ingress controllerÁöÑIngressÊèê‰æõÂÖ¨ÁΩëËÆøÈóÆÂÖ•Âè£ ÂÖ≥ËÅîÁöÑExternal IP‰Ωú‰∏∫ÂÖ¨ÁΩëÂÖ•Âè£IPÊúÄÂêéÔºåÂú®Ingress controllerÁöÑDeploymentÈÉ®ÁΩ≤Êñá‰ª∂nginx-ingress.yaml‰∏≠Â¢ûÂä†‰∏ÄÂØπÁéØÂ¢ÉÂèòÈáè‚Äù-args -external-service=nginx-ingress‚Äù,ÈÖçÁΩÆIngress controller‰ΩøÁî®ServiceÂêçÁß∞ÂÖ≥ËÅîÁöÑExternal IP‰Ωú‰∏∫ÂÖ¨ÁΩëÂÖ•Âè£IPÔºö 1234args: - -nginx-configmaps=$(POD_NAMESPACE)/nginx-config - -default-server-tls-secret=$(POD_NAMESPACE)/default-server-secret - -external-service=nginx-ingress #Êñ∞Â¢ûÂÜÖÂÆπ 1kubectl apply -f deployment/nginx-ingress.yaml #ÈáçÊñ∞ÈÉ®ÁΩ≤nginx-ingress controller È™åËØÅPodÊâßË°åÂ¶Ç‰∏ãÂëΩ‰ª§Á°ÆÂÆönginx-ingress controllerÁõ∏ÂÖ≥ÁöÑPodËøêË°åÊ≠£Â∏∏ÔºåÂç≥ÂèØÂÆåÊàênginx ingress controllerÈÉ®ÁΩ≤Ôºö 12345kubectl get pod -n nginx-ingressNAME READY STATUS RESTARTS AGEnginx-ingress-f67b87b88-5cspd 1/1 Running 0 3h11mnginx-ingress-f67b87b88-n7qnw 1/1 Running 0 3h13m Á§∫‰æãÂ∫îÁî®‰æãÂ¶ÇÔºöÈÖçÁΩÆwww2.veer.comÁöÑingressÈÖçÁΩÆ 123456789101112131415161718apiVersion: extensions/v1beta1kind: Ingressmetadata: name: cms-veer # ÂèòÈáèÔºöÂêçÂ≠ó namespace: defaultspec: rules: - host: www2.veer.com # ÂèòÈáèÔºöurl http: paths: - backend: serviceName: node-vcg-veer-pre # ÂèòÈáèÔºöÂêéÁ´ØÂ∫îÁî®service servicePort: 80 # ÂèòÈáèÔºöÂêéÁ´ØÂ∫îÁî®serviceÁ´ØÂè£ path: / tls: - hosts: - www2.veer.com secretName: veer-https # ÂèòÈáèÔºösslËØÅ‰π¶]]></content>
      <categories>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Kubernetes</tag>
        <tag>Ingress</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ConfluenceÂÆâË£Ö-Áª¥Êä§-ËøÅÁßªÂÆûË∑µ]]></title>
    <url>%2F2019%2F04%2F29%2FConfluence%E5%AE%89%E8%A3%85-%E7%BB%B4%E6%8A%A4-%E8%BF%81%E7%A7%BB%E5%AE%9E%E8%B7%B5%2F</url>
    <content type="text"><![CDATA[Confluence‰ªãÁªç ConfluenceÊòØÁî±Êæ≥Â§ßÂà©‰∫öËΩØ‰ª∂ÂÖ¨Âè∏AtlassianÂºÄÂèëÂíåÂèëÂ∏ÉÁöÑÂçè‰ΩúËΩØ‰ª∂Á®ãÂ∫è ConfluenceÊòØ‰∏Ä‰∏™‰∏ì‰∏öÁöÑ‰ºÅ‰∏öÁü•ËØÜÁÆ°ÁêÜ‰∏éÂçèÂêåËΩØ‰ª∂Ôºå‰πüÂèØ‰ª•Áî®‰∫éÊûÑÂª∫‰ºÅ‰∏öwiki„ÄÇ‰ΩøÁî®ÁÆÄÂçïÔºå‰ΩÜÂÆÉÂº∫Â§ßÁöÑÁºñËæëÂíåÁ´ôÁÇπÁÆ°ÁêÜÁâπÂæÅËÉΩÂ§üÂ∏ÆÂä©Âõ¢ÈòüÊàêÂëò‰πãÈó¥ÂÖ±‰∫´‰ø°ÊÅØ„ÄÅÊñáÊ°£Âçè‰Ωú„ÄÅÈõÜ‰ΩìËÆ®ËÆ∫Ôºå‰ø°ÊÅØÊé®ÈÄÅ„ÄÇ Confluence‰∏∫Âõ¢ÈòüÊèê‰æõ‰∏Ä‰∏™Âçè‰ΩúÁéØÂ¢É„ÄÇÂú®ËøôÈáåÔºåÂõ¢ÈòüÊàêÂëòÈΩêÂøÉÂçèÂäõÔºåÂêÑÊìÖÂÖ∂ËÉΩÔºåÂçèÂêåÂú∞ÁºñÂÜôÊñáÊ°£ÂíåÁÆ°ÁêÜÈ°πÁõÆ„ÄÇ‰ªéÊ≠§ÊâìÁ†¥‰∏çÂêåÂõ¢Èòü„ÄÅ‰∏çÂêåÈÉ®Èó®‰ª•Âèä‰∏™‰∫∫‰πãÈó¥‰ø°ÊÅØÂ≠§Â≤õÁöÑÂÉµÂ±ÄÔºåConfluenceÁúüÊ≠£ÂÆûÁé∞‰∫ÜÁªÑÁªáËµÑÊ∫êÂÖ±‰∫´„ÄÇ ÂÆâË£Ö https://confluence.atlassian.com/conf612/installing-confluence-on-linux-from-archive-file-958778538.html ‰∏ãËΩΩÂÆâË£ÖÂåÖDownload the tar.gz file for your operating system - https://www.atlassian.com/software/confluence/download. Êú¨Ê¨°ÊºîÁ§∫Êàë‰∏ãËΩΩÁöÑÊñá‰ª∂ÂåÖ‰∏∫Ôºöatlassian-confluence-6.12.0.zip ÂÆâË£ÖjdkÁéØÂ¢É12yum install -y java-1.8.0-openjdk.x86_64java -version # È™åËØÅ ÂàõÂª∫ConfluenceÁî®Êà∑1useradd -create-home --comment "Account for running Confluence" --shell /bin/bash confluence Ëß£ÂéãÂÆâË£ÖÂåÖ„ÄÅÂàõÂª∫ÈÖçÁΩÆ„ÄÅÈÖçÁΩÆÊùÉÈôêÁõÆÂΩïËßÑÂàíÔºö ‚Äã ÂÆâË£ÖÁõÆÂΩïÔºö/data/vcg/confluence ‚Äã Êï∞ÊçÆÁõÆÂΩïÔºö/data/vcg/confluence-home 1cp /root/atlassian-confluence-6.12.0.zip /data/vcg/ 1yum install unzip -y 123cd /data/vcg/unzip atlassian-confluence-6.12.0.zipmv atlassian-confluence-6.12.0 confluence 1mkdir -p /data/vcg/confluence-home 1234chown -R confluence /data/vcg/confluence/chmod -R u=rwx,go-rwx /data/vcg/confluence/chown -R confluence /data/vcg/confluence-home/chmod -R u=rwx,go-rwx /data/vcg/confluence-home/ Êï∞ÊçÆÂ∫ìvcgËøôËæπ‰ΩøÁî®ÁöÑÈòøÈáå‰∫ëRDSÊï∞ÊçÆÂ∫ìÔºåÊú™ÊâãÂä®ÂÆâË£ÖMySQL Êï∞ÊçÆÂ∫ì‰ΩøÁî®MySQLÔºåÈúÄÂÆâË£ÖÈ©±Âä®ËΩØ‰ª∂„ÄÇËé∑Âèñmysql-connector-javaÁöÑÂÆâË£ÖÂåÖ 1cp mysql-connector-java-5.1.45-bin.jar /data/vcg/confluence/confluence/WEB-INF/lib/ ÈÖçÁΩÆ1echo "confluence.home=/data/vcg/confluence-home/" &gt; confluence/confluence/WEB-INF/classes/confluence-init.properties 12 È°µÈù¢ÈÖçÁΩÆ1ÊµèËßàÂô®ËÆøÈóÆip:8090 ÁªßÁª≠ÈÖçÁΩÆConfluence ËøÅÁßªÂ§á‰ªΩÊï∞ÊçÆÁôªÂΩïËÄÅConfluenceÁïåÈù¢ÔºåËøõÂÖ•‚ÄùÁ´ôÁÇπÁÆ°ÁêÜ‚Äù‚Äî‚ÄúÂ§á‰ªΩÂ∑≤ËøòÂéü‚ÄùÔºåÁÇπÂáª‚ÄùÂ§á‰ªΩ‚ÄùÔºåÂ¶ÇÂõæ Êï∞ÊçÆÂ§á‰ªΩË∑ØÂæÑ‰∏∫Ôºö/data/vcg/confluence-home/backups/ Êã∑Ë¥ùÂ§á‰ªΩÊï∞ÊçÆÂåÖÂà∞Êñ∞ÊúçÂä°Âô®Â§á‰ªΩÂøÖÈ°ªÂ§çÂà∂Ëá≥/data/vcg/confluence-home/restoreÁõÆÂΩï‰∏≠„ÄÇ 1scp /data/vcg/confluence-home/backups/xmlexport-20190225-205713-119.zip root@'xxxx':/data/vcg/confluence-home/restore/ ÈÉ®ÁΩ≤Êñ∞ÁöÑConfluenceÂ§á‰ªΩÊÅ¢Â§çÁôªÂΩïÊñ∞ÁöÑConfluenceÁöÑ‚ÄùÁ´ôÁÇπÁÆ°ÁêÜ‚Äù‚Äî‚ÄúÂ§á‰ªΩÂ∑≤ËøòÂéü‚Äù„ÄÇ Áª¥Êä§Â§á‰ªΩÊï∞ÊçÆÂÆöÊúüÂà†Èô§12crontab -e0 15 * * * find /data/vcg/confluence-home/backups/* -type f -mtime +5 -exec rm &#123;&#125; \; ÊºèÊ¥ûË°•‰∏Å(Ë¢´Ê§çÂÖ•ÊåñÁüøÁ®ãÂ∫è) https://help.aliyun.com/noticelist/articleid/1000128459.html?spm=a2c4g.789213612.n2.10.2a716141mqqJjY Ëß£ÂÜ≥ÂäûÊ≥ïÔºöÂçáÁ∫ßWidget Connector ÁªÑ‰ª∂ ÂüπËÆ≠ÊñáÊ°£]]></content>
      <tags>
        <tag>Confluence</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ËÆ∞‰∏ÄÊ¨°JavaÂæÆÊúçÂä°ÂÆπÂô®ÂåñÁª¥Êä§Â∑•‰Ωú]]></title>
    <url>%2F2019%2F04%2F28%2F%E8%AE%B0%E4%B8%80%E6%AC%A1Java%E5%BE%AE%E6%9C%8D%E5%8A%A1%E5%AE%B9%E5%99%A8%E5%8C%96%E7%BB%B4%E6%8A%A4%E5%B7%A5%E4%BD%9C%2F</url>
    <content type="text"><![CDATA[‰∫ã‰ª∂ËÉåÊôØ ÂÆπÂô®Êû∂ÊûÑÁî±SwarmËøÅÁßªÂà∞Kubernetes SwarmÈõÜÁæ§‰∏≠ÊúçÂä°ÂèëÁé∞„ÄÅÊúçÂä°Ê≥®ÂÜå‰ΩøÁî®ConsulÔºåËøÅÁßªÂà∞K8sÂêéÊ≥®ÂÜåÂèëÁé∞ÊòØÁöÑK8sÁöÑkube-dnsÂü∫Á°ÄÁªÑ‰ª∂ÂÆûÁé∞„ÄÇ utilservice-vcg-comËøô‰∏™ÂæÆÊúçÂä°ÈÉ®ÁΩ≤Âú®‰∏§Âè∞ecs‰∏äÔºåjava -jar ÂêØÂä®Âêé ÊâãÂä®Ê≥®ÂÜåÂà∞consul‰∏≠ÔºåËøôÊ†∑ÂÆûÁé∞SwarmÈõÜÁæ§‰∏≠ÁöÑÂ∫îÁî®ÂèØ‰ª•ÈÄöËøáConsulËÆøÈóÆutilÊúçÂä°„ÄÇ ÊÄùË∑Ø ‰∏éÁõ∏ÂÖ≥Á†îÂèëÊ≤üÈÄöÔºåÁ°ÆÂÆöutilserviceÁ®ãÂ∫è‰∏Ä‰∫õÂü∫Á°Ä‰ø°ÊÅØÔºöÊØîÂ¶Ç ‚Äã ÈúÄË¶ÅÂì™‰∫õÂü∫Á°ÄÁªÑ‰ª∂ÔºåÂú®ecs‰∏äÈÉ®ÁΩ≤ÈÅáÂà∞‰ªÄ‰πàÈóÆÈ¢òÔºåÂ¶Ç‰ΩïÂ§ÑÁêÜÁöÑ ‚Äã git‰ªìÂ∫ìÂú∞ÂùÄ„ÄÅÊúçÂä°ÂêØÂä®ÂëΩ‰ª§„ÄÅÊúçÂä°Á´ØÂè£„ÄÅÊòØÂê¶ËøûÊé•Êï∞ÊçÆÂ∫ì„ÄÅÊúçÂä°Ë∞ÉÁî®ÂÖ≥Á≥ª„ÄÇ Á°ÆÂÆö‰ΩøÁî®jdkÁéØÂ¢ÉÔºåÈúÄË¶Å‰ΩøÁî®Âà∞ wkhtmltopdf Ëøô‰∏™ÂëΩ‰ª§ÔºåÁî®‰∫éÁîüÊàêpdfÔºõ ÁîüÊàêÁöÑpdfËøáÁ®ã‰ºöÊúâ Â≠ó‰ΩìÂíåËØ≠Ë®ÄÁöÑÈóÆÈ¢òÔºåÈúÄÊèêÂâçÂ§ÑÁêÜ„ÄÇ Êìç‰Ωú Á°ÆÂÆöÂü∫Á°ÄÈïúÂÉèËÆøÈóÆhttps://hub.docker.comÔºåÊêúÁ¥¢ wkhtmltopdf ÂÖ≥ÈîÆËØç Á°ÆÂÆöÂü∫Á°ÄÈïúÂÉè‰ΩøÁî® buildo/java8-wkhtmltopdf „ÄÇ Dockerfile (Á¨¨‰∏ÄÁâà)1FROM buildo/java8-wkhtmltopdf ‰∏ãËΩΩJCEÈúÄË¶Å‰ΩøÁî®Âà∞JCEÔºåÂú®oracleÂÆòÁΩë‰∏ãËΩΩ„ÄÇ JDK7ÁöÑ‰∏ãËΩΩÂú∞ÂùÄ: http://www.oracle.com/technetwork/java/javase/downloads/jce-7-download-432124.htmlJDK8ÁöÑ‰∏ãËΩΩÂú∞ÂùÄ: http://www.oracle.com/technetwork/java/javase/downloads/jce8-download-2133166.html Java Cryptography Extension (JCE) Êó†ÈôêÂº∫Â∫¶ÊùÉÈôêÁ≠ñÁï•Êñá‰ª∂ 8 ‰∏ãËΩΩ Dockerfile (Á¨¨‰∫åÁâà)12345678FROM buildo/java8-wkhtmltopdfMAINTAINER hongye.zhao@vcg.comRUN mkdir -p /application/WORKDIR /application/ADD . .RUN unzip jce_policy-8.zip &amp;&amp; \ cp UnlimitedJCEPolicyJDK8/US_export_policy.jar /docker-java-home/jre/lib/security &amp;&amp; \ cp UnlimitedJCEPolicyJDK8/local_policy.jar /docker-java-home/jre/lib/security &amp;&amp; \ Â§ÑÁêÜÁ®ãÂ∫èÊä•Èîô1„ÄÅÊâæÂà∞‰∏çÂà∞ iSignature.pfx ËØÅ‰π¶ÔºöÊä•ÈîôÊà™ÂõæÔºö ÂèØ‰ª•ÁúãÂà∞Êâæ‰∏çÂà∞/media/providerstamp/signature/iSignature.pfx ËØÅ‰π¶Êñá‰ª∂ÔºåÁÆÄÂçïÔºå‰ªéËÄÅÊúçÂä°Âô®‰∏äÊâæÂà∞ÂØπÂ∫îÊñá‰ª∂ÔºåÊã∑Ë¥ùËøáÊù•„ÄÇ Dockerfile (Á¨¨‰∏âÁâà)12345678910FROM buildo/java8-wkhtmltopdfMAINTAINER hongye.zhao@vcg.comRUN mkdir -p /application/WORKDIR /application/ADD . .RUN unzip jce_policy-8.zip &amp;&amp; \ cp UnlimitedJCEPolicyJDK8/US_export_policy.jar /docker-java-home/jre/lib/security &amp;&amp; \ cp UnlimitedJCEPolicyJDK8/local_policy.jar /docker-java-home/jre/lib/security &amp;&amp; \ mkdir -p /media/providerstamp/signature/ &amp;&amp; \ cp iSignature.pfx /media/providerstamp/signature/ &amp;&amp; \ 2„ÄÅtmpDic‰∏çÊòØÊñá‰ª∂Â§π Á†îÂèëÊü•Áúã‰ª£Á†ÅÂêéÁ°ÆÂÆöÊòØË¶Å‰ΩøÁî® /media/providerstamp/temp/ ÁõÆÂΩïÔºåÁ¥¢ÊÄßÁôªÂΩïËÄÅÊúçÂä°Âô®‰∏äÊü•Áúã/media/providerstamp‰∏ãÊâÄÊúâÁõÆÂΩïÔºåÈÉΩÂàõÂª∫Â•ΩÔºåÂπ∂Â∞ÜÈúÄË¶ÅÁöÑÊñá‰ª∂scpÊã∑Ë¥ùËøáÊù•„ÄÇ ÁúãÂà∞ËøòÊúâ done „ÄÅunitrustÁõÆÂΩïÔºåÂπ∂‰∏îunitrustÁõÆÂΩï‰∏≠ÁöÑunitrust.key Á®ãÂ∫è‰πü‰ºöÁî®Âà∞„ÄÇ Dockerfile (Á¨¨ÂõõÁâà)1234567891011121314FROM buildo/java8-wkhtmltopdfMAINTAINER hongye.zhao@vcg.comRUN mkdir -p /application/WORKDIR /application/ADD . .RUN unzip jce_policy-8.zip &amp;&amp; \ cp UnlimitedJCEPolicyJDK8/US_export_policy.jar /docker-java-home/jre/lib/security &amp;&amp; \ cp UnlimitedJCEPolicyJDK8/local_policy.jar /docker-java-home/jre/lib/security &amp;&amp; \ mkdir -p /media/providerstamp/signature/ &amp;&amp; \ mkdir -p /media/providerstamp/done/ &amp;&amp; \ mkdir -p /media/providerstamp/unitrust/ &amp;&amp; \ mkdir -p /media/providerstamp/temp/ &amp;&amp; \ cp unitrust.key /media/providerstamp/unitrust &amp;&amp; \ cp iSignature.pfx /media/providerstamp/signature/ &amp;&amp; \ 3„ÄÅpdfÂÜÖÂÆπ‰π±Á†Å‰π±Á†ÅÊòØÁî±‰∫éÂ≠ó‰ΩìÈóÆÈ¢òÔºåÁÆÄÂçïÁõ¥Êé•ÔºåÁõ¥Êé•‰ªéËÄÅÊúçÂä°Âô®‰∏äÊã∑Ë¥ù /usr/share/fonts ÁõÆÂΩï„ÄÇ Dockerfile (Á¨¨‰∫îÁâà)12345678910111213141516171819FROM buildo/java8-wkhtmltopdfMAINTAINER hongye.zhao@vcg.comRUN mkdir -p /application/WORKDIR /application/ADD . .RUN unzip jce_policy-8.zip &amp;&amp; \ cp UnlimitedJCEPolicyJDK8/US_export_policy.jar /docker-java-home/jre/lib/security &amp;&amp; \ cp UnlimitedJCEPolicyJDK8/local_policy.jar /docker-java-home/jre/lib/security &amp;&amp; \ mkdir -p /media/providerstamp/signature/ &amp;&amp; \ mkdir -p /media/providerstamp/done/ &amp;&amp; \ mkdir -p /media/providerstamp/unitrust/ &amp;&amp; \ mkdir -p /media/providerstamp/temp/ &amp;&amp; \ cp unitrust.key /media/providerstamp/unitrust &amp;&amp; \ cp iSignature.pfx /media/providerstamp/signature/ &amp;&amp; \ rm -f /usr/local/bin/wkhtmltopdf &amp;&amp; \ rm -rf /usr/share/fonts &amp;&amp; \ cp wkhtmltopdf /usr/local/bin/ &amp;&amp; \ tar zxf fonts.tar.gz &amp;&amp; \ mv fonts/ /usr/share/ Ëá≥Ê≠§ÔºåÊ≠§ÂæÆÊúçÂä°ÂÆπÂô®ÂåñÂ∑≤ÂÆåÊàê„ÄÇüëèüëèüëè]]></content>
      <tags>
        <tag>Docker</tag>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Docker-ÈïúÂÉèimage]]></title>
    <url>%2F2019%2F04%2F23%2FDocker-%E9%95%9C%E5%83%8Fimage%2F</url>
    <content type="text"><![CDATA[DockerÈïúÂÉèÊòØÂêØÂä®ÂÆπÂô®ÁöÑÂü∫Áü≥„ÄÇ ‰ªÄ‰πàÊòØDockerÈïúÂÉè DockerÈïúÂÉèÊòØÁî±Êñá‰ª∂Á≥ªÁªüÂè†Âä†ËÄåÊàê„ÄÇÊúÄÂ∫ïÁ´ØÊòØ‰∏Ä‰∏™Êñá‰ª∂ÂºïÂØºÁ≥ªÁªüÔºåÂç≥bootfs„ÄÇDockerÁî®Êà∑‰∏ç‰ºö‰∏éÂºïÂØºÊñá‰ª∂Á≥ªÁªüÊúâÁõ¥Êé•ÁöÑ‰∫§‰∫í„ÄÇDockerÈïúÂÉèÁöÑÁ¨¨‰∫åÂ±ÇÊòØrootÊñá‰ª∂Á≥ªÁªürootfsÔºåÈÄöÂ∏∏ÊòØ‰∏ÄÁßçÊàñÂ§öÁßçÊìç‰ΩúÁ≥ªÁªüÔºå‰æãÂ¶ÇubuntuÁ≠â„ÄÇÂú®Docker‰∏≠ÔºåÊñá‰ª∂Á≥ªÁªüÊ∞∏ËøúÈÉΩÊòØÂè™ËØªÁöÑÔºåÂú®ÊØèÊ¨°‰øÆÊîπÊó∂ÔºåÈÉΩÊòØËøõË°åÊã∑Ë¥ùÂè†Âä†‰ªéËÄåÂΩ¢ÊàêÊúÄÁªàÁöÑÊñá‰ª∂Á≥ªÁªü„ÄÇDockerÁß∞ËøôÊ†∑ÁöÑÊñá‰ª∂‰∏∫ÈïúÂÉè„ÄÇ‰∏Ä‰∏™ÈïúÂÉèÂèØ‰ª•Ëø≠‰ª£Âú®Âè¶‰∏Ä‰∏™ÈïúÂÉèÁöÑÈ°∂ÈÉ®„ÄÇ‰Ωç‰∫é‰∏ãÊñπÁöÑÈïúÂÉèÁß∞‰πã‰∏∫Áà∂ÈïúÂÉèÔºåÊúÄÂ∫ïÂ±ÇÁöÑÈïúÂÉèÁß∞‰πã‰∏∫Âü∫Á°ÄÈïúÂÉè„ÄÇÊúÄÂêéÔºåÂΩì‰ªé‰∏Ä‰∏™ÈïúÂÉèÂêØÂä®ÂÆπÂô®Êó∂ÔºåDocker‰ºöÂú®ÊúÄÈ°∂Â±ÇÂä†ËΩΩ‰∏Ä‰∏™ËØªÂÜôÊñá‰ª∂Á≥ªÁªü‰Ωú‰∏∫ÂÆπÂô®„ÄÇ DockerÁöÑËøôÁßçÊú∫Âà∂Êàë‰ª¨Áß∞‰πã‰∏∫ÂÜôÊó∂Â§çÂà∂„ÄÇ Êü•ÁúãÈïúÂÉèÂàóË°® 1docker images ËØ•ÂëΩ‰ª§ÂèØ‰ª•Áî®‰∫éÊü•ÊâæÂΩìÂâçÁ≥ªÁªü‰∏≠ÊâÄÊúâÂ≠òÂú®ÁöÑÈïúÂÉèÂàóË°®„ÄÇ PsÔºöÊú¨Âú∞ÈïúÂÉèÈªòËÆ§‰øùÂ≠òÂú®DockerÂÆø‰∏ªÊú∫ÁöÑ/var/lib/dockerÁõÆÂΩï‰∏ã„ÄÇÊâÄÊúâÁöÑÈïúÂÉèÈÉΩÊòØ‰øùÂ≠òÂú®‰ªìÂ∫ì‰∏≠ÔºåËÄå‰ªìÂ∫ì‰Ωç‰∫éRegistry‰∏≠„ÄÇÈªòËÆ§ÁöÑRegistryÊòØDockerÂÖ¨Âè∏ËøêËê•ÁöÑDocker Hub„ÄÇÊØè‰∏™ÈïúÂÉè‰ªìÂ∫ìÈÉΩÂèØ‰ª•Â≠òÊîæÂæàÂ§öÁöÑÈïúÂÉè„ÄÇ ÊãâÂèñÈïúÂÉè 1docker pull centos ‰∏äËø∞ÂëΩ‰ª§‰ºöÊãâÂèñÈïúÂÉèÂà∞Êú¨Âú∞„ÄÇ ‰∏∫‰∫ÜÂå∫ÂàÜÂêå‰∏Ä‰∏™‰ªìÂ∫ì‰∏≠‰∏çÂêåÁöÑÈïúÂÉèÔºåDockerÊèê‰æõ‰∫Ü‰∏ÄÁßçtagÁöÑÂäüËÉΩ„ÄÇÊàë‰ª¨ÂèØ‰ª•ÁªôÊØè‰∏™ÁâàÊú¨ÁöÑÈïúÂÉèÊ∑ªÂä†‰∏Ä‰∏™ÂîØ‰∏ÄÁöÑtagÊù•Ê†áËØÜËØ•ÈïúÂÉè„ÄÇÊ≠§Êó∂ÔºåÈïúÂÉèÁöÑÂêçÁß∞Â¶Ç‰∏ãÔºö‰ªìÂ∫ìÂêçÁß∞:tag„ÄÇÊàë‰ª¨Âú®ËøêË°åÈïúÂÉèÊàñÊãâÂèñÈïúÂÉèÊó∂ÔºåÂèØ‰ª•Áõ¥Êé•ÊåáÂÆöÂØπÂ∫îÁöÑÊ†áÁ≠æ„ÄÇ 1docker pull registry-vpc.cn-beijing.aliyuncs.com/vcgcs/jdk8:util Êü•ÊâæÈïúÂÉè ‰ªéDocker HubÊü•ÊâæÊúâÂì™‰∫õÂÖ¨ÂÖ±ÁöÑÂèØÁî®ÈïúÂÉè 1docker search keywords ÊûÑÂª∫DockerÈïúÂÉè docker build ÂëΩ‰ª§Áî®‰∫é‰ΩøÁî® Dockerfile ÂàõÂª∫ÈïúÂÉè„ÄÇ 1docker build -t runoob/ubuntu:v1 . ‰ΩøÁî®URL github.com/creack/docker-firefox ÁöÑ Dockerfile ÂàõÂª∫ÈïúÂÉè„ÄÇ 1docker build github.com/creack/docker-firefox ‰πüÂèØ‰ª•ÈÄöËøá -f Dockerfile Êñá‰ª∂ÁöÑ‰ΩçÁΩÆÔºö 1docker build -f /path/to/a/Dockerfile . ÁôªÂΩïÈïúÂÉè‰ªìÂ∫ì‰ΩøÁî®ÈòøÈáå‰∫ëÂÆπÂô®ÈïúÂÉèÊúçÂä° 1docker login --username="ops@vcg.com" --password="******" registry-vpc.cn-beijing.aliyuncs.com Êé®ÈÄÅÈïúÂÉèÂà∞‰ªìÂ∫ì1docker push registry-vpc.cn-beijing.aliyuncs.com/vcgcs/jdk8:util ‰øÆÊîπÈïúÂÉèTag12docker images # Ëé∑ÂèñImageIddocker tag [ImageId] registry.cn-beijing.aliyuncs.com/vcg/500px-vcg-com:[ÈïúÂÉèÁâàÊú¨Âè∑]]]></content>
      <categories>
        <category>Docker</category>
      </categories>
      <tags>
        <tag>Docker</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ansible-ÊâπÈáè‰øÆÊîπÂØÜÁ†Å]]></title>
    <url>%2F2019%2F04%2F23%2FAnsible-%E6%89%B9%E9%87%8F%E4%BF%AE%E6%94%B9%E5%AF%86%E7%A0%81%2F</url>
    <content type="text"><![CDATA[‰ªãÁªç‰ΩøÁî®ansibleÊâπÈáè‰øÆÊîπÁî®Êà∑ÂØÜÁ†ÅÁöÑÊñπÊ≥ïÔºåÂõ†‰∏∫Âú®‰ΩøÁî®ansible‰øÆÊîπÁî®Êà∑ÂØÜÁ†ÅÁöÑÊó∂ÂÄô‰∏çËÉΩ‰ΩøÁî®ÊòéÊñáÁöÑÊñπÂºèÔºåÈúÄË¶ÅÂÖàÂä†ÂØÜÔºåÊâÄ‰ª•Â∞±ÈúÄË¶Å‰ΩøÁî®‰∏Ä‰∏™ÊñπÊ≥ïÂØπËæìÂÖ•ÁöÑÊòéÊñáÁöÑÂØÜÁ†ÅËøõË°åÂä†ÂØÜÔºå‰∏ãÈù¢Â∞±Áõ¥Êé•‰∏äÂπ≤Ë¥ß„ÄÇ Êõ¥ÊîπÂ§ö‰∏™Âõ∫ÂÆöÂüüÂêç1cat changePasswd.yaml 12345678---- hosts: ops gather_facts: false tasks: - name: change user passwd user: name=&#123;&#123; item.name &#125;&#125; password=&#123;&#123; item.chpass | password_hash('sha512') &#125;&#125; update_password=always with_items: - &#123; name: 'root', chpass: '***********' &#125; 1ansible-playbook changePasswd.yaml]]></content>
      <categories>
        <category>Ansible</category>
      </categories>
      <tags>
        <tag>Ansible</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÈòøÈáå‰∫ëWAF + Kubernetes Ingress Êû∂ÊûÑ‰∏ãÊó†Ê≥ïÊãøÂà∞ÂÆ¢Êà∑Á´ØÁúüÂÆûIPÁöÑÈóÆÈ¢òÂ§ÑÁêÜ]]></title>
    <url>%2F2019%2F04%2F21%2F%E9%98%BF%E9%87%8C%E4%BA%91WAF-Kubernetes-Ingress-%E6%9E%B6%E6%9E%84%E4%B8%8B%E6%97%A0%E6%B3%95%E6%8B%BF%E5%88%B0%E5%AE%A2%E6%88%B7%E7%AB%AF%E7%9C%9F%E5%AE%9EIP%E7%9A%84%E9%97%AE%E9%A2%98%E5%A4%84%E7%90%86%2F</url>
    <content type="text"><![CDATA[ËÉåÊôØ:2019Âπ¥04Êúà19Êó•Êôö21:10ÂàÜËøõË°åÁΩëÁªúÁª¥Êä§ÔºåÂÜÖÂÆπÂ¶Ç‰∏ãÔºö ‚Äã Â∞ÜÂüüÂêçCNAMEÂà∞ÈòøÈáå‰∫ëÁöÑWebÈò≤ÁÅ´Â¢ôÔºà‰ª•‰∏ãÁÆÄÁß∞‰∏∫WAFÔºâÔºå‰∏öÂä°ËØ∑Ê±ÇÁªèÈò≤ÁÅ´Â¢ôËß£ÊûêÂà∞Kubernetes ÁöÑ Ingress ÁöÑË¥üËΩΩÂùáË°°ÔºàSLBÔºâÂú∞ÂùÄ ÊïÖÈöúÁé∞Ë±°Ôºö‚Äã ÂêéÁ´ØÂ∫îÁî®ÈÄöËøáËé∑ÂèñËØ∑Ê±Ç‰∏≠ÁöÑX-Forwarded-ForÂ≠óÊÆµÔºåÊãøÂà∞ÁöÑIPÂú∞ÂùÄ‰∏∫WAFÂõûÊ∫êÂú∞ÂùÄÔºåÈùûÂÆ¢Êà∑Á´ØÁúüÂÆûIP„ÄÇ ÊéíÊü•ËÆ∞ÂΩï: 21:15 Êü•ÁúãIngressÊó•ÂøóÔºåÂèëÁé∞IngressÊãøÂà∞ÁöÑIPÂ∞±ÊòØWAFÂõûÊ∫êÂú∞ÂùÄÔºå‰∏∫ÈîôËØØIPÔºåÁ°ÆÂÆöÈùûÂâçÁ´Ønodejs‰ª£Á†Åbug„ÄÇ 21:33 ËÅîÁ≥ªÈòøÈáå‰∫ëÊäÄÊúØÂõ¢Èòü‰∏ÄËµ∑ÊéíÊü•ÈóÆÈ¢ò„ÄÇ 22:20 Á°ÆËÆ§IngressÁöÑÊ®°ÊùøÊñá‰ª∂‰∏≠ the_real_ip ÂèòÈáèÊòØÊãøÁöÑ remote_addr Â≠óÊÆµÔºåÁ≠âÂæÖÈòøÈáåÊäÄÊúØËÅîÁ≥ªIngreeÁ†îÂèëÂêåÂ≠¶ÔºåÁªôÂá∫ÂõûÂ§ç„ÄÇ 23:23 IngreeÁ†îÂèëÂêåÂ≠¶ËÅîÁ≥ª‰∏äÂêéÁ°ÆËÆ§IngressÊ≤°ÈóÆÈ¢òÔºåÂèØËÉΩÊòØWAFÊ≤°‰º†ÁúüÂÆûIPÂà∞Ingress„ÄÇ 23:50 Âú®IngressÂÆπÂô®ÂíåÂâçÁ´ØnodejsÊâÄÂú®ÂÆø‰∏ªÊú∫tcpdumpÂ∑•ÂÖ∑ÊäìÂåÖÂêéÂàÜÊûêÂæóÂá∫Ôºö (1)„ÄÅWAFÂ∑≤ÁªèÂ∞ÜÁúüÂÆûÂÆ¢Êà∑Á´ØÂú∞ÂùÄÊîæÂà∞‰∫Ü x-Forwarded-For ÁöÑÂ≠óÊÆµ‰∏≠‰º†Áªô‰∫ÜECS(2)„ÄÅECS(ÂÆπÂô®ÁöÑingress)Â∞ÜÁúüÂÆûÁöÑÂÆ¢Êà∑Á´ØIPÔºåÊîæÂà∞‰∫Üx-Original-Forwarded-ForÔºõËÄåÂ∞ÜWAFÁöÑÂõûÊ∫êÂú∞ÂùÄÊîæÂà∞‰∫Ü x-Forwarded-For 4Êúà20Êó• 00:29 Â∞Ücompute-full-forwarded-forÈÖçÁΩÆÂà∞IngressÁöÑConfigMap‰∏≠ÔºåÈóÆÈ¢òËß£ÂÜ≥„ÄÇ Êìç‰ΩúÔºö1kubectl -n kube-system edit cm nginx-configuration 1234Âú®dataÊ†áÁ≠æ‰∏ãÊ∑ªÂä†Â¶Ç‰∏ãÔºöcompute-full-forwarded-for: &quot;true&quot;forwarded-for-header: &quot;X-Forwarded-For&quot;use-forwarded-headers: &quot;true&quot; ÁªìËÆ∫ÔºöÈòøÈáå‰∫ëÂÆπÂô®ÊúçÂä°KubernetesÈõÜÁæ§ÁöÑIngressÈªòËÆ§ConfigMap‰∏≠Êú™ÈÖçÁΩÆ compute-full-forwarded-forÂèÇÊï∞ÔºåÂØºËá¥Â∞ÜingressÊãøÂà∞ÁöÑWAFÂõûÊ∫êIPÊõøÊç¢‰∏∫XFFÔºåËÄåÈùûÈôÑÂä†Âà∞XFF‰∏≠„ÄÇ https://kubernetes.github.io/ingress-nginx/user-guide/nginx-configuration/configmap/#compute-full-forwarded-for ÂèçÊÄùÔºö È¢ÑËßàÁéØÂ¢ÉÂíåÁ∫ø‰∏äÁéØÂ¢ÉÊû∂ÊûÑ‰∏ç‰∏ÄËá¥Ôºö Ê≠§Ê¨°ÊïÖÈöú‰∏≠ÔºåÈ¢ÑËßàÁéØÂ¢ÉÊú™‰ΩøÁî®WAFÈò≤Êä§ÔºåÁõ¥Êé•Ëß£ÊûêÂà∞K8SÈõÜÁæ§ÔºåÊú™ÊèêÂâçÂèëÁé∞Ê≠§Ê¨°ÈóÆÈ¢òÔºåÂ∑≤‰øÆÊ≠£Ôºå‰ª•ÂêéÂ∞ΩÈáèÁª¥ÊåÅÁéØÂ¢ÉÁªü‰∏ÄÔºåÈÅøÂÖçÊ≠§Á±ªÈóÆÈ¢òÂá∫Áé∞„ÄÇ ÊïÖÈöúÁÇπÂÆö‰ΩçÈÄüÂ∫¶ÊÖ¢Ôºö ÁΩëÁªúËØ∑Ê±ÇÈóÆÈ¢ò‰ºòÂÖàÊäìÂåÖÂàÜÊûêÔºåÊèêÂçáÊïÖÈöúÂÆö‰ΩçÈÄüÂ∫¶ÔºåÂêéÁª≠Â§ØÂÆûÂü∫Á°ÄÁü•ËØÜÔºåÊèêÂçáÈóÆÈ¢òÊéíÊü•ËÉΩÂäõ„ÄÇ Kubernetes‰∏ì‰∏öÁü•ËØÜÊéåÊè°Á®ãÂ∫¶ËæÉ‰Ωé ÁõÆÂâç‰ªÖ‰ªÖÂú®‰ΩøÁî®Â±ÇÈù¢‰∏äËÉΩÂäõokÔºå‰ΩÜÊòØÂÖ∂ÂÆûÁé∞ÂéüÁêÜ„ÄÅÁªÑ‰ª∂ÂÆûÁé∞ÊñπÂºèÁ≠âÁü•ËØÜÁÇπËñÑÂº±ÔºåÂêéÁª≠ËøòÈúÄÂú®K8SÂ≠¶‰π†‰∏≠Â§öÊÄªÁªìÔºåÂ§öÂ≠¶‰π†Ôºå‰∫âÂèñÂáèÂ∞ëÊïÖÈöúÔºåÊèêÂçáËøêÁª¥ËÉΩÂäõ„ÄÇ]]></content>
      <categories>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kubernetes-kubectl]]></title>
    <url>%2F2019%2F04%2F21%2FKubernetes-kubectl%2F</url>
    <content type="text"><![CDATA[ÁÆ°ÁêÜKubernetesÈõÜÁæ§ÁöÑÂ∑•ÂÖ∑ ÂÆâË£Ö ‰∏ãËΩΩÊúÄÊñ∞ÁâàÁöÑkubectlÂÆ¢Êà∑Á´Øhttps://github.com/kubernetes/kubernetes/blob/master/CHANGELOG.md&gt; ÂÆâË£ÖÂíåÈÖçÁΩÆhttps://kubernetes.io/docs/tasks/tools/install-kubectl/&gt; È™åËØÅÂÆâË£Ö 1kuberctl version ÈÖçÁΩÆÈõÜÁæ§Âá≠ËØÅÊÇ®ÂèØ‰ª•‰ΩøÁî®scpÂëΩ‰ª§ÂÆâÂÖ®Âú∞Â∞Ü‰∏ªËäÇÁÇπÁöÑÈÖçÁΩÆ‰ªé Kubernetes ÈõÜÁæ§‰∏ª VM ‰∏≠ÁöÑ /etc/kubernetes/kube.conf Â§çÂà∂Âà∞Êú¨Âú∞ËÆ°ÁÆóÊú∫ÁöÑ $HOME/.kube/configÔºàkubectl È¢ÑÊúüÂá≠ÊçÆÊâÄÂú®ÁöÑ‰ΩçÁΩÆÔºâ„ÄÇ 12mkdir $HOME/.kubescp root@&lt;master-public-ip&gt;:/etc/kubernetes/kube.conf $HOME/.kube/config ÂÖ¨Êúâ‰∫ëÁéØÂ¢É‰πüÂèØ‰ª•Âú®ÈõÜÁæ§ÈÖçÁΩÆÈ°µÈù¢Ëé∑ÂèñÂà∞configÈÖçÁΩÆ È™åËØÅËøûÊé• 1kubect get all ÂëΩ‰ª§ÂèÇÊï∞help-Ëé∑ÂèñÂ∏ÆÂä©‰ø°ÊÅØ123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475zhaohongye ~ ^-^ #kubectl helpkubectl controls the Kubernetes cluster manager.Find more information at: https://kubernetes.io/docs/reference/kubectl/overview/Basic Commands (Beginner): create Create a resource from a file or from stdin. expose ‰ΩøÁî® replication controller, service, deployment ÊàñËÄÖ podÂπ∂Êö¥Èú≤ÂÆÉ‰Ωú‰∏∫‰∏Ä‰∏™ Êñ∞ÁöÑ Kubernetes Service run Âú®ÈõÜÁæ§‰∏≠ËøêË°å‰∏Ä‰∏™ÊåáÂÆöÁöÑÈïúÂÉè set ‰∏∫ objects ËÆæÁΩÆ‰∏Ä‰∏™ÊåáÂÆöÁöÑÁâπÂæÅ run-container Âú®ÈõÜÁæ§‰∏≠ËøêË°å‰∏Ä‰∏™ÊåáÂÆöÁöÑÈïúÂÉè. This command isdeprecated, use "run" insteadBasic Commands (Intermediate): get ÊòæÁ§∫‰∏Ä‰∏™ÊàñÊõ¥Â§ö resources explain Êü•ÁúãËµÑÊ∫êÁöÑÊñáÊ°£ edit Âú®ÊúçÂä°Âô®‰∏äÁºñËæë‰∏Ä‰∏™ËµÑÊ∫ê delete Delete resources by filenames, stdin, resources and names, orby resources and label selectorDeploy Commands: rollout Manage the rollout of a resource rolling-update ÂÆåÊàêÊåáÂÆöÁöÑ ReplicationController ÁöÑÊªöÂä®ÂçáÁ∫ß scale ‰∏∫ Deployment, ReplicaSet, Replication Controller ÊàñËÄÖ JobËÆæÁΩÆ‰∏Ä‰∏™Êñ∞ÁöÑÂâØÊú¨Êï∞Èáè autoscale Ëá™Âä®Ë∞ÉÊï¥‰∏Ä‰∏™ Deployment, ReplicaSet, ÊàñËÄÖReplicationController ÁöÑÂâØÊú¨Êï∞ÈáèCluster Management Commands: certificate ‰øÆÊîπ certificate ËµÑÊ∫ê. cluster-info ÊòæÁ§∫ÈõÜÁæ§‰ø°ÊÅØ top Display Resource (CPU/Memory/Storage) usage. cordon Ê†áËÆ∞ node ‰∏∫ unschedulable uncordon Ê†áËÆ∞ node ‰∏∫ schedulable drain Drain node in preparation for maintenance taint Êõ¥Êñ∞‰∏Ä‰∏™ÊàñËÄÖÂ§ö‰∏™ node ‰∏äÁöÑ taintsTroubleshooting and Debugging Commands: describe ÊòæÁ§∫‰∏Ä‰∏™ÊåáÂÆö resource ÊàñËÄÖ group ÁöÑ resources ËØ¶ÊÉÖ logs ËæìÂá∫ÂÆπÂô®Âú® pod ‰∏≠ÁöÑÊó•Âøó attach Attach Âà∞‰∏Ä‰∏™ËøêË°å‰∏≠ÁöÑ container exec Âú®‰∏Ä‰∏™ container ‰∏≠ÊâßË°å‰∏Ä‰∏™ÂëΩ‰ª§ port-forward Forward one or more local ports to a pod proxy ËøêË°å‰∏Ä‰∏™ proxy Âà∞ Kubernetes API server cp Â§çÂà∂ files Âíå directories Âà∞ containersÂíå‰ªéÂÆπÂô®‰∏≠Â§çÂà∂ files Âíå directories. auth Inspect authorizationAdvanced Commands: apply ÈÄöËøáÊñá‰ª∂ÂêçÊàñÊ†áÂáÜËæìÂÖ•ÊµÅ(stdin)ÂØπËµÑÊ∫êËøõË°åÈÖçÁΩÆ patch ‰ΩøÁî® strategic merge patch Êõ¥Êñ∞‰∏Ä‰∏™ËµÑÊ∫êÁöÑ field(s) replace ÈÄöËøá filename ÊàñËÄÖ stdinÊõøÊç¢‰∏Ä‰∏™ËµÑÊ∫ê convert Âú®‰∏çÂêåÁöÑ API versions ËΩ¨Êç¢ÈÖçÁΩÆÊñá‰ª∂Settings Commands: label Êõ¥Êñ∞Âú®Ëøô‰∏™ËµÑÊ∫ê‰∏äÁöÑ labels annotate Êõ¥Êñ∞‰∏Ä‰∏™ËµÑÊ∫êÁöÑÊ≥®Ëß£ completion Output shell completion code for the specified shell (bash orzsh)Other Commands: api-versions Print the supported API versions on the server, in the form of"group/version" config ‰øÆÊîπ kubeconfig Êñá‰ª∂ help Help about any command plugin Runs a command-line plugin version ËæìÂá∫ client Âíå server ÁöÑÁâàÊú¨‰ø°ÊÅØUsage: kubectl [flags] [options]Use "kubectl &lt;command&gt; --help" for more information about a given command.Use "kubectl options" for a list of global command-line options (applies to allcommands). get-Ëé∑Âèñ‰ø°ÊÅØDisplay one or many resources 123456789101112131415161718192021222324252627Examples: # List all pods in ps output format. kubectl get pods # List all pods in ps output format with more information (such as node name). kubectl get pods -o wide # List a single replication controller with specified NAME in ps output format. kubectl get replicationcontroller web # List a single pod in JSON output format. kubectl get -o json pod web-pod-13je7 # List a pod identified by type and name specified in "pod.yaml" in JSON output format. kubectl get -f pod.yaml -o json # Return only the phase value of the specified pod. kubectl get -o template pod/web-pod-13je7 --template=&#123;&#123;.status.phase&#125;&#125; # List all replication controllers and services together in ps output format. kubectl get rc,services # List one or more resources by their type and names. kubectl get rc/web service/frontend pods/web-pod-13je7 # List all resources with different types. kubectl get all scale-Êâ©Áº©ÂÆπSet a new size for a Deployment, ReplicaSet, Replication Controller, or StatefulSet. 123456789101112131415161718Examples: # Scale a replicaset named &apos;foo&apos; to 3. kubectl scale --replicas=3 rs/foo # Scale a resource identified by type and name specified in &quot;foo.yaml&quot; to 3. kubectl scale --replicas=3 -f foo.yaml # If the deployment named mysql&apos;s current size is 2, scale mysql to 3. kubectl scale --current-replicas=2 --replicas=3 deployment/mysql # Scale multiple replication controllers. kubectl scale --replicas=5 rc/foo rc/bar rc/baz # Scale statefulset named &apos;web&apos; to 3. kubectl scale --replicas=3 statefulset/web kubectl scale Deployment node-vcg-web --replicas=1 kubectl scale Deployment node-vcg-web --replicas=10 ÊâπÈáèÊâ©Áº©ÂÆπ 123for i in `kubectl get deployment | awk '&#123;print $1&#125;' |grep -v NAME`; do kubectl scale Deployment $i --replicas=1done exec-Âú®container‰∏≠ÊâßË°åÂëΩ‰ª§Execute a command in a container. 123456789Options: -c, --container='': Container name. If omitted, the first container in the pod will be chosen -p, --pod='': Pod name -i, --stdin=false: Pass stdin to the container -t, --tty=false: Stdin is a TTYExamples: kubectl exec 123456-7890 -c ruby-container -it -- bash -ilUsage: kubectl exec POD [-c CONTAINER] -- COMMAND [args...] [options]]]></content>
      <categories>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hexo-ÂçöÂÆ¢‰∏≠Ê∑ªÂä†ÂõæÁâáÁ≠âËµÑÊ∫ê]]></title>
    <url>%2F2019%2F04%2F21%2FHexo-%E5%8D%9A%E5%AE%A2%E4%B8%AD%E6%B7%BB%E5%8A%A0%E5%9B%BE%E7%89%87%E7%AD%89%E8%B5%84%E6%BA%90%2F</url>
    <content type="text"><![CDATA[ÂºïÁî®‰∫é https://blog.csdn.net/qq_40265501/article/details/80019774 ÂÆòÊñπ‰ªãÁªçÔºöhttps://hexo.io/zh-cn/docs/asset-folders.html ‰∏ÄÂõæËÉú‰∏áË®Ä ÂçöÂÆ¢‰∏≠ÊúâÊó∂ÂÄôÂõæÁâáÊØîÊñáÂ≠óÊõ¥ÊúâËØ¥ÊúçÂäõÔºåÊØîÂ¶ÇÔºö‰ª£Á†ÅËøêË°åÁªìÊûúÔºå‰ª£Á†ÅËøêË°åÊïàÊûúÁ≠â ÂºÄÂêØ‚ÄôËµÑÊ∫êÊñá‰ª∂ÁÆ°ÁêÜ‚ÄôÂäüËÉΩÂ∞Ü config.ymlÊñá‰ª∂‰∏≠ÁöÑ post_asset_folder ÈÄâÈ°πËÆæ‰∏∫ true 12_config.ymlpost_asset_folder: true ÂÆâË£ÖHexoÊèí‰ª∂Êèí‰ª∂Âú∞ÂùÄÔºöhttps://github.com/dangxuandev/hexo-asset-image 1npm install hexo-asset-image --save Âú®ÂçöÂÆ¢‰∏≠Ê∑ªÂä†ÂõæÁâá Êñ∞Âª∫ÂçöÂÆ¢ 1hexo n test Êü•ÁúãÁõÆÂΩïÁªìÊûÑ 123[root@nginx GeekSRE]# ls -l source/_posts/ |grep testdrwxr-xr-x 2 root root 4096 4Êúà 17 17:29 test-rw-r--r-- 1 root root 96 4Êúà 17 17:35 test.md ÂèØ‰ª•ÁúãÂà∞ ‰ºöÂú® source/_posts ÁõÆÂΩïÂàõÂª∫ test.md Âíå testÁõÆÂΩï ‰∏éÂçöÂÆ¢ÂêåÂêçÁõÆÂΩïÁî®‰∫éÂ≠òÊîæËµÑÊ∫êÊñá‰ª∂ÔºåÂ¶ÇÂõæÁâá„ÄÅCSS„ÄÅJS Êñá‰ª∂Á≠â ‰∏ä‰º†ÂõæÁâáÂà∞‚ÄùÊñáÁ´†ËµÑÊ∫êÊñá‰ª∂Â§π‚Äù 123# ÊØîÂ¶Ç‰ΩøÁî®CSDNÂçöÂÆ¢‰∏≠ÁöÑÂõæÁâáÔºöcd source/_posts/testwget https://img-blog.csdn.net/20180420154609543 ÂºïÁî® 12345vim source/_posts/test.md# ![‰Ω†ÊÉ≥Ë¶ÅËæìÂÖ•ÁöÑÊõø‰ª£ÊñáÂ≠ó](ÂõæÁâáÊñá‰ª∂)# ÊØîÂ¶ÇÔºö![ÂõæÁâá](test.jpg) ‰øùÂ≠ò 1hexo clean &amp;&amp; hexo g &amp;&amp; hexo d È™åËØÅÊïàÊûú]]></content>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[GitLab‰ª£Á†ÅÊâòÁÆ°]]></title>
    <url>%2F2019%2F04%2F16%2FGitLab%E4%BB%A3%E7%A0%81%E6%89%98%E7%AE%A1%2F</url>
    <content type="text"><![CDATA[GitLab ÊòØ‰∏Ä‰∏™Áî®‰∫é‰ªìÂ∫ìÁÆ°ÁêÜÁ≥ªÁªüÁöÑÂºÄÊ∫êÈ°πÁõÆÔºå‰ΩøÁî®Git‰Ωú‰∏∫‰ª£Á†ÅÁÆ°ÁêÜÂ∑•ÂÖ∑ÔºåÂπ∂Âú®Ê≠§Âü∫Á°Ä‰∏äÊê≠Âª∫Ëµ∑Êù•ÁöÑwebÊúçÂä°„ÄÇ ÂÆòÁΩëÔºöhttps://about.gitlab.com/stages-devops-lifecycle/ ÂÆâË£ÖÈÖçÁΩÆYumÊ∫ê123456vim /etc/yum.repos.d/gitlab_gitlab-ee.repo[gitlab-ce]name=Gitlab CE Repositorybaseurl=https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el$releasever/gpgcheck=0enabled=1 ÂÆâË£Ö12yum install -y postfixyum install gitlab-ce -y ÈÖçÁΩÆÈÖçÁΩÆÊñá‰ª∂Ôºö/etc/gitlab/gitlab.rb (Âª∫ËÆÆÊØèÊ¨°‰øÆÊîπÂâçÂ§á‰ªΩÊ≠§Êñá‰ª∂) 1234567891011121314151617181920212223242526272829 external_url 'https://git.visualchina.com' # ÂüüÂêçÈÖçÁΩÆ gitlab_rails['time_zone'] = 'Asia/Shanghai' # Êó∂Âå∫ nginx['redirect_http_to_https'] = true # SSLËØÅ‰π¶ nginx['ssl_certificate'] = "/data/vcg/ssl/visualchina.pem" nginx['ssl_certificate_key'] = "/data/vcg/ssl/visualchina.key" gitlab_rails['ldap_enabled'] = truegitlab_rails['ldap_servers'] = YAML.load &lt;&lt;-'EOS' # remember to close this block with 'EOS' below main: # 'main' is the GitLab 'provider ID' of this LDAP server label: 'LDAP' host: '172.16.239.3' port: 389 uid: 'cn' method: 'plain' # "tls" or "ssl" or "plain" bind_dn: 'cn=root,dc=vcg,dc=com' password: 'vcg@2018' active_directory: true allow_username_or_email_login: false block_auto_created_users: false base: 'ou=People,dc=vcg,dc=com' user_filter: '' attributes: username: ['cn'] email: ['mail'] name: 'cn' first_name: 'givenName' last_name: 'sn'EOS ÈÖçÁΩÆÂÆåÊàêÂêéËøõË°åÈÖçÁΩÆÊõ¥Êñ∞1gitlab-ctl reconfigure Ê£ÄÊü•ÊòØÂê¶ÈÖçÁΩÆÊàêÂäü1gitlab-rake gitlab:ldap:checkÔºàÂàóÂá∫Ââç100‰∏™Áî®Êà∑Ôºâ ÈáçÂêØgitlabÊúçÂä°1gitlab-ctl restart ËÆøÈóÆËÆøÈóÆip:80Á´ØÂè£ ÈÖçÁΩÆrootÂØÜÁ†ÅÔºåËá≥Ê≠§ÈÉ®ÁΩ≤ÂÆåÊàê„ÄÇ ÂçáÁ∫ßÂçáÁ∫ßËßÑËåÉÂíåÂª∫ËÆÆhttps://docs.gitlab.com/ee/policy/maintenance.html#upgrade-recommendations È¶ñÂÖàÂçáÁ∫ßÂà∞‰∏ªË¶ÅÁâàÊú¨‰∏≠ÁöÑÊúÄÊñ∞ÂèØÁî®Ê¨°Ë¶ÅÁâàÊú¨ ‰æãÂ¶ÇÔºö8.13.4 ÂçáÁ∫ßÂà∞ 11.3.4 ÔºåÂçáÁ∫ßË∑ØÂæÑ‰∏∫ 8.13.4 -&gt; 8.17.7 -&gt; 9.5.10 -&gt; 10.8.7 -&gt; 11.3.4 ‚Äã Âç≥Ôºö8.17.7ÊòØÁâàÊú¨8‰∏≠ÁöÑÊúÄÂêé‰∏Ä‰∏™ÁâàÊú¨, 9.5.10ÊòØÁâàÊú¨9‰∏≠ÁöÑÊúÄÂêé‰∏Ä‰∏™ÁâàÊú¨, 10.8.7ÊòØÁâàÊú¨10‰∏≠ÁöÑÊúÄÂêé‰∏Ä‰∏™ÁâàÊú¨ ÂçáÁ∫ßÊìç‰ΩúÊú¨Ê¨°ÂçáÁ∫ßÁâàÊú¨‰∏∫ 10.7.0 ÔºåÂçáÁ∫ßÂà∞ÊúÄÊñ∞ÁâàÊú¨ 11.9.8 ÔºåÊ≥®Ôºö2019Âπ¥04Êúà16Êó• 1„ÄÅ‰∏ãËΩΩ10.8.7ÁâàÊú¨ÁöÑrpmÂåÖ1wget https://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el7/gitlab-ce-10.8.7-ce.0.el7.x86_64.rpm 2„ÄÅÂÆâË£ÖÂçáÁ∫ßÂà∞10.8.7ÁâàÊú¨1rpm -Uvh gitlab-ce-10.8.7-ce.0.el7.x86_64.rpm 3„ÄÅÂÜçÂçáÁ∫ßÂà∞11.9.8ÁâàÊú¨1yum install gitlab-ce.x86_64 ËøÅÁßªÂ§á‰ªΩÊ∫êGitLabÊï∞ÊçÆ12345gitlab-rake gitlab:backup:create RAILS_ENV=production# Creating backup archive: 1555983152_2019_04_23_11.9.8_gitlab_backup.tar ...# Êï∞ÊçÆ‰øùÂ≠òÂú® /var/opt/gitlab/backupsÔºåËá™Âä®ÁîüÊàêÊñá‰ª∂ÂêçÔºåÊØîÂ¶ÇÊú¨Ê¨°ÁöÑ 1555983152_2019_04_23_11.9.8_gitlab_backup.tar SCPËøÅÁßªÊï∞ÊçÆ12#ÊåâÈúÄÊõøÊç¢ÁõÆÊ†áÂú∞ÂùÄscp /var/opt/gitlab/backups/1555983152_2019_04_23_11.9.8_gitlab_backup.tar root@1.1.1.1:/root/var/opt/gitlab/backups ÂÆâË£ÖGitLabËØ∑ÂèÇËÄÉ ÂÆâË£Ö Á´†ËäÇ ÊÅ¢Â§çÊï∞ÊçÆ12gitlab-rake gitlab:backup:restore RAILS_ENV=production BACKUP=1555983152_2019_04_23_11.9.8# BACKUPÁöÑÊó∂Èó¥ÁÇπÂøÖÈ°ª‰∏éÂéüÊúçÂä°Âô®Â§á‰ªΩÂêéÁöÑÊñá‰ª∂Âêç‰∏ÄËá¥ Áª¥Êä§ÂÆöÊúüÂ§á‰ªΩ1234crontab -l0 14 * * * /usr/bin/gitlab-rake gitlab:backup:create0 15 * * * find /var/opt/gitlab/backups/* -type f -mtime +3 -exec rm &#123;&#125; \; gitlab-ctlÂëΩ‰ª§123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869[root@iZ2ze4cng635a2k047qus5Z ~]# gitlab-ctl --helpomnibus-ctl: command (subcommand)check-config Check if there are any configuration in gitlab.rb that is removed in specified versiondeploy-page Put up the deploy pagediff-config Compare the user configuration with package available configurationprometheus-upgrade Upgrade the Prometheus data to the latest supported versionremove-accounts Delete *all* users and groups used by this packageupgrade Run migrations after a package upgradeGeneral Commands: cleanse Delete *all* gitlab data, and start from scratch. help Print this help message. reconfigure Reconfigure the application. show-config Show the configuration that would be generated by reconfigure. uninstall Kill all processes and uninstall the process supervisor (data will be preserved).Service Management Commands: graceful-kill Attempt a graceful stop, then SIGKILL the entire process group. hup Send the services a HUP. int Send the services an INT. kill Send the services a KILL. once Start the services if they are down. Do not restart them if they stop. restart Stop the services if they are running, then start them again. service-list List all the services (enabled services appear with a *.) start Start services if they are down, and restart them if they stop. status Show the status of all the services. stop Stop the services, and do not restart them. tail Watch the service logs of all enabled services. term Send the services a TERM. usr1 Send the services a USR1. usr2 Send the services a USR2.Container Registry Commands: registry-garbage-collect Run Container Registry garbage collection.Database Commands: pg-password-md5 Generate MD5 Hash of user password in PostgreSQL format pg-upgrade Upgrade the PostgreSQL DB to the latest supported version revert-pg-upgrade Run this to revert to the previous version of the database set-replication-password Set database replication passwordLet's Encrypt Commands: renew-le-certs Renew the existing Let's Encrypt certificates]]></content>
      <categories>
        <category>GitLab</category>
      </categories>
      <tags>
        <tag>GitLab</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ÂüüÂêçSSLËØÅ‰π¶]]></title>
    <url>%2F2019%2F04%2F16%2F%E5%9F%9F%E5%90%8DSSL%E8%AF%81%E4%B9%A6%2F</url>
    <content type="text"><![CDATA[SSLËØÅ‰π¶ ‰ªÄ‰πàÊòØÊï∞Â≠óËØÅ‰π¶Ôºü Êï∞Â≠óËØÅ‰π¶ÊòØ‰∏Ä‰∏™ÁªèÊùÉÂ®ÅÊéàÊùÉÊú∫ÊûÑÊï∞Â≠óÁ≠æÂêç„ÄÅÂåÖÂê´ÂÖ¨ÂºÄÂØÜÈí•Êã•ÊúâËÄÖ‰ø°ÊÅØ‰ª•ÂèäÂÖ¨ÂºÄÂØÜÈí•ÁöÑÊñá‰ª∂ÔºåÊòØÊùÉÂ®ÅÊú∫ÊûÑÈ¢ÅÂèëÁªôÁΩëÁ´ôÁöÑÂèØ‰ø°Âá≠ËØÅ„ÄÇÊúÄÁÆÄÂçïÁöÑËØÅ‰π¶ÂåÖÂê´‰∏Ä‰∏™ÂÖ¨ÂºÄÂØÜÈí•„ÄÅËØÅ‰π¶ÂêçÁß∞‰ª•ÂèäËØÅ‰π¶ÊéàÊùÉ‰∏≠ÂøÉÁöÑÊï∞Â≠óÁ≠æÂêç„ÄÇ Êï∞Â≠óËØÅ‰π¶ËøòÊúâ‰∏Ä‰∏™ÈáçË¶ÅÁöÑÁâπÂæÅÔºöÂè™Âú®ÁâπÂÆöÁöÑÊó∂Èó¥ÊÆµÂÜÖÊúâÊïà„ÄÇ ‰ªÄ‰πàÊòØSSLÔºü SSLÂçèËÆÆÊòØ‰∏ÄÁßçÂèØÂÆûÁé∞ÁΩëÁªúÈÄö‰ø°Âä†ÂØÜÁöÑÂÆâÂÖ®ÂçèËÆÆÔºåÂèØÂú®ÊµèËßàÂô®ÂíåÁΩëÁ´ô‰πãÈó¥Âª∫Á´ãÂä†ÂØÜÈÄöÈÅìÔºå‰øùÈöúÊï∞ÊçÆÂú®‰º†ËæìÁöÑËøáÁ®ã‰∏≠‰∏çË¢´ÁØ°ÊîπÊàñÁ™ÉÂèñ„ÄÇ ‰ªÄ‰πàÊòØSSLËØÅ‰π¶Ôºü SSLËØÅ‰π¶ÈááÁî®SSLÂçèËÆÆËøõË°åÈÄö‰ø°ÔºåÊòØÁî±ÊùÉÂ®ÅÊú∫ÊûÑÈ¢ÅÂèëÁªôÁΩëÁ´ôÁöÑÂèØ‰ø°Âá≠ËØÅ„ÄÇ SSLËØÅ‰π¶ÈááÁî®SSLÂçèËÆÆËøõË°åÈÄö‰ø°„ÄÇSSLËØÅ‰π¶ÈÉ®ÁΩ≤Âà∞WebÊúçÂä°Âô®ÂêéÔºåWebÊúçÂä°Âô®ËÆøÈóÆÂ∞ÜÂêØÁî®HTTPSÂçèËÆÆ„ÄÇÊÇ®ÁöÑÁΩëÁ´ôÂ∞Ü‰ºöÈÄöËøá HTTPS Âä†ÂØÜÂçèËÆÆÊù•‰º†ËæìÊï∞ÊçÆÔºåÂèØÂ∏ÆÂä©WebÊúçÂä°Âô®ÂíåÁΩëÁ´ôÈó¥Âª∫Á´ãÂèØ‰ø°ÁöÑÂä†ÂØÜÈìæÊé•Ôºå‰ªéËÄå‰øùËØÅÁΩëÁªúÊï∞ÊçÆ‰º†ËæìÁöÑÂÆâÂÖ®„ÄÇ ‰ªÄ‰πàÊòØHTTPSÔºü HTTPSÊòØ‰∏ÄÁßçÂü∫‰∫éSSLÂçèËÆÆÁöÑÁΩëÁ´ôÂä†ÂØÜ‰º†ËæìÂçèËÆÆ„ÄÇ ÁΩëÁ´ôÂÆâË£ÖSSLËØÅ‰π¶ÂêéÔºå‰ΩøÁî®HTTPSÂä†ÂØÜÂçèËÆÆËÆøÈóÆÔºåÂèØÊøÄÊ¥ªÂÆ¢Êà∑Á´ØÊµèËßàÂô®Âà∞ÁΩëÁ´ôÊúçÂä°Âô®‰πãÈó¥ÁöÑSSLÂä†ÂØÜÈÄöÈÅìÔºàSSLÂçèËÆÆÔºâÔºå‰ªéËÄåÂÆûÁé∞È´òÂº∫Â∫¶ÂèåÂêëÂä†ÂØÜ‰º†ËæìÔºåÈò≤Ê≠¢‰º†ËæìÊï∞ÊçÆË¢´Ê≥ÑÈú≤ÊàñÁØ°Êîπ„ÄÇHTTPS ‰πüÂ∞±ÊòØHTTP + SSLÔºåÊòØHTTPÁöÑÂÆâÂÖ®Áâà„ÄÇ ‰ªÄ‰πàÊòØCAËÆ§ËØÅ‰∏≠ÂøÉÔºü CAËÆ§ËØÅ‰∏≠ÂøÉÔºàCAÊú∫ÊûÑÔºâÔºåÂç≥ËØÅ‰π¶ÊéàÊùÉ‰∏≠ÂøÉÔºàCertificate AuthorityÔºâÔºåÊàñÁß∞ËØÅ‰π¶ÊéàÊùÉÊú∫ÊûÑ„ÄÇ CAËÆ§ËØÅ‰∏≠ÂøÉ‰Ωú‰∏∫ÁîµÂ≠êÂïÜÂä°‰∫§Êòì‰∏≠Âèó‰ø°‰ªªÁöÑÁ¨¨‰∏âÊñπÔºåÊâøÊãÖÂÖ¨Èí•‰ΩìÁ≥ª‰∏≠ÂÖ¨Èí•ÂêàÊ≥ïÊÄßÊ£ÄÈ™åÁöÑË¥£‰ªª„ÄÇ SSLËØÅ‰π¶Á±ªÂûãÈÖçÁΩÆË°®ËØÅ‰π¶Ê†πÊçÆ‰∏çÂêåÁöÑÈ™åËØÅÁ∫ßÂà´ÔºåÂàÜ‰∏∫‰ª•‰∏ã‰∏âÁ±ªÔºö ÂüüÂêçÂûãSSLÔºàDV SSLÔºâ ‰ºÅ‰∏öÂûãSSLÔºàOV SSLÔºâ Â¢ûÂº∫ÂûãSSLÔºàEV SSLÔºâ Ê†πÊçÆ‰øùÊä§ÂüüÂêçÁöÑÊï∞ÈáèÈúÄÊ±ÇÔºåSSL ËØÅ‰π¶ÂèàÂàÜ‰∏∫Ôºö ÂçïÂüüÂêçÁâàÔºöÂè™‰øùÊä§‰∏Ä‰∏™ÂüüÂêçÔºå‰æãÂ¶Ç www.abc.com ÊàñËÄÖ login.abc.com ‰πãÁ±ªÁöÑÂçï‰∏™ÂüüÂêç Â§öÂüüÂêçÁâàÔºö‰∏ÄÂº†ËØÅ‰π¶ÂèØ‰ª•‰øùÊä§Â§ö‰∏™ÂüüÂêçÔºå‰æãÂ¶ÇÂêåÊó∂‰øùÊä§ www.abc.com , www.bcd.com, pay.efg.com Á≠â ÈÄöÈÖçÁ¨¶ÁâàÔºö‰∏ÄÂº†ËØÅ‰π¶‰øùÊä§Âêå‰∏Ä‰∏™‰∏ªÂüüÂêç‰∏ãÂêå‰∏ÄÁ∫ßÁöÑÊâÄÊúâÂ≠êÂüüÂêçÔºå‰∏çÈôê‰∏™Êï∞ÔºåÂΩ¢Â¶Ç *.abc.com „ÄÇÊ≥®ÊÑèÔºåÈÄöÈÖçÁ¨¶ÁâàÂè™Êúâ DVSSL Âíå OVSSL ÂÖ∑ÊúâÔºå EVSSL ‰∏çÂÖ∑ÊúâÈÄöÈÖçÁ¨¶ÁâàÊú¨„ÄÇ ËØÅ‰π¶ÂìÅÁâå ËØÅ‰π¶Á±ªÂûã ‰øùÊä§ÂüüÂêçÁöÑÁ±ªÂûã ËØ¥Êòé GeoTrust ‰∏ì‰∏öÁâàOV SSL 1‰∏™Â∏¶ÈÄöÈÖçÁ¨¶ÁöÑÂüüÂêç1‰∏™ÊòéÁªÜÂüüÂêçÂ§ö‰∏™ÊòéÁªÜÂüüÂêç Êèê‰æõÂä†ÂØÜÂäüËÉΩÔºåÂØπÁî≥ËØ∑ËÄÖÁöÑË∫´‰ªΩËøõË°å‰∏•Ê†ºÁöÑÂÆ°Ê†∏È™åËØÅÔºåÂèØÊèê‰æõÂèØ‰ø°Ë∫´‰ªΩËØÅÊòé„ÄÇÂ§ö‰∏™ÂüüÂêç‰æã‰∏äÈôê‰∏∫300‰∏™„ÄÇÂ¶Ç: buy1.example.com, buy2.example.com, next.buy.example2.com, ‰∏äËø∞3‰∏™ÊòéÁªÜÂ≠êÂüüÂêçËÆ°ÁÆó‰∏∫3‰∏™ÂüüÂêç„ÄÇ È´òÁ∫ßÁâàEV SSL 1‰∏™ÂüüÂêçÂ§ö‰∏™ÂüüÂêç Êèê‰æõÂä†ÂØÜÂäüËÉΩÔºåÂØπÁî≥ËØ∑ËÄÖÂÅöÊúÄ‰∏•Ê†ºÁöÑË∫´‰ªΩÂÆ°Ê†∏È™åËØÅÔºåÊèê‰æõÊúÄÈ´òÂ∫¶ÂèØ‰ø°Ë∫´‰ªΩËØÅÊòéÔºåÊèê‰æõÊµèËßàÂô®ÁªøËâ≤Âú∞ÂùÄÊ†è„ÄÇ GlobalSign ‰∏ì‰∏öÁâàOV SSL ÈÄöÈÖçÁ¨¶ÂüüÂêç Êèê‰æõÂä†ÂØÜÂäüËÉΩÔºåÂØπÁî≥ËØ∑ËÄÖËøõË°å‰∏•Ê†ºÁöÑË∫´‰ªΩÂÆ°Ê†∏È™åËØÅÔºåÊèê‰æõÂèØ‰ø°Ë∫´‰ªΩËØÅÊòé„ÄÇ CFCA ‰∏ì‰∏öÁâàOV SSL ÈÄöÈÖçÁ¨¶ÂüüÂêç1‰∏™ÂüüÂêçÂ§ö‰∏™ÂüüÂêç Êèê‰æõÂä†ÂØÜÂäüËÉΩÔºåÂØπÁî≥ËØ∑ËÄÖËøõË°å‰∏•Ê†ºÁöÑË∫´‰ªΩÂÆ°Ê†∏È™åËØÅÔºåÊèê‰æõÂèØ‰ø°Ë∫´‰ªΩËØÅÊòé„ÄÇ È´òÁ∫ßÁâàEV SSL 1‰∏™ÂüüÂêçÂ§ö‰∏™ÂüüÂêç Êèê‰æõÂä†ÂØÜÂäüËÉΩÔºåÂØπÁî≥ËØ∑ËÄÖÂÅöÊúÄ‰∏•Ê†ºÁöÑË∫´‰ªΩÂÆ°Ê†∏È™åËØÅÔºåÊèê‰æõÊúÄÈ´òÂ∫¶ÂèØ‰ø°Ë∫´‰ªΩËØÅÊòéÔºåÊèê‰æõÊµèËßàÂô®ÁªøËâ≤Âú∞ÂùÄÊ†è„ÄÇ Symantec ‰∏ì‰∏öÁâàOV SSL ÈÄöÈÖçÁ¨¶ÂüüÂêç1‰∏™ÂüüÂêçÂ§ö‰∏™ÂüüÂêç Êèê‰æõÂä†ÂØÜÂäüËÉΩÔºåÂØπÁî≥ËØ∑ËÄÖËøõË°å‰∏•Ê†ºÁöÑË∫´‰ªΩÂÆ°Ê†∏È™åËØÅÔºåÊèê‰æõÂèØ‰ø°Ë∫´‰ªΩËØÅÊòé„ÄÇ ÈÄöÈÖçÁ¨¶DV SSL ÈÄöÈÖçÁ¨¶ÂüüÂêç Â¢ûÂº∫ÂûãOV SSL 1‰∏™ÂüüÂêçÂ§ö‰∏™ÂüüÂêç Êèê‰æõÁ´ôÁÇπÂä†ÂØÜÂäüËÉΩÔºåÈúÄË¶ÅÊ†∏È™åÁªÑÁªáÊ≥®ÂÜå‰ø°ÊÅØÔºåËØÅ‰π¶‰∏≠‰ºöÊòæÁ§∫ÁªÑÁªáÂêçÁß∞„ÄÇÁªÑÁªá‰ø°ÊÅØÈ™åËØÅÈÄöËøáÂêéÔºå3‰∏™Â∑•‰ΩúÊó•ÂÜÖÈ¢ÅÂèëËØÅ‰π¶„ÄÇ È´òÁ∫ßÁâàEV SSL 1‰∏™ÂüüÂêçÂ§ö‰∏™ÂüüÂêç Êèê‰æõÂä†ÂØÜÂäüËÉΩÔºåÂØπÁî≥ËØ∑ËÄÖÂÅöÊúÄ‰∏•Ê†ºÁöÑË∫´‰ªΩÂÆ°Ê†∏È™åËØÅÔºåÊèê‰æõÊúÄÈ´òÂ∫¶ÂèØ‰ø°Ë∫´‰ªΩËØÅÊòéÔºåÊèê‰æõÊµèËßàÂô®ÁªøËâ≤Âú∞ÂùÄÊ†è„ÄÇ Â¢ûÂº∫ÂûãEV SSL 1‰∏™ÂüüÂêçÂ§ö‰∏™ÂüüÂêç Â¢ûÂº∫ÂûãEV SSLÊèê‰æõÁ´ôÁÇπÂä†ÂØÜÂäüËÉΩÔºåÊµèËßàÂô®ÁªøËâ≤Âú∞ÂùÄÊ†èÊòæÁ§∫ÁªÑÁªá‰ø°ÊÅØÂº∫Âåñ‰ø°‰ªª„ÄÇÁªÑÁªá‰ø°ÊÅØÈ™åËØÅÈÄöËøáÂêé7‰∏™Â∑•‰ΩúÊó•ÂÜÖÈ¢ÅÂèëËØÅ‰π¶„ÄÇ ÂÖçË¥πÂûãDV SSL 1‰∏™ÂüüÂêç ÂÖçË¥πÊñ∞Ê†πËØÅ‰π¶ÔºåÂàáÂÖ•DigiCert PKI‰ΩìÁ≥ªÔºåÂÖºÂÆπÊÄßÊìç‰ΩúÁ≥ªÁªüÁâàÊú¨IOS 5.0+„ÄÅAndroid 2.3.3+„ÄÅJRE 1.6.5+„ÄÅWIN 7+„ÄÇÊúÄÂ§ö‰øùÊä§‰∏Ä‰∏™ÊòéÁªÜÂ≠êÂüüÂêçÔºå‰∏çÊîØÊåÅÈÄöÈÖçÁ¨¶Ôºå‰∏Ä‰∏™ÈòøÈáå‰∫ëÂ∏êÊà∑ÊúÄÂ§öÁ≠æÂèë20Âº†ÂÖçË¥πËØÅ‰π¶„ÄÇ SSLËØÅ‰π¶Ë¥≠‰π∞ÁôªÂΩïÈòøÈáå‰∫ëÊéßÂà∂Âè∞ÔºåËøõÂÖ•SSLËØÅ‰π¶ÊúçÂä°„ÄÇ SSLËØÅ‰π¶Êõ¥Êñ∞ÂÖ¨Âè∏ÂüüÂêçSSLËØÅ‰π¶Âç≥Â∞ÜÂà∞ÊúüÔºåÊõøÊç¢SSLËØÅ‰π¶ÈúÄÁü•ÈÅìÂì™‰∫õ‰∫åÁ∫ßÂüüÂêç‰ΩøÁî®‰∫ÜHTTPSËÆøÈóÆÔºåÂπ∂‰∏îËé∑ÂèñSSLËØÅ‰π¶ËøáÊúüÊó∂Èó¥ÔºåÊù•È™åËØÅËØÅ‰π¶ÊòØÂê¶Êõ¥Êñ∞„ÄÇ Ëé∑ÂèñÂüüÂêç‰∏ãÁöÑËß£Êûê‰ø°ÊÅØÁôªÂΩïÂüüÂêçÊúçÂä°ÂïÜÊéßÂà∂Êù°‚Äî‰∫ëËß£Êûê‚ÄîÂüüÂêçËß£ÊûêÂàóË°®‚ÄîÂØºÂá∫Ëß£ÊûêËÆ∞ÂΩï Â∞Ü‰∫åÁ∫ßÂüüÂêçÁöÑËÆ∞ÂΩïÂÜôÂÖ•domains.txtÊñá‰ª∂Â§áÁî® ÁºñÂÜôËÑöÊú¨1234567891011#!/bin/bashfor domain in `cat domains.txt` #ËØªÂèñÂ≠òÂÇ®‰∫ÜÈúÄË¶ÅÁõëÊµãÁöÑÂüüÂêçÁöÑÊñá‰ª∂do curl $domain.vcg.com:443 1&gt;/dev/null 2&gt;/dev/null --connect-timeout 3 if [[ $? -eq 0 ]]; then END_TIME=$(echo | openssl s_client -servername $domain.vcg.com -connect $domain.vcg.com:443 2&gt;/dev/null | openssl x509 -noout -dates |grep 'After'| awk -F '=' '&#123;print $2&#125;'| awk -F ' +' '&#123;print $1,$2,$4 &#125;' ) echo "$domain.vcg.com ÁöÑSSLËØÅ‰π¶Âà∞ÊúüÊó∂Èó¥‰∏∫ $END_TIME " &gt;&gt; result1.txt else echo "$domain.vcg.com Ê≤°https " &gt;&gt; result1.txt fidone Ê†πÊçÆËæìÂá∫Êñá‰ª∂Êü•ÁúãSSLËØÅ‰π¶ËøáÊúüÊó∂Èó¥ÔºåËøõË°åËØÅ‰π¶ÊõøÊç¢Â∑•‰ΩúSSLËØÅ‰π¶Êõ¥Êñ∞ÁöÑÈÖçÁΩÆË∑ØÂæÑ ÈòøÈáå‰∫ëOSS-ÂØπË±°Â≠òÂÇ® ÈòøÈáå‰∫ëWAF-WebÈò≤ÁÅ´Â¢ô ÈòøÈáå‰∫ëSLB-Ë¥üËΩΩÂùáË°° Nginx #####]]></content>
      <categories>
        <category>Linux</category>
        <category>SSLËØÅ‰π¶</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>SSLËØÅ‰π¶</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Êö¥ÂäõÁ†¥Ëß£ÊîªÂáªÂíåÈò≤Âæ°]]></title>
    <url>%2F2019%2F04%2F16%2F%E6%9A%B4%E5%8A%9B%E7%A0%B4%E8%A7%A3%E6%94%BB%E5%87%BB%E5%92%8C%E9%98%B2%E5%BE%A1%2F</url>
    <content type="text"><![CDATA[ÂºïÁî®Ëá™ÈòøÈáå‰∫ëhttps://help.aliyun.com/knowledge_detail/56269.html ‰ªÄ‰πàÊòØÊö¥ÂäõÁ†¥Ëß£ÊîªÂáªÊö¥ÂäõÁ†¥Ëß£ÊîªÂáªÊòØÊåáÊîªÂáªËÄÖÈÄöËøáÁ≥ªÁªüÂú∞ÁªÑÂêàÂπ∂Â∞ùËØïÊâÄÊúâÁöÑÂèØËÉΩÊÄß‰ª•Á†¥Ëß£Áî®Êà∑ÁöÑÁî®Êà∑Âêç„ÄÅÂØÜÁ†ÅÁ≠âÊïèÊÑü‰ø°ÊÅØ„ÄÇÊîªÂáªËÄÖÂæÄÂæÄÂÄüÂä©Ëá™Âä®ÂåñËÑöÊú¨Â∑•ÂÖ∑Êù•ÂèëÂä®Êö¥ÂäõÁ†¥Ëß£ÊîªÂáª„ÄÇ ÊîªÂáªË°å‰∏∫Á±ªÂûãÊ†πÊçÆÊö¥ÂäõÁ†¥Ëß£ÁöÑÁ©∑‰∏æÊñπÂºèÔºåÂÖ∂ÊîªÂáªË°å‰∏∫ÂèØ‰ª•ÂàÜ‰∏∫Ôºö Â≠óÂÖ∏ÊîªÂáªÊ≥ï„ÄÇÂ§ßÂ§öÊîªÂáªËÄÖÂπ∂Ê≤°ÊúâÈ´òÊÄßËÉΩÁöÑÁ†¥Ëß£ÁÆóÊ≥ïÂíåCPU/GPUÔºå‰∏∫ËäÇÁúÅÊó∂Èó¥ÂíåÊèêÈ´òÊïàÁéáÔºå‰ºöÂà©Áî®Á§æ‰ºöÂ∑•Á®ãÂ≠¶ÊàñÂÖ∂ÂÆÉÊñπÂºèÂª∫Á´ãÁ†¥ËØëÂ≠óÂÖ∏Ôºå‰ΩøÁî®Â≠óÂÖ∏‰∏≠Â∑≤Â≠òÂú®ÁöÑÁî®Êà∑Âêç„ÄÅÂØÜÁ†ÅËøõË°åÁåúÁ†¥„ÄÇ Á©∑‰∏æÊ≥ï„ÄÇÊîªÂáªËÄÖÈ¶ñÂÖàÂàóÂá∫ÂØÜÁ†ÅÁªÑÂêàÁöÑÂèØËÉΩÊÄßÔºàÂ¶ÇÊï∞Â≠ó„ÄÅÂ§ßÂÜôÂ≠óÊØç„ÄÅÂ∞èÂÜôÂ≠óÊØç„ÄÅÁâπÊÆäÂ≠óÁ¨¶Á≠âÔºâÔºåÁÑ∂ÂêéÊåâÂØÜÁ†ÅÈïøÂ∫¶‰ªé1‰Ωç„ÄÅ2‰Ωç‚Ä¶.ÊûÑÊàê‰∏çÂêåÁöÑË¥¶Âè∑ÂíåÂØÜÁ†ÅÂØπÔºåÁÑ∂ÂêéÈÄê‰∏™ÁåúËØï„ÄÇËØ•ÊñπÊ≥ïÈúÄË¶ÅÈ´òÊÄßËÉΩÁöÑÁ†¥Ëß£ÁÆóÊ≥ïÂíåCPU/GPU‰ΩúÊîØÊåÅ„ÄÇ ÁªÑÂêàÂºèÊîªÂáªÊ≥ï„ÄÇ‰ΩøÁî®Â≠óÂÖ∏ÊîªÂáªÂíåÁ©∑‰∏æÊ≥ïÁöÑÁªÑÂêàÊîªÂáªÊñπÂºè„ÄÇ ÁêÜËÆ∫‰∏äÔºåÂè™Ë¶ÅÊã•ÊúâÊÄßËÉΩË∂≥Â§üÂº∫ÁöÑËÆ°ÁÆóÊú∫ÂíåË∂≥Â§üÈïøÁöÑÊó∂Èó¥ÔºåÂ§ßÂ§öÂØÜÁ†ÅÂùáÂèØ‰ª•Ë¢´Á†¥Ëß£Âá∫Êù•„ÄÇ ÊîªÂáª‰∏öÂä°Á±ªÂûã ÈíàÂØπWindowsÊìç‰ΩúÁ≥ªÁªüÁöÑËøúÁ®ãÊ°åÈù¢ÁÆ°ÁêÜÂçèËÆÆÔºàRDPÔºâ„ÄÅLinuxÊìç‰ΩúÁ≥ªÁªüÁöÑÁÆ°ÁêÜÂçèËÆÆÔºàSSHÔºâÁöÑÊö¥ÂäõÁ†¥Ëß£ÊîªÂáª ÈíàÂØπÂÖ∑ÊúâÁôªÂΩïËÆ§ËØÅÊú∫Âà∂ÁöÑËΩØ‰ª∂ÊúçÂä°ÔºàÂ¶ÇMysql„ÄÅSQLserver„ÄÅFTP„ÄÅWebÂâçÂêéÁ´ØÁôªÂΩïÊé•Âè£Á≠âÂ∫îÁî®ÊúçÂä°ÔºâÁöÑÊö¥ÂäõÁ†¥Ëß£ÊîªÂáª ÂØπ‰∫éÈò≤Âæ°ËÄÖËÄåË®ÄÔºåÁªôÊîªÂáªËÄÖÁïôÂæóÊó∂Èó¥Ë∂äÈïøÔºåÂÖ∂ÁªÑÂêàÂá∫Ê≠£Á°ÆÁöÑÁî®Êà∑ÂêçÂíåÂØÜÁ†ÅÁöÑÂèØËÉΩÊÄßÂ∞±Ë∂äÂ§ß„ÄÇÂõ†Ê≠§ÔºåÊó∂Èó¥Âú®Ê£ÄÊµãÊö¥ÂäõÁ†¥Ëß£ÊîªÂáªÊó∂ÂæàÈáçË¶Å„ÄÇ Êö¥ÂäõÁ†¥Ëß£ÊîªÂáªÊúâ‰ªÄ‰πàÂç±ÂÆ≥ÈÄöËøáËá™Âä®ÂåñÂ∑•ÂÖ∑ÂèëËµ∑ÁöÑÊö¥ÂäõÁ†¥Ëß£ÊîªÂáªÂèØ‰ª•Ëé∑ÂèñÁî®Êà∑Ë¥¶Âè∑ÂíåÂØÜÁ†Å„ÄÇ Â¶Ç‰ΩïÈò≤Âæ°Êö¥ÂäõÁ†¥Ëß£ÊîªÂáª Âà∂ÂÆöÂØÜÁ†ÅÂ§çÊùÇÂ∫¶Á≠ñÁï•ÔºåÂπ∂ËøõË°åÊúçÂä°Âä†Âõ∫„ÄÇÂØÜÁ†ÅÁöÑÈïøÂ∫¶Ë¶ÅÂ§ß‰∫é 8 ‰ΩçÔºå‰∏îÊúÄÂ•ΩÂ§ß‰∫é 20 ‰ΩçÔºõÂØÜÁ†ÅÂ∫îÁî±Êï∞Â≠ó„ÄÅÂ§ßÂ∞èÂÜôÂ≠óÊØçÂíåÁâπÊÆäÁ¨¶Âè∑Ê∑∑ÂêàÁªÑÊàêÔºõÂØÜÁ†ÅÁöÑÊúÄÈïøÊúâÊïàÊúü‰∏∫ 90 Â§©„ÄÇ ÈÖçÁΩÆÂ•ΩÁΩëÁªúËÆøÈóÆÊéßÂà∂„ÄÇ‰∏•Ê†ºÈôêÂà∂Â∞ÜÈ´òÂç±ÊúçÂä°ÁÆ°ÁêÜÁ´ØÂè£Áõ¥Êé•ÂèëÂ∏ÉÂà∞‰∫íËÅîÁΩëÔºõÂª∫ËÆÆÊÇ®‰ΩøÁî® VPN ÂíåÂ†°ÂûíÊú∫ÁöÑÊñπÂºèÈõÜ‰∏≠ÁÆ°ÁêÜÂíåÂÆ°ËÆ°„ÄÇ ÊèêÈ´òÂÜÖÈÉ®ÂÖ®ÂëòÂÆâÂÖ®ÊÑèËØÜÔºåÁ¶ÅÊ≠¢ÂÄüÁî®ÊàñÂÖ±‰∫´‰ΩøÁî®Ë¥¶Âè∑„ÄÇ]]></content>
      <categories>
        <category>Linux</category>
        <category>ÂÆâÂÖ®</category>
      </categories>
      <tags>
        <tag>ÂÆâÂÖ®</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ElasticsearchÊúçÂä°ÂÆâÂÖ®Âä†Âõ∫]]></title>
    <url>%2F2019%2F04%2F16%2FElasticsearch%E6%9C%8D%E5%8A%A1%E5%AE%89%E5%85%A8%E5%8A%A0%E5%9B%BA%2F</url>
    <content type="text"><![CDATA[ÂºïÁî®Ëá™ÈòøÈáå‰∫ëhttps://help.aliyun.com/knowledge_detail/49913.html&gt; Elasticsearch ÊòØ‰∏Ä‰∏™Âü∫‰∫é Lucene ÁöÑÊêúÁ¥¢ÊúçÂä°ÔºåÂÆÉÊèê‰æõ‰∫Ü RESTful web Êé•Âè£ÁöÑÂàÜÂ∏ÉÂºè„ÄÅÂ§öÁî®Êà∑ÂÖ®ÊñáÊêúÁ¥¢ÂºïÊìé „ÄÇElasticsearch ÊòØÁî® Java ÂºÄÂèëÁöÑÔºåÂπ∂‰Ωú‰∏∫ Apache ËÆ∏ÂèØÊù°Ê¨æ‰∏ãÁöÑÂºÄÊîæÊ∫êÁ†ÅÂèëÂ∏ÉÔºåÊòØÁ¨¨‰∫åÂ§ßÊúÄÊµÅË°åÁöÑ‰ºÅ‰∏öÊêúÁ¥¢ÂºïÊìé„ÄÇ Elasticsearch Â∫îÁî®‰∫é‰∫ëËÆ°ÁÆó‰∏≠ÔºåÂÖ∑ÊúâÂÆûÊó∂ÊêúÁ¥¢„ÄÅÁ®≥ÂÆö„ÄÅÂèØÈù†„ÄÅÂø´ÈÄü„ÄÅÂÆâË£Ö‰ΩøÁî®Êñπ‰æøÁ≠â‰ºòÂäøÔºõ‰ΩÜ‰πüÂ≠òÂú®‰∏Ä‰∫õÂÆâÂÖ®ÈöêÊÇ£ÔºöÈªòËÆ§ÂÆâË£ÖÂÆåÊàêÂêéÔºåElasticsearch ÂèØ‰ª•‰ΩøÁî® 9200 Á´ØÂè£ÈÄöÂëä web ÁöÑÊñπÂºèËÆøÈóÆÊü•ÁúãÊï∞ÊçÆ‰ø°ÊÅØ„ÄÇ ÊºèÊ¥ûËØ¶ÊÉÖElasticsearch ‰∏≠Â≠òÂú®‰ª•‰∏ãÈ´òÂç±ÊºèÊ¥û„ÄÇ Á±ªÂûã CVE ÂèóÂΩ±ÂìçÁâàÊú¨ ÊèèËø∞ ËøúÁ®ãÂëΩ‰ª§ÊâßË°å CVE-2014-3120 - Elasticsearch ÁöÑËÑöÊú¨ÊâßË°å (scripting) ÂäüËÉΩÔºåÂèØ‰ª•ÂæàÊñπ‰æøÂú∞ÂØπÊü•ËØ¢Âá∫Êù•ÁöÑÊï∞ÊçÆËøõË°åÂÜçÂä†Â∑•Â§ÑÁêÜ„ÄÇ‰ΩÜÊòØÔºåÂÖ∂‰ΩøÁî®ÁöÑ MVEL ËÑöÊú¨ÂºïÊìéÊ≤°ÊúâÂÅöËøá‰ªª‰ΩïÈò≤Êä§ÔºàÊàñËÄÖÊ≤ôÁõíÂåÖË£ÖÔºâÔºåÂèØ‰ª•Áõ¥Êé•ÊâßË°å‰ªªÊÑè‰ª£Á†Å„ÄÇ ËøúÁ®ã‰ª£Á†ÅÊâßË°å - 1.3.0-1.3.7Ôºå1.4.0-1.4 Elasticsearch ‰ΩøÁî® Groovy ‰Ωú‰∏∫ËÑöÊú¨ËØ≠Ë®ÄÔºåËôΩÁÑ∂Âä†ÂÖ•‰∫ÜÊ≤ôÁõíËøõË°åÊéßÂà∂ÔºåÂç±Èô©ÁöÑ‰ª£Á†Å‰ºöË¢´Êã¶Êà™„ÄÇ‰ΩÜÊòØÁî±‰∫éÊ≤ôÁõíÈôêÂà∂‰∏ç‰∏•Ê†ºÔºå‰ªÖÈÄöËøáÈªëÁôΩÂêçÂçïÊù•Âà§Êñ≠ÔºåÂØºËá¥ÊîªÂáªËÄÖÂèØ‰ª•ÁªïËøáÊ≤ôÁõíÔºåÊâßË°åËøúÁ®ã‰ª£Á†Å„ÄÇ Êú™ÊéàÊùÉËÆøÈóÆ - - Elasticsearch Âú®ÂÆâË£Ö‰∫Ü River Êú∫Âà∂‰πãÂêéÂèØ‰ª•ÂêåÊ≠•Â§öÁßçÊï∞ÊçÆÂ∫ìÊï∞ÊçÆÔºàÂåÖÊã¨ÂÖ≥Á≥ªÂûãÁöÑMySQL„ÄÅMongoDB Á≠âÔºâ„ÄÇÂ¶ÇÊûú http://localhost:9200/cat/indices‰∏≠ indices ÂåÖÂê´‰∫Ü _riverÔºåÂàô‰ª£Ë°® Elasticsearch Â∑≤ÂÆâË£Ö River Êú∫Âà∂„ÄÇËÄåÈÄöËøáÊ≥ÑÈú≤ÁöÑ http://localhost:9200/_rvier/_search URL Âú∞ÂùÄÔºåÊîªÂáªËÄÖÂèØ‰ª•Ëé∑ÂèñÂà∞ÊïèÊÑü‰ø°ÊÅØ„ÄÇ ÊºèÊ¥ûÊàêÂõ†‰∏éÂç±ÂÆ≥Áî±‰∫é Elasticsearch ÁöÑ HTTP ËøûÊé•Ê≤°ÊúâÊèê‰æõ‰ªª‰ΩïÁöÑÊùÉÈôêÊéßÂà∂Êé™ÊñΩÔºå‰∏ÄÊó¶ÈÉ®ÁΩ≤Âú®ÂÖ¨ÂÖ±ÁΩëÁªúÂ∞±ÂÆπÊòìÊúâÊï∞ÊçÆÊ≥ÑÈú≤ÁöÑÈ£éÈô©„ÄÇ ÂÆâÂÖ®Âä†Âõ∫ÊñπÊ°à‰ΩøÁî®ÊúÄÊñ∞ÁöÑ Elasticsearch ÁâàÊú¨ÈÄöËøáÊ≠£ËßÑÊ∏†ÈÅìÔºàÂ¶Ç Elastic ÂÆòÁΩëÔºâ‰∏ãËΩΩ Elasticsearch ÁöÑÊúÄÊñ∞ÁâàÊú¨„ÄÇ ‰∏ãËΩΩÂÆåÊàêÂêéÔºåÂ∞Ü‰∏ãËΩΩÊñá‰ª∂ÁöÑ sha1 ÂÄºÂíå‰∏ãËΩΩÊó∂ÂÆòÁΩëÈ°µÈù¢Êèê‰æõÁöÑ sha1 ÂÄºËøõË°åÂØπÊØîÔºåÈÅøÂÖç‰∏ãËΩΩËøáÁ®ã‰∏≠Ë¢´ÊÅ∂ÊÑèÊîªÂáªËÄÖÊã¶Êà™Á†¥ÂùèÊñá‰ª∂ÔºåÁîöËá≥Ê≥®ÂÖ•ÊÅ∂ÊÑè‰ª£Á†Å„ÄÇ ‰∏çË¶ÅÈöè‰æøÂÆâË£ÖÁ¨¨‰∏âÊñπÁöÑÊèí‰ª∂ÔºåÊèí‰ª∂ÊúâÂèØËÉΩÂºïÂÖ•ÂÆâÂÖ®ÊºèÊ¥ûÁîöËá≥Êú¨Ë∫´Ëá™Â∏¶ÂêéÈó®ÔºåÈúÄË∞®ÊÖé‰ΩøÁî®„ÄÇ ÂÖ≥Ê≥® Elastic ÁΩëÁ´ôÔºåÂèäÊó∂Êõ¥Êñ∞ Elasticsearch Ëá≥ÊúÄÊñ∞ÁâàÊú¨„ÄÇElasticsearch ÊØèÊ¨°ÁâàÊú¨ÂèëÂ∏ÉÈÉΩ‰ºö‰ºòÂåñÂíåÊîπËøõ‰∏ÄÈÉ®ÂàÜÂäüËÉΩÔºåÂ∞§ÂÖ∂ÊòØÂÆâÂÖ®ÊºèÊ¥ûÁöÑË°•‰∏Å„ÄÇÂêåÊó∂Ôºå‰ªîÁªÜÈòÖËØª Elasticsearch ÁöÑÁâàÊú¨Êõ¥Êñ∞ËÆ∞ÂΩï„ÄÇ Ê≥®ÊÑèÔºöÊõ¥Êñ∞ÂçáÁ∫ßÂâçÔºåÂª∫ËÆÆÊÇ®ÂÖàËøõË°åÂø´ÁÖßÂ§á‰ªΩÔºåÂèäÊú¨Âú∞ÊµãËØï„ÄÇ ÔºàÊé®ËçêÔºâÁΩëÁªúËÆøÈóÆÊéßÂà∂Elasticsearch ÈªòËÆ§Á´ØÂè£ÊòØ 9200„ÄÇ ‰∏çË¶ÅÊää Elasticsearch ÁöÑ 9200 Á´ØÂè£ÊúçÂä°ÂèëÂ∏ÉÂà∞‰∫íËÅîÁΩë‰∏ä„ÄÇ ‰ΩøÁî® ÈòøÈáå‰∫ëÂÆâÂÖ®ÁªÑÈò≤ÁÅ´Â¢ô ÊàñÊú¨Âú∞Êìç‰ΩúÁ≥ªÁªüÈò≤ÁÅ´Â¢ôÂØπËÆøÈóÆÊ∫ê IP ËøõË°åÈöîÁ¶ªÊéßÂà∂„ÄÇ ÁªëÂÆöËÆøÈóÆÊ∫ê IPËøõÂÖ• config ÁõÆÂΩïÔºå‰øÆÊîπ elasticsearch.yml ÈÖçÁΩÆÊñá‰ª∂‰∏≠‰ª•‰∏ãÂèÇÊï∞Ôºö 123456network.bind_host: 192.168.0.1# ËÆæÁΩÆÁªëÂÆöÁöÑ IP Âú∞ÂùÄÔºåÂèØ‰ª•ÊòØ IPv4 Êàñ IPv6 Âú∞ÂùÄÔºåÈªòËÆ§‰∏∫ 0.0.0.0„ÄÇnetwork.publish_host: 192.168.0.1# ËÆæÁΩÆÂÖ∂ÂÆÉËäÇÁÇπÂíåËØ•ËäÇÁÇπ‰∫§‰∫íÁöÑ IP Âú∞ÂùÄÔºåÂ¶ÇÊûú‰∏çËÆæÁΩÆÂÆÉ‰ºöËá™Âä®Âà§Êñ≠ÔºåÂÄºÂøÖÈ°ªÊòØ‰∏™ÁúüÂÆûÁöÑ IP Âú∞ÂùÄ„ÄÇnetwork.host: 192.168.0.1# ÂêåÊó∂ËÆæÁΩÆ‰∏äËø∞‰∏§‰∏™ÂèÇÊï∞Ôºöbind_host Âíå publish_host„ÄÇ ‰øÆÊîπÈªòËÆ§Á´ØÂè£ËøõÂÖ• config ÁõÆÂΩïÔºå‰øÆÊîπ elasticsearch.yml ÈÖçÁΩÆÊñá‰ª∂‰∏≠‰ª•‰∏ãÂèÇÊï∞Ôºö 123456ransport.tcp.port: 9300# ËÆæÁΩÆËäÇÁÇπÈó¥‰∫§‰∫íÁöÑ TCP Á´ØÂè£ÔºåÈªòËÆ§ÊòØ 9300„ÄÇtransport.tcp.compress: true# ËÆæÁΩÆÊòØÂê¶ÂéãÁº© TCP ‰º†ËæìÊó∂ÁöÑÊï∞ÊçÆÔºåÈªòËÆ§‰∏∫ falseÔºåÂç≥‰∏çÂéãÁº©„ÄÇhttp.port: 9200# ËÆæÁΩÆÂØπÂ§ñÊúçÂä°ÁöÑ HTTP Á´ØÂè£ÔºåÈªòËÆ§‰∏∫ 9200„ÄÇ ÂÖ≥Èó≠ HTTP ËÆøÈóÆËøõÂÖ• config ÁõÆÂΩïÔºå‰øÆÊîπ elasticsearch.yml ÈÖçÁΩÆÊñá‰ª∂‰∏≠‰ª•‰∏ãÂèÇÊï∞Ôºö 12http.enabled: false# ÊòØÂê¶‰ΩøÁî® HTTP ÂçèËÆÆÂØπÂ§ñÊèê‰æõÊúçÂä°ÔºåÈªòËÆ§‰∏∫ trueÔºåÂç≥ÂºÄÂêØ„ÄÇ ‰ΩøÁî® Shield ÂÆâÂÖ®Êèí‰ª∂Shield ÊòØ Elastic ÂÖ¨Âè∏‰∏∫ Elasticsearch ÂºÄÂèëÁöÑ‰∏Ä‰∏™ÂÆâÂÖ®Êèí‰ª∂„ÄÇÂú®ÂÆâË£ÖÊ≠§Êèí‰ª∂ÂêéÔºåShield ‰ºöÊã¶Êà™ÊâÄÊúâÂØπ Elasticsearch ÁöÑËØ∑Ê±ÇÔºåÂπ∂ËøõË°åËÆ§ËØÅ‰∏éÂä†ÂØÜÔºå‰øùÈöú Elasticsearch ÂèäÁõ∏ÂÖ≥Á≥ªÁªüÁöÑÂÆâÂÖ®ÊÄß„ÄÇShield ÊòØÂïÜ‰∏öÊèí‰ª∂ÔºåÈúÄË¶Å Elasticsearch ÁöÑÂïÜ‰∏öËÆ∏ÂèØ„ÄÇÁ¨¨‰∏ÄÊ¨°ÂÆâË£ÖËÆ∏ÂèØÁöÑÊó∂ÂÄôÔºå‰ºöÊèê‰æõ 30 Â§©ÁöÑÂÖçË¥πËØïÁî®ÊùÉÈôê„ÄÇ30 Â§©ÂêéÔºåShield Â∞Ü‰ºöÂ±èËîΩ clusterhealth, cluster stats, index stats Á≠â APIÔºåÂÖ∂‰ΩôÂäüËÉΩ‰∏çÂèóÂΩ±Âìç„ÄÇ Áî®Êà∑ËÆ§ËØÅ‰ΩøÁî® Shield ÂèØ‰ª•ÂÆö‰πâ‰∏ÄÁ≥ªÂàóÂ∑≤Áü•ÁöÑÁî®Êà∑ÔºåÂπ∂Áî®ÂÖ∂ËÆ§ËØÅÁî®Êà∑ËØ∑Ê±Ç„ÄÇËøô‰∫õÁî®Êà∑Â≠òÂú®‰∫éÊäΩË±°ÁöÑ‚ÄúÂüü‚Äù‰∏≠„ÄÇ‰∏Ä‰∏™‚ÄúÂüü‚ÄùÂèØ‰ª•ÊòØ‰∏ãÈù¢Âá†ÁßçÁ±ªÂûãÔºö LDAP ÊúçÂä° ActiveDirectory ÊúçÂä° Êú¨Âú∞ esusers ÈÖçÁΩÆÊñá‰ª∂ÔºàÁ±ª‰ºº /etc/passwd) ÊùÉÈôêÊéßÂà∂Shield ÁöÑÊùÉÈôêÊéßÂà∂ÂåÖÂê´‰∏ãÈù¢Âá†ÁßçÂÖÉÁ¥†Ôºö Ë¢´‰øùÊä§ÁöÑËµÑÊ∫ê SecuredResourceÔºöÊùÉÈôêÊâÄÂ∫îÁî®Âà∞ÁöÑÂØπË±°ÔºåÊØîÂ¶ÇÊüê‰∏™ indexÔºåcluster Á≠â„ÄÇ ÁâπÊùÉ PriviliegeÔºöËßíËâ≤ÂØπÂØπË±°ÂèØ‰ª•ÊâßË°åÁöÑ‰∏ÄÁßçÊàñÂ§öÁßçÊìç‰ΩúÔºåÊØîÂ¶Ç readÔºåwrite Á≠â„ÄÇËøòÂèØ‰ª•ÊòØ indicies:/data/read/perlocate Á≠âÂØπÊüêÁßçÂØπË±°ÁâπÊúâÁöÑÊìç‰Ωú„ÄÇ ËÆ∏ÂèØ PermissionsÔºöÂØπË¢´‰øùÊä§ÁöÑËµÑÊ∫êÊã•ÊúâÁöÑ‰∏Ä‰∏™ÊàñÂ§ö‰∏™ÁâπÊùÉÔºåÂ¶Ç read on the&quot;products&quot; index„ÄÇ ËßíËâ≤ RoleÔºö‰∏ÄÁªÑËÆ∏ÂèØÁöÑÈõÜÊàêÔºåÂÖ∑ÊúâÁã¨Á´ãÁöÑÂêçÁß∞„ÄÇ Áî®Êà∑ UsersÔºöÁî®Êà∑ÂÆû‰ΩìÔºåÂèØ‰ª•Ë¢´Ëµã‰∫àÂ§öÁßçËßíËâ≤Ôºå‰ªñ‰ª¨ÂèØ‰ª•ÂØπË¢´‰øùÊä§ÁöÑËµÑÊ∫êÊâßË°åÁõ∏Â∫îËßíËâ≤ÊâÄÊã•ÊúâÁöÑÂêÑÁßçÁâπÊùÉ„ÄÇ ÂÆâË£Ö ShieldÊâßË°åÂÆâË£ÖÊ≠•È™§ÂâçÔºåËØ∑Á°Æ‰øùÊª°Ë∂≥‰ª•‰∏ãÂÆâË£ÖÁéØÂ¢ÉÊù°‰ª∂Ôºö ÊÇ®ÂÆâË£Ö‰∫Ü Java7 ÊàñÊõ¥Êñ∞ÁâàÊú¨„ÄÇ ÊÇ®Â∞Ü Elasticsearch 1.5.0+ Ëß£ÂéãÂÆâË£ÖÂà∞‰∫ÜÊú¨Êú∫‰∏ä„ÄÇÂ¶ÇÊûúÊÇ®‰ΩøÁî® APT Êàñ YUM ÂÆâË£ÖÔºåÈªòËÆ§ÁöÑÂÆâË£ÖÁõÆÂΩïÂèØËÉΩÂú® /usr/share/elasticsearch„ÄÇ ÂèÇÁÖß‰ª•‰∏ãÊ≠•È™§ÂÆåÊàêÂÆâË£ÖÔºö ËøõÂÖ• Elasticsearch ÂÆâË£ÖÁõÆÂΩïÔºö 1cd /usr/share/elasticsearch ÂÆâË£Ö Elasticsearch ËÆ∏ÂèØÊèí‰ª∂Ôºö 1bin/plugin -i elasticsearch/license/latest ÂÆâË£Ö Shield Êèí‰ª∂Ôºö 1bin/plugin -i elasticsearch/shield/latest Â∞Ü Shield ÈÖçÁΩÆÊñá‰ª∂ÁßªÂä®ÊàñÈìæÊé•Ëá≥ /etc/elasticsearch/shield ÁõÆÂΩï‰∏≠Ôºö 1ln -s /usr/share/elasticsearch/config/shield /etc/elasticsearch/shield ËØ¥ÊòéÔºöElasticsearch ÊúçÂä°Âú®ÂêØÂä®Êó∂‰ºöÂú® /etc/elasticsearch/shield ÁõÆÂΩï‰∏ãÂØªÊâæ Shield ÈÖçÁΩÆÊñá‰ª∂ÔºåËÄåËøô‰∫õÈÖçÁΩÆÊñá‰ª∂Âú®ÂÆâË£Ö Shield Êó∂‰ºöÂá∫Áé∞Âú® /usr/share/elasticsearch/config/shield ‰∏≠ÔºåÂõ†Ê≠§ÈúÄË¶ÅÂ∞ÜÈÖçÁΩÆÊñá‰ª∂ÁßªÂä®ÊàñÈìæÊé•Ëá≥ËØ•ÁõÆÂΩï„ÄÇ ÈáçÂêØ Elasticsearch ÊúçÂä°Ôºö 1service elasticsearch restart Êñ∞Âª∫‰∏Ä‰∏™ Elasticsearch ÁÆ°ÁêÜÂëòË¥¶Êà∑ÔºåÂ°´ÂÜôÊñ∞ÂØÜÁ†ÅÔºö 1bin/shield/esusersuseradd es_admin -r admin Áõ¥Êé•‰ΩøÁî® RESTFUL API ËÆøÈóÆ Elasticsearch ÁöÑËØ∑Ê±ÇÈÉΩ‰ºöË¢´ÊãíÁªùÔºö 1curl -XGET&apos;http://localhost:9200/&apos; ÈúÄË¶ÅÂú®ËØ∑Ê±Ç‰∏≠Ê∑ªÂä†Áî®Êà∑ÂêçÂíåÂØÜÁ†ÅÔºö 1curl -u es_admin -XGET &apos;http://localhost:9200/&apos; Êõ¥Â§ö‰ø°ÊÅØÔºåËØ∑ÂèÇËÄÉÔºö Shield ÂÆòÊñπÂÆâË£ÖÊåáÂçó Shield ÂÆòÊñπ‰ΩøÁî®ÈÖçÁΩÆÊåáÂçó ‰øÆÊîπÈªòËÆ§ÁöÑ Elasticsearch ÈõÜÁæ§ÂêçÁß∞Elasticsearch ÈªòËÆ§ÁöÑÈõÜÁæ§ÂêçÁß∞ÊòØ elasticsearchÔºåËØ∑Âú®ÊÇ®ÁöÑÁîü‰∫ßÁéØÂ¢É‰∏≠Â∞ÜÂÖ∂‰øÆÊîπÊàêÂÖ∂‰ªñÂêçÁß∞„ÄÇÁ°Æ‰øùÂú®‰∏çÂêåÁöÑÁéØÂ¢ÉÂíå‰∏çÂêåÁöÑÈõÜÁæ§‰∏ã‰ΩøÁî®‰∏çÂêåÁöÑÂêçÁß∞ÔºõÂπ∂‰∏îÂú®ÁõëÊéßÈõÜÁæ§ËäÇÁÇπÊó∂ÔºåÂ¶ÇÊûúÊúâÊú™Áü•ËäÇÁÇπÂä†ÂÖ•Ôºå‰∏ÄÂÆöË¶ÅÂèäÊó∂È¢ÑË≠¶„ÄÇ ‰∏çË¶Å‰ª• root Ë∫´‰ªΩËøêË°å Elasticsearch‰∏çË¶Å‰ª• root Ë∫´‰ªΩÊù•ËøêË°å ElasticsearchÔºå‰∏çË¶ÅÂíåÂÖ∂‰ªñÊúçÂä°ÂÖ±Áî®Áõ∏ÂêåÁöÑÁî®Êà∑ÔºåÂπ∂ÊääÁî®Êà∑ÁöÑÊùÉÈôêÊúÄÂ∞èÂåñ„ÄÇ Â∫îÁî®Á§∫‰æãÔºö 1sudo -u es-user ES_JAVA_OPTS=&quot;-Xms1024m -Xmx1024m&quot;/opt/elasticsearch/bin/elasticsearc Ê≠£Á°ÆËÆæÁΩÆ Elasticsearch ÁöÑÊï∞ÊçÆÁõÆÂΩïËØ∑Á°Æ‰øù‰∏∫ Elasticsearch ÁöÑÁõÆÂΩïÂàÜÈÖç‰∫ÜÂêàÁêÜÁöÑËØªÂÜôÊùÉÈôêÔºåÈÅøÂÖç‰ΩøÁî®ÂÖ±‰∫´Êñá‰ª∂Á≥ªÁªü„ÄÇÁ°Æ‰øùÂè™Êúâ Elasticsearch ÁöÑÂêØÂä®Áî®Êà∑ÊâçÊúâÊùÉËÆøÈóÆÁõÆÂΩï„ÄÇÊó•ÂøóÁõÆÂΩï‰πüÈúÄË¶ÅÊ≠£Á°ÆÈÖçÁΩÆÔºåÈÅøÂÖçÊ≥ÑÈú≤ÊïèÊÑü‰ø°ÊÅØ„ÄÇ ÂÆöÊúüÂØπ Elasticsearch ËøõË°åÂ§á‰ªΩ‰ΩøÁî® Elasticsearch Êèê‰æõÁöÑÂ§á‰ªΩËøòÂéüÊú∫Âà∂ÔºåÂÆöÊúüÂØπ Elasticsearch ÁöÑÊï∞ÊçÆËøõË°åÂø´ÁÖßÂ§á‰ªΩ„ÄÇ Á¶ÅÁî®ÊâπÈáèÂà†Èô§Á¥¢ÂºïElasticsearch ÊîØÊåÅ‰ΩøÁî®ÂÖ®ÈÉ®Ôºà_allÔºâÂíåÈÄöÈÖçÁ¨¶Ôºà*ÔºâÊù•ÊâπÈáèÂà†Èô§Á¥¢Âºï„ÄÇÂú®Áîü‰∫ßÁéØÂ¢ÉÔºåËØ•Êìç‰ΩúÂ≠òÂú®‰∏ÄÂÆöÈ£éÈô©Ôºå‰Ω†ÂèØ‰ª•ÈÄöËøáËÆæÁΩÆ action.destructive_requires_name: true ÂèÇÊï∞Êù•Á¶ÅÁî®ÂÆÉ„ÄÇ ÂêØÁî®Êó•ÂøóËÆ∞ÂΩïÂäüËÉΩElasticsearch ÁöÑ config Êñá‰ª∂Â§πÈáåÈù¢Êúâ‰∏§‰∏™ÈÖçÁΩÆÊñá‰ª∂Ôºö elasticsearch.ymlÔºöÂü∫Êú¨ÈÖçÁΩÆÊñá‰ª∂„ÄÇ logging.ymlÔºöÊó•ÂøóÈÖçÁΩÆÊñá‰ª∂„ÄÇÁî±‰∫é Elasticsearch ‰ΩøÁî® log4j Êù•ËÆ∞ÂΩïÊó•ÂøóÁöÑÔºålogging.yml ‰∏≠ÁöÑËÆæÁΩÆËØ∑ÊåâÊôÆÈÄö log4j ÈÖçÁΩÆÊñá‰ª∂ËøõË°åËÆæÁΩÆ„ÄÇ ÂêØÁî®Êó•ÂøóÂäüËÉΩÈúÄË¶Å‰øÆÊîπ elasticsearch.yml ÈÖçÁΩÆÊñá‰ª∂Ôºö 1path.logs: /path/to/logs# ËÆæÁΩÆÊó•ÂøóÊñá‰ª∂ÁöÑÂ≠òÂÇ®Ë∑ØÂæÑÔºåÈªòËÆ§ÊòØ Elasticsearch Ê†πÁõÆÂΩï‰∏ãÁöÑ logs Êñá‰ª∂Â§π]]></content>
      <categories>
        <category>Elasticsearch</category>
      </categories>
      <tags>
        <tag>Elasticsearch</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[LinuxÊìç‰ΩúÁ≥ªÁªüÂä†Âõ∫]]></title>
    <url>%2F2019%2F04%2F16%2FLinux%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E5%8A%A0%E5%9B%BA%2F</url>
    <content type="text"><![CDATA[ÂºïËá™ÈòøÈáå‰∫ëhttps://help.aliyun.com/knowledge_detail/49809.html&gt; Êú¨Â∏ÆÂä©ÊâãÂÜåÊó®Âú®ÊåáÂØºÁ≥ªÁªüÁÆ°ÁêÜ‰∫∫ÂëòÊàñÂÆâÂÖ®Ê£ÄÊü•‰∫∫ÂëòËøõË°åLinuxÊìç‰ΩúÁ≥ªÁªüÁöÑÂÆâÂÖ®ÂêàËßÑÊÄßÊ£ÄÊü•ÂíåÂä†Âõ∫„ÄÇ 1. Ë¥¶Âè∑ÂíåÂè£‰ª§1.1 Á¶ÅÁî®ÊàñÂà†Èô§Êó†Áî®Ë¥¶Âè∑ÂáèÂ∞ëÁ≥ªÁªüÊó†Áî®Ë¥¶Âè∑ÔºåÈôç‰ΩéÂÆâÂÖ®È£éÈô©„ÄÇ Êìç‰ΩúÊ≠•È™§ ‰ΩøÁî®ÂëΩ‰ª§ userdel &lt;Áî®Êà∑Âêç&gt; Âà†Èô§‰∏çÂøÖË¶ÅÁöÑË¥¶Âè∑„ÄÇ ‰ΩøÁî®ÂëΩ‰ª§ passwd -l &lt;Áî®Êà∑Âêç&gt; ÈîÅÂÆö‰∏çÂøÖË¶ÅÁöÑË¥¶Âè∑„ÄÇ ‰ΩøÁî®ÂëΩ‰ª§ passwd -u &lt;Áî®Êà∑Âêç&gt; Ëß£ÈîÅÂøÖË¶ÅÁöÑË¥¶Âè∑„ÄÇ 1.2 Ê£ÄÊü•ÁâπÊÆäË¥¶Âè∑Ê£ÄÊü•ÊòØÂê¶Â≠òÂú®Á©∫Âè£‰ª§ÂíårootÊùÉÈôêÁöÑË¥¶Âè∑„ÄÇ Êìç‰ΩúÊ≠•È™§ Êü•ÁúãÁ©∫Âè£‰ª§ÂíårootÊùÉÈôêË¥¶Âè∑ÔºåÁ°ÆËÆ§ÊòØÂê¶Â≠òÂú®ÂºÇÂ∏∏Ë¥¶Âè∑Ôºö ‰ΩøÁî®ÂëΩ‰ª§ awk -F: &#39;($2==&quot;&quot;)&#39; /etc/shadow Êü•ÁúãÁ©∫Âè£‰ª§Ë¥¶Âè∑„ÄÇ ‰ΩøÁî®ÂëΩ‰ª§ awk -F: &#39;($3==0)&#39; /etc/passwd Êü•ÁúãUID‰∏∫Èõ∂ÁöÑË¥¶Âè∑„ÄÇ Âä†Âõ∫Á©∫Âè£‰ª§Ë¥¶Âè∑Ôºö ‰ΩøÁî®ÂëΩ‰ª§ passwd &lt;Áî®Êà∑Âêç&gt; ‰∏∫Á©∫Âè£‰ª§Ë¥¶Âè∑ËÆæÂÆöÂØÜÁ†Å„ÄÇ Á°ÆËÆ§UID‰∏∫Èõ∂ÁöÑË¥¶Âè∑Âè™ÊúârootË¥¶Âè∑„ÄÇ 1.3 Ê∑ªÂä†Âè£‰ª§Á≠ñÁï•Âä†Âº∫Âè£‰ª§ÁöÑÂ§çÊùÇÂ∫¶Á≠âÔºåÈôç‰ΩéË¢´ÁåúËß£ÁöÑÂèØËÉΩÊÄß„ÄÇ Êìç‰ΩúÊ≠•È™§ ‰ΩøÁî®ÂëΩ‰ª§ 1vi /etc/login.defs ‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂„ÄÇ PASS_MAX_DAYS 90 #Êñ∞Âª∫Áî®Êà∑ÁöÑÂØÜÁ†ÅÊúÄÈïø‰ΩøÁî®Â§©Êï∞ PASS_MIN_DAYS 0 #Êñ∞Âª∫Áî®Êà∑ÁöÑÂØÜÁ†ÅÊúÄÁü≠‰ΩøÁî®Â§©Êï∞ PASS_WARN_AGE 7 #Êñ∞Âª∫Áî®Êà∑ÁöÑÂØÜÁ†ÅÂà∞ÊúüÊèêÂâçÊèêÈÜíÂ§©Êï∞ ‰ΩøÁî®chageÂëΩ‰ª§‰øÆÊîπÁî®Êà∑ËÆæÁΩÆ„ÄÇ‰æãÂ¶ÇÔºåchage -m 0 -M 30 -E 2000-01-01 -W 7 &lt;Áî®Êà∑Âêç&gt;Ë°®Á§∫Â∞ÜÊ≠§Áî®Êà∑ÁöÑÂØÜÁ†ÅÊúÄÈïø‰ΩøÁî®Â§©Êï∞ËÆæ‰∏∫30ÔºåÊúÄÁü≠‰ΩøÁî®Â§©Êï∞ËÆæ‰∏∫0ÔºåÂØÜÁ†Å2000Âπ¥1Êúà1Êó•ËøáÊúüÔºåËøáÊúüÂâç‰∏ÉÂ§©Ë≠¶ÂëäÁî®Êà∑„ÄÇ ËÆæÁΩÆËøûÁª≠ËæìÈîô‰∏âÊ¨°ÂØÜÁ†ÅÔºåË¥¶Âè∑ÈîÅÂÆö‰∫îÂàÜÈíü„ÄÇ‰ΩøÁî®ÂëΩ‰ª§ vi /etc/pam.d/common-auth‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂ÔºåÂú®ÈÖçÁΩÆÊñá‰ª∂‰∏≠Ê∑ªÂä† auth required pam_tally.so onerr=fail deny=3 unlock_time=300„ÄÇ 1.4 ÈôêÂà∂Áî®Êà∑suÈôêÂà∂ËÉΩsuÂà∞rootÁöÑÁî®Êà∑„ÄÇ Êìç‰ΩúÊ≠•È™§ ‰ΩøÁî®ÂëΩ‰ª§ vi /etc/pam.d/su‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂ÔºåÂú®ÈÖçÁΩÆÊñá‰ª∂‰∏≠Ê∑ªÂä†Ë°å„ÄÇ‰æãÂ¶ÇÔºåÂè™ÂÖÅËÆ∏testÁªÑÁî®Êà∑suÂà∞rootÔºåÂàôÊ∑ªÂä† auth required pam_wheel.so group=test„ÄÇ 1.4 Á¶ÅÊ≠¢rootÁî®Êà∑Áõ¥Êé•ÁôªÂΩïÈôêÂà∂rootÁî®Êà∑Áõ¥Êé•ÁôªÂΩï„ÄÇ Êìç‰ΩúÊ≠•È™§ ÂàõÂª∫ÊôÆÈÄöÊùÉÈôêË¥¶Âè∑Âπ∂ÈÖçÁΩÆÂØÜÁ†Å,Èò≤Ê≠¢Êó†Ê≥ïËøúÁ®ãÁôªÂΩï; ‰ΩøÁî®ÂëΩ‰ª§ vi /etc/ssh/sshd_config‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂Â∞ÜPermitRootLoginÁöÑÂÄºÊîπÊàênoÔºåÂπ∂‰øùÂ≠òÔºåÁÑ∂Âêé‰ΩøÁî®service sshd restartÈáçÂêØÊúçÂä°„ÄÇ 2. ÊúçÂä°2.1 ÂÖ≥Èó≠‰∏çÂøÖË¶ÅÁöÑÊúçÂä°ÂÖ≥Èó≠‰∏çÂøÖË¶ÅÁöÑÊúçÂä°ÔºàÂ¶ÇÊôÆÈÄöÊúçÂä°ÂíåxinetdÊúçÂä°ÔºâÔºåÈôç‰ΩéÈ£éÈô©„ÄÇ Êìç‰ΩúÊ≠•È™§ ‰ΩøÁî®ÂëΩ‰ª§systemctl disable &lt;ÊúçÂä°Âêç&gt;ËÆæÁΩÆÊúçÂä°Âú®ÂºÄÊú∫Êó∂‰∏çËá™Âä®ÂêØÂä®„ÄÇ ËØ¥ÊòéÔºö ÂØπ‰∫éÈÉ®ÂàÜËÄÅÁâàÊú¨ÁöÑLinuxÊìç‰ΩúÁ≥ªÁªüÔºàÂ¶ÇCentOS 6ÔºâÔºåÂèØ‰ª•‰ΩøÁî®ÂëΩ‰ª§chkconfig --level &lt;initÁ∫ßÂà´&gt; &lt;ÊúçÂä°Âêç&gt; offËÆæÁΩÆÊúçÂä°Âú®ÊåáÂÆöinitÁ∫ßÂà´‰∏ãÂºÄÊú∫Êó∂‰∏çËá™Âä®ÂêØÂä®„ÄÇ 2.2 SSHÊúçÂä°ÂÆâÂÖ®ÂØπSSHÊúçÂä°ËøõË°åÂÆâÂÖ®Âä†Âõ∫ÔºåÈò≤Ê≠¢Êö¥ÂäõÁ†¥Ëß£ÊàêÂäü„ÄÇ Êìç‰ΩúÊ≠•È™§ ‰ΩøÁî®ÂëΩ‰ª§ vim /etc/ssh/sshd_config ÁºñËæëÈÖçÁΩÆÊñá‰ª∂„ÄÇ ‰∏çÂÖÅËÆ∏rootË¥¶Âè∑Áõ¥Êé•ÁôªÂΩïÁ≥ªÁªü„ÄÇËÆæÁΩÆ PermitRootLogin ÁöÑÂÄº‰∏∫ no„ÄÇ ‰øÆÊîπSSH‰ΩøÁî®ÁöÑÂçèËÆÆÁâàÊú¨„ÄÇËÆæÁΩÆ Protocol ÁöÑÁâàÊú¨‰∏∫ 2„ÄÇ ‰øÆÊîπÂÖÅËÆ∏ÂØÜÁ†ÅÈîôËØØÊ¨°Êï∞ÔºàÈªòËÆ§6Ê¨°Ôºâ„ÄÇËÆæÁΩÆ MaxAuthTries ÁöÑÂÄº‰∏∫ 3„ÄÇ ÈÖçÁΩÆÊñá‰ª∂‰øÆÊîπÂÆåÊàêÂêéÔºåÈáçÂêØsshdÊúçÂä°ÁîüÊïà„ÄÇ 3. Êñá‰ª∂Á≥ªÁªü3.1 ËÆæÁΩÆumaskÂÄºËÆæÁΩÆÈªòËÆ§ÁöÑumaskÂÄºÔºåÂ¢ûÂº∫ÂÆâÂÖ®ÊÄß„ÄÇ Êìç‰ΩúÊ≠•È™§ ‰ΩøÁî®ÂëΩ‰ª§ vi /etc/profile ‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂ÔºåÊ∑ªÂä†Ë°å umask 027Ôºå Âç≥Êñ∞ÂàõÂª∫ÁöÑÊñá‰ª∂Â±û‰∏ªÊã•ÊúâËØªÂÜôÊâßË°åÊùÉÈôêÔºåÂêåÁªÑÁî®Êà∑Êã•ÊúâËØªÂíåÊâßË°åÊùÉÈôêÔºåÂÖ∂‰ªñÁî®Êà∑Êó†ÊùÉÈôê„ÄÇ 3.2 ËÆæÁΩÆÁôªÂΩïË∂ÖÊó∂ËÆæÁΩÆÁ≥ªÁªüÁôªÂΩïÂêéÔºåËøûÊé•Ë∂ÖÊó∂Êó∂Èó¥ÔºåÂ¢ûÂº∫ÂÆâÂÖ®ÊÄß„ÄÇ Êìç‰ΩúÊ≠•È™§ ‰ΩøÁî®ÂëΩ‰ª§ vi /etc/profile ‰øÆÊîπÈÖçÁΩÆÊñá‰ª∂ÔºåÂ∞Ü‰ª• TMOUT= ÂºÄÂ§¥ÁöÑË°åÊ≥®ÈáäÔºåËÆæÁΩÆ‰∏∫TMOUT=180ÔºåÂç≥Ë∂ÖÊó∂Êó∂Èó¥‰∏∫‰∏âÂàÜÈíü„ÄÇ 4. Êó•Âøó4.1 syslogdÊó•ÂøóÂêØÁî®Êó•ÂøóÂäüËÉΩÔºåÂπ∂ÈÖçÁΩÆÊó•ÂøóËÆ∞ÂΩï„ÄÇ Êìç‰ΩúÊ≠•È™§ LinuxÁ≥ªÁªüÈªòËÆ§ÂêØÁî®‰ª•‰∏ãÁ±ªÂûãÊó•ÂøóÔºö Á≥ªÁªüÊó•ÂøóÔºàÈªòËÆ§Ôºâ/var/log/messages cronÊó•ÂøóÔºàÈªòËÆ§Ôºâ/var/log/cron ÂÆâÂÖ®Êó•ÂøóÔºàÈªòËÆ§Ôºâ/var/log/secure Ê≥®ÊÑèÔºöÈÉ®ÂàÜÁ≥ªÁªüÂèØËÉΩ‰ΩøÁî®syslog-ngÊó•ÂøóÔºåÈÖçÁΩÆÊñá‰ª∂‰∏∫Ôºö/etc/syslog-ng/syslog-ng.conf„ÄÇ ÊÇ®ÂèØ‰ª•Ê†πÊçÆÈúÄÊ±ÇÈÖçÁΩÆËØ¶ÁªÜÊó•Âøó„ÄÇ 4.2 ËÆ∞ÂΩïÊâÄÊúâÁî®Êà∑ÁöÑÁôªÂΩïÂíåÊìç‰ΩúÊó•ÂøóÈÄöËøáËÑöÊú¨‰ª£Á†ÅÂÆûÁé∞ËÆ∞ÂΩïÊâÄÊúâÁî®Êà∑ÁöÑÁôªÂΩïÊìç‰ΩúÊó•ÂøóÔºåÈò≤Ê≠¢Âá∫Áé∞ÂÆâÂÖ®‰∫ã‰ª∂ÂêéÊó†ÊçÆÂèØÊü•„ÄÇ Êìç‰ΩúÊ≠•È™§ ËøêË°å [root@xxx /]# vim /etc/profileÊâìÂºÄÈÖçÁΩÆÊñá‰ª∂„ÄÇ Âú®ÈÖçÁΩÆÊñá‰ª∂‰∏≠ËæìÂÖ•‰ª•‰∏ãÂÜÖÂÆπÔºö 123456789101112131415161718historyUSER=`whoami`USER_IP=`who -u am i 2&gt;/dev/null| awk '&#123;print $NF&#125;'|sed -e 's/[()]//g'`if [ "$USER_IP" = "" ]; thenUSER_IP=`hostname`fiif [ ! -d /var/log/history ]; thenmkdir /var/log/historychmod 777 /var/log/historyfiif [ ! -d /var/log/history/$&#123;LOGNAME&#125; ]; thenmkdir /var/log/history/$&#123;LOGNAME&#125;chmod 300 /var/log/history/$&#123;LOGNAME&#125;fiexport HISTSIZE=4096DT=`date +"%Y%m%d_%H:%M:%S"`export HISTFILE="/var/log/history/$&#123;LOGNAME&#125;/$&#123;USER&#125;@$&#123;USER_IP&#125;_$DT"chmod 600 /var/log/history/$&#123;LOGNAME&#125;/*history* 2&gt;/dev/null ËøêË°å [root@xxx /]# source /etc/profile Âä†ËΩΩÈÖçÁΩÆÁîüÊïà„ÄÇÊ≥®ÊÑèÔºö /var/log/history ÊòØËÆ∞ÂΩïÊó•ÂøóÁöÑÂ≠òÊîæ‰ΩçÁΩÆÔºåÂèØ‰ª•Ëá™ÂÆö‰πâ„ÄÇ ÈÄöËøá‰∏äËø∞Ê≠•È™§ÔºåÂèØ‰ª•Âú® /var/log/history ÁõÆÂΩï‰∏ã‰ª•ÊØè‰∏™Áî®Êà∑‰∏∫ÂêçÊñ∞Âª∫‰∏Ä‰∏™Êñá‰ª∂Â§πÔºåÊØèÊ¨°Áî®Êà∑ÈÄÄÂá∫ÂêéÈÉΩ‰ºö‰∫ßÁîü‰ª•Áî®Êà∑Âêç„ÄÅÁôªÂΩïIP„ÄÅÊó∂Èó¥ÁöÑÊó•ÂøóÊñá‰ª∂ÔºåÂåÖÂê´Ê≠§Áî®Êà∑Êú¨Ê¨°ÁöÑÊâÄÊúâÊìç‰ΩúÔºàrootÁî®Êà∑Èô§Â§ñÔºâ„ÄÇ ÂêåÊó∂ÔºåÂª∫ËÆÆÊÇ®‰ΩøÁî®OSSÊúçÂä°Êî∂ÈõÜÂ≠òÂÇ®Êó•Âøó„ÄÇ]]></content>
      <categories>
        <category>Linux</category>
        <category>ÂÆâÂÖ®</category>
      </categories>
      <tags>
        <tag>Linux</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Ansible-Âø´ÈÄüÊ∑ªÂä†ÂÖçÂØÜÁ†ÅËÆ§ËØÅ]]></title>
    <url>%2F2019%2F04%2F08%2FAnsible-%E5%BF%AB%E9%80%9F%E6%B7%BB%E5%8A%A0%E5%85%8D%E5%AF%86%E7%A0%81%E8%AE%A4%E8%AF%81%2F</url>
    <content type="text"><![CDATA[ÁîüÊàêÁÆ°ÁêÜÊú∫ÁöÑÁßÅÈí•ÂíåÂÖ¨Èí•1ssh-keygen -t rsa -b 2048 -P '' -f /root/.ssh/id_rsa Ê∑ªÂä†‰∏ªÊú∫‰ø°ÊÅØÂà∞‰∏ªÊú∫Ê∏ÖÂçï‰∏≠1vim /etc/ansible/hosts 123456789101112#Ê∑ªÂä†ÂàÜÁªÑ[test-k8s]172.20.21.249172.20.21.250172.20.21.251172.20.21.252172.20.21.253172.20.21.254172.20.21.255172.20.22.0172.20.22.1172.20.22.2 ÈÖçÁΩÆplaybook1vim /etc/ansible/ssh-addkey.yml 12345678910---- hosts: pro-k8s gather_facts: no tasks: - name: install ssh key authorized_key: user=root key="&#123;&#123; lookup('file', '/root/.ssh/id_rsa.pub') &#125;&#125;" state=present ËøêË°åplaybook1ansible-playbook -i /etc/ansible/hosts -k /etc/ansible/ssh-addkey.yml ËæìÂÖ•ÊúçÂä°Âô®ÂØÜÁ†Å 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465SSH password:PLAY [pro-k8s] ***************************************************************************************************************************TASK [install ssh key] *******************************************************************************************************************changed: [172.21.5.197]changed: [172.21.5.196]changed: [172.21.5.199]changed: [172.21.5.192]changed: [172.21.5.195]changed: [172.21.5.193]changed: [172.21.2.240]changed: [172.21.5.198]changed: [172.21.2.238]changed: [172.21.5.194]changed: [172.21.2.236]changed: [172.21.2.235]changed: [172.21.2.237]changed: [172.21.2.239]changed: [172.21.2.234]changed: [172.21.0.159]changed: [172.21.0.155]changed: [172.21.2.241]changed: [172.21.0.154]changed: [172.21.0.153]changed: [172.21.0.158]changed: [172.21.0.152]changed: [172.21.0.160]changed: [172.21.0.156]changed: [172.21.0.157]changed: [172.21.2.232]changed: [172.21.2.233]changed: [172.21.0.151]changed: [172.21.5.191]PLAY RECAP *******************************************************************************************************************************172.21.0.151 : ok=1 changed=1 unreachable=0 failed=0172.21.0.152 : ok=1 changed=1 unreachable=0 failed=0172.21.0.153 : ok=1 changed=1 unreachable=0 failed=0172.21.0.154 : ok=1 changed=1 unreachable=0 failed=0172.21.0.155 : ok=1 changed=1 unreachable=0 failed=0172.21.0.156 : ok=1 changed=1 unreachable=0 failed=0172.21.0.157 : ok=1 changed=1 unreachable=0 failed=0172.21.0.158 : ok=1 changed=1 unreachable=0 failed=0172.21.0.159 : ok=1 changed=1 unreachable=0 failed=0172.21.0.160 : ok=1 changed=1 unreachable=0 failed=0172.21.2.232 : ok=1 changed=1 unreachable=0 failed=0172.21.2.233 : ok=1 changed=1 unreachable=0 failed=0172.21.2.234 : ok=1 changed=1 unreachable=0 failed=0172.21.2.235 : ok=1 changed=1 unreachable=0 failed=0172.21.2.236 : ok=1 changed=1 unreachable=0 failed=0172.21.2.237 : ok=1 changed=1 unreachable=0 failed=0172.21.2.238 : ok=1 changed=1 unreachable=0 failed=0172.21.2.239 : ok=1 changed=1 unreachable=0 failed=0172.21.2.240 : ok=1 changed=1 unreachable=0 failed=0172.21.2.241 : ok=1 changed=1 unreachable=0 failed=0172.21.5.191 : ok=1 changed=1 unreachable=0 failed=0172.21.5.192 : ok=1 changed=1 unreachable=0 failed=0172.21.5.193 : ok=1 changed=1 unreachable=0 failed=0172.21.5.194 : ok=1 changed=1 unreachable=0 failed=0172.21.5.195 : ok=1 changed=1 unreachable=0 failed=0172.21.5.196 : ok=1 changed=1 unreachable=0 failed=0172.21.5.197 : ok=1 changed=1 unreachable=0 failed=0172.21.5.198 : ok=1 changed=1 unreachable=0 failed=0172.21.5.199 : ok=1 changed=1 unreachable=0 failed=0]]></content>
      <categories>
        <category>Ansible</category>
      </categories>
      <tags>
        <tag>Ansible</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Cookie & Session]]></title>
    <url>%2F2019%2F04%2F07%2FCookie-Session%2F</url>
    <content type="text"><![CDATA[https://www.cnblogs.com/liwenzhou/p/8343243.html CookieCookieÊòØ‰ªÄ‰πà‰øùÂ≠òÂú®ÊµèËßàÂô®Á´ØÁöÑÈîÆÂÄºÂØπ ‰∏∫‰ªÄ‰πàË¶ÅÊúâCookieÂõ†‰∏∫HTTPËØ∑Ê±ÇÊòØÊó†Áä∂ÊÄÅÁöÑ CookieÁöÑÂéüÁêÜÊúçÂä°Á´ØÂèØ‰ª•Âú®ËøîÂõûÂìçÂ∫îÁöÑÊó∂ÂÄô ÂÅöÊâãËÑöÂú®ÊµèËßàÂô®‰∏äÂÜôÂÖ•ÈîÆÂÄºÂØπÔºåÂ∞±ÊòØCookieÔºåÊµèËßàÂô®ÂèëÈÄÅËØ∑Ê±ÇÁöÑÊó∂ÂÄô‰ºöËá™Âä®Êê∫Â∏¶ËØ•ÁΩëÁ´ô‰øùÂ≠òÂú®ÊµèËßàÂô®‰∏≠ÁöÑÈîÆÂÄºÂØπ CookieÁöÑ‰ΩøÁî®Âú∫ÊôØ ‰øùÂ≠òÁôªÂΩï‰ø°ÊÅØ ‰øùÂ≠òÁî®Êà∑ÁöÑÊêúÁ¥¢ÂÖ≥ÈîÆËØç Django‰∏≠Êìç‰ΩúCookieËé∑ÂèñCookie1234567request.COOKIES['key']request.get_signed_cookie(key, default=RAISE_ERROR, salt='', max_age=None)ÂèÇÊï∞Ôºö default: ÈªòËÆ§ÂÄº salt: Âä†ÂØÜÁõê max_age: ÂêéÂè∞ÊéßÂà∂ËøáÊúüÊó∂Èó¥ ËÆæÁΩÆCookie123456789101112131415rep = HttpResponse(...)rep Ôºù render(request, ...)rep.set_cookie(key,value,...)rep.set_signed_cookie(key,value,salt='Âä†ÂØÜÁõê', max_age=None, ...)ÂèÇÊï∞Ôºö key, ÈîÆ value='', ÂÄº max_age=None, Ë∂ÖÊó∂Êó∂Èó¥ expires=None, Ë∂ÖÊó∂Êó∂Èó¥(IE requires expires, so set it if hasn't been already.) path='/', CookieÁîüÊïàÁöÑË∑ØÂæÑÔºå/ Ë°®Á§∫Ê†πË∑ØÂæÑÔºåÁâπÊÆäÁöÑÔºöÊ†πË∑ØÂæÑÁöÑcookieÂèØ‰ª•Ë¢´‰ªª‰ΩïurlÁöÑÈ°µÈù¢ËÆøÈóÆ domain=None, CookieÁîüÊïàÁöÑÂüüÂêç secure=False, https‰º†Ëæì httponly=False Âè™ËÉΩhttpÂçèËÆÆ‰º†ËæìÔºåÊó†Ê≥ïË¢´JavaScriptËé∑ÂèñÔºà‰∏çÊòØÁªùÂØπÔºåÂ∫ïÂ±ÇÊäìÂåÖÂèØ‰ª•Ëé∑ÂèñÂà∞‰πüÂèØ‰ª•Ë¢´Ë¶ÜÁõñÔºâ Âà†Èô§Cookie1234def logout(request): rep = redirect("/login/") rep.delete_cookie("user") # Âà†Èô§Áî®Êà∑ÊµèËßàÂô®‰∏ä‰πãÂâçËÆæÁΩÆÁöÑusercookieÂÄº return rep ÂÆåÊï¥views.pyÁ§∫‰æãÔºö12345678910111213141516171819202122232425262728293031323334353637383940414243444546# -*- coding: utf-8 -*-from __future__ import unicode_literalsfrom django.shortcuts import render,redirectfrom django.http import HttpResponse,HttpResponseRedirectfrom django.shortcuts import render# Create your views here.def check_login(func): def a(request,*args,**kwargs): Cookies = request.COOKIES.get("is_login", None) if 'yes' != Cookies: return redirect('/test01/login') else: return func(request,*args,**kwargs) return a@check_logindef index(request): return HttpResponse('indexÁïåÈù¢')@check_logindef home(request): return HttpResponse('home')def login(request): return render(request,'test01/login.html')@check_logindef logout(request): rep = redirect('/test01/login') rep.delete_cookie('is_login') return repdef check_username(request): if request.method == "POST": username = request.POST.get('username',None) password = request.POST.get('password',None) if username == 'z' and password == 'z': rep = render(request,'test01/home.html',&#123;'username':username&#125;) #rep.set_cookie('is_login','yes') rep.set_signed_cookie('is_login', 'yes', expires=60 * 60 * 24 * 7) else: rep = redirect('/test01/login') else: rep = redirect('/test01/login') return rep SessionCookieËôΩÁÑ∂Âú®‰∏ÄÂÆöÁ®ãÂ∫¶‰∏äËß£ÂÜ≥‰∫Ü‚Äú‰øùÊåÅÁä∂ÊÄÅ‚ÄùÁöÑÈúÄÊ±ÇÔºå‰ΩÜÊòØÁî±‰∫éCookieÊú¨Ë∫´ÊúÄÂ§ßÊîØÊåÅ4096Â≠óËäÇÔºå‰ª•ÂèäCookieÊú¨Ë∫´‰øùÂ≠òÂú®ÂÆ¢Êà∑Á´ØÔºåÂèØËÉΩË¢´Êã¶Êà™ÊàñÁ™ÉÂèñÔºåÂõ†Ê≠§Â∞±ÈúÄË¶ÅÊúâ‰∏ÄÁßçÊñ∞ÁöÑ‰∏úË•øÔºåÂÆÉËÉΩÊîØÊåÅÊõ¥Â§öÁöÑÂ≠óËäÇÔºåÂπ∂‰∏î‰ªñ‰øùÂ≠òÂú®ÊúçÂä°Âô®ÔºåÊúâËæÉÈ´òÁöÑÂÆâÂÖ®ÊÄß„ÄÇËøôÂ∞±ÊòØSession„ÄÇ ÈóÆÈ¢òÊù•‰∫ÜÔºåÂü∫‰∫éHTTPÂçèËÆÆÁöÑÊó†Áä∂ÊÄÅÁâπÂæÅÔºåÊúçÂä°Âô®Ê†πÊú¨Â∞±‰∏çÁü•ÈÅìËÆøÈóÆËÄÖÊòØ‚ÄúË∞Å‚Äù„ÄÇÈÇ£‰πà‰∏äËø∞ÁöÑCookieÂ∞±Ëµ∑Âà∞Ê°•Êé•ÁöÑ‰ΩúÁî®„ÄÇ Êàë‰ª¨ÂèØ‰ª•ÁªôÊØè‰∏™ÂÆ¢Êà∑Á´ØÁöÑCookieÂàÜÈÖç‰∏Ä‰∏™ÂîØ‰∏ÄÁöÑidÔºåËøôÊ†∑Áî®Êà∑Âú®ËÆøÈóÆÊó∂ÔºåÈÄöËøáCookieÔºåÊúçÂä°Âô®Â∞±Áü•ÈÅìÊù•ÁöÑ‰∫∫ÊòØ‚ÄúË∞Å‚Äù„ÄÇÁÑ∂ÂêéÊàë‰ª¨ÂÜçÊ†πÊçÆ‰∏çÂêåÁöÑCookieÁöÑidÔºåÂú®ÊúçÂä°Âô®‰∏ä‰øùÂ≠ò‰∏ÄÊÆµÊó∂Èó¥ÁöÑÁßÅÂØÜËµÑÊñôÔºåÂ¶Ç‚ÄúË¥¶Âè∑ÂØÜÁ†Å‚ÄùÁ≠âÁ≠â„ÄÇ ÊÄªÁªìËÄåË®ÄÔºöCookieÂº•Ë°•‰∫ÜHTTPÊó†Áä∂ÊÄÅÁöÑ‰∏çË∂≥ÔºåËÆ©ÊúçÂä°Âô®Áü•ÈÅìÊù•ÁöÑ‰∫∫ÊòØ‚ÄúË∞Å‚ÄùÔºõ‰ΩÜÊòØCookie‰ª•ÊñáÊú¨ÁöÑÂΩ¢Âºè‰øùÂ≠òÂú®Êú¨Âú∞ÔºåËá™Ë∫´ÂÆâÂÖ®ÊÄßËæÉÂ∑ÆÔºõÊâÄ‰ª•Êàë‰ª¨Â∞±ÈÄöËøáCookieËØÜÂà´‰∏çÂêåÁöÑÁî®Êà∑ÔºåÂØπÂ∫îÁöÑÂú®SessionÈáå‰øùÂ≠òÁßÅÂØÜÁöÑ‰ø°ÊÅØ‰ª•ÂèäË∂ÖËøá4096Â≠óËäÇÁöÑÊñáÊú¨„ÄÇÂè¶Â§ñÔºå‰∏äËø∞ÊâÄËØ¥ÁöÑCookieÂíåSessionÂÖ∂ÂÆûÊòØÂÖ±ÈÄöÊÄßÁöÑ‰∏úË•øÔºå‰∏çÈôê‰∫éËØ≠Ë®ÄÂíåÊ°ÜÊû∂„ÄÇ Django‰∏≠Êìç‰ΩúSession1234567891011121314151617181920212223242526272829303132333435363738# Ëé∑Âèñ„ÄÅËÆæÁΩÆ„ÄÅÂà†Èô§Session‰∏≠Êï∞ÊçÆrequest.session['k1']request.session.get('k1',None)request.session['k1'] = 123request.session.setdefault('k1',123) # Â≠òÂú®Âàô‰∏çËÆæÁΩÆdel request.session['k1']# ÊâÄÊúâ ÈîÆ„ÄÅÂÄº„ÄÅÈîÆÂÄºÂØπrequest.session.keys()request.session.values()request.session.items()request.session.iterkeys()request.session.itervalues()request.session.iteritems()# ‰ºöËØùsessionÁöÑkeyrequest.session.session_key# Â∞ÜÊâÄÊúâSessionÂ§±ÊïàÊó•ÊúüÂ∞è‰∫éÂΩìÂâçÊó•ÊúüÁöÑÊï∞ÊçÆÂà†Èô§request.session.clear_expired()# Ê£ÄÊü•‰ºöËØùsessionÁöÑkeyÂú®Êï∞ÊçÆÂ∫ì‰∏≠ÊòØÂê¶Â≠òÂú®request.session.exists("session_key")# Âà†Èô§ÂΩìÂâç‰ºöËØùÁöÑÊâÄÊúâSessionÊï∞ÊçÆrequest.session.delete() # Âà†Èô§ÂΩìÂâçÁöÑ‰ºöËØùÊï∞ÊçÆÂπ∂Âà†Èô§‰ºöËØùÁöÑCookie„ÄÇrequest.session.flush() ËøôÁî®‰∫éÁ°Æ‰øùÂâçÈù¢ÁöÑ‰ºöËØùÊï∞ÊçÆ‰∏çÂèØ‰ª•ÂÜçÊ¨°Ë¢´Áî®Êà∑ÁöÑÊµèËßàÂô®ËÆøÈóÆ ‰æãÂ¶ÇÔºådjango.contrib.auth.logout() ÂáΩÊï∞‰∏≠Â∞±‰ºöË∞ÉÁî®ÂÆÉ„ÄÇ# ËÆæÁΩÆ‰ºöËØùSessionÂíåCookieÁöÑË∂ÖÊó∂Êó∂Èó¥request.session.set_expiry(value) * Â¶ÇÊûúvalueÊòØ‰∏™Êï¥Êï∞Ôºåsession‰ºöÂú®‰∫õÁßíÊï∞ÂêéÂ§±Êïà„ÄÇ * Â¶ÇÊûúvalueÊòØ‰∏™datatimeÊàñtimedeltaÔºåsessionÂ∞±‰ºöÂú®Ëøô‰∏™Êó∂Èó¥ÂêéÂ§±Êïà„ÄÇ * Â¶ÇÊûúvalueÊòØ0,Áî®Êà∑ÂÖ≥Èó≠ÊµèËßàÂô®sessionÂ∞±‰ºöÂ§±Êïà„ÄÇ * Â¶ÇÊûúvalueÊòØNone,session‰ºö‰æùËµñÂÖ®Â±ÄsessionÂ§±ÊïàÁ≠ñÁï•„ÄÇ SeesionÁâàÈ™åËØÅÁôªÂΩï12345678910111213141516171819202122232425262728293031323334353637383940from functools import wrapsdef check_login(func): @wraps(func) def inner(request, *args, **kwargs): next_url = request.get_full_path() if request.session.get("user"): return func(request, *args, **kwargs) else: return redirect("/login/?next=&#123;&#125;".format(next_url)) return innerdef login(request): if request.method == "POST": user = request.POST.get("user") pwd = request.POST.get("pwd") if user == "alex" and pwd == "alex1234": # ËÆæÁΩÆsession request.session["user"] = user # Ëé∑ÂèñË∑≥Âà∞ÁôªÈôÜÈ°µÈù¢‰πãÂâçÁöÑURL next_url = request.GET.get("next") # Â¶ÇÊûúÊúâÔºåÂ∞±Ë∑≥ËΩ¨ÂõûÁôªÈôÜ‰πãÂâçÁöÑURL if next_url: return redirect(next_url) # Âê¶ÂàôÈªòËÆ§Ë∑≥ËΩ¨Âà∞indexÈ°µÈù¢ else: return redirect("/index/") return render(request, "login.html")@check_logindef logout(request): # Âà†Èô§ÊâÄÊúâÂΩìÂâçËØ∑Ê±ÇÁõ∏ÂÖ≥ÁöÑsession request.session.delete() return redirect("/login/")@check_logindef index(request): current_user = request.session.get("user", None) return render(request, "index.html", &#123;"user": current_user&#125;) Django‰∏≠ÁöÑSessionÈÖçÁΩÆ12345678910111213141516171819202122232425261. Êï∞ÊçÆÂ∫ìSessionSESSION_ENGINE = 'django.contrib.sessions.backends.db' # ÂºïÊìéÔºàÈªòËÆ§Ôºâ2. ÁºìÂ≠òSessionSESSION_ENGINE = 'django.contrib.sessions.backends.cache' # ÂºïÊìéSESSION_CACHE_ALIAS = 'default' # ‰ΩøÁî®ÁöÑÁºìÂ≠òÂà´ÂêçÔºàÈªòËÆ§ÂÜÖÂ≠òÁºìÂ≠òÔºå‰πüÂèØ‰ª•ÊòØmemcacheÔºâÔºåÊ≠§Â§ÑÂà´Âêç‰æùËµñÁºìÂ≠òÁöÑËÆæÁΩÆ3. Êñá‰ª∂SessionSESSION_ENGINE = 'django.contrib.sessions.backends.file' # ÂºïÊìéSESSION_FILE_PATH = None # ÁºìÂ≠òÊñá‰ª∂Ë∑ØÂæÑÔºåÂ¶ÇÊûú‰∏∫NoneÔºåÂàô‰ΩøÁî®tempfileÊ®°ÂùóËé∑Âèñ‰∏Ä‰∏™‰∏¥Êó∂Âú∞ÂùÄtempfile.gettempdir() 4. ÁºìÂ≠ò+Êï∞ÊçÆÂ∫ìSESSION_ENGINE = 'django.contrib.sessions.backends.cached_db' # ÂºïÊìé5. Âä†ÂØÜCookie SessionSESSION_ENGINE = 'django.contrib.sessions.backends.signed_cookies' # ÂºïÊìéÂÖ∂‰ªñÂÖ¨Áî®ËÆæÁΩÆÈ°πÔºöSESSION_COOKIE_NAME Ôºù "sessionid" # SessionÁöÑcookie‰øùÂ≠òÂú®ÊµèËßàÂô®‰∏äÊó∂ÁöÑkeyÔºåÂç≥ÔºösessionidÔºùÈöèÊú∫Â≠óÁ¨¶‰∏≤ÔºàÈªòËÆ§ÔºâSESSION_COOKIE_PATH Ôºù "/" # SessionÁöÑcookie‰øùÂ≠òÁöÑË∑ØÂæÑÔºàÈªòËÆ§ÔºâSESSION_COOKIE_DOMAIN = None # SessionÁöÑcookie‰øùÂ≠òÁöÑÂüüÂêçÔºàÈªòËÆ§ÔºâSESSION_COOKIE_SECURE = False # ÊòØÂê¶Https‰º†ËæìcookieÔºàÈªòËÆ§ÔºâSESSION_COOKIE_HTTPONLY = True # ÊòØÂê¶SessionÁöÑcookieÂè™ÊîØÊåÅhttp‰º†ËæìÔºàÈªòËÆ§ÔºâSESSION_COOKIE_AGE = 1209600 # SessionÁöÑcookieÂ§±ÊïàÊó•ÊúüÔºà2Âë®ÔºâÔºàÈªòËÆ§ÔºâSESSION_EXPIRE_AT_BROWSER_CLOSE = False # ÊòØÂê¶ÂÖ≥Èó≠ÊµèËßàÂô®‰ΩøÂæóSessionËøáÊúüÔºàÈªòËÆ§ÔºâSESSION_SAVE_EVERY_REQUEST = False # ÊòØÂê¶ÊØèÊ¨°ËØ∑Ê±ÇÈÉΩ‰øùÂ≠òSessionÔºåÈªòËÆ§‰øÆÊîπ‰πãÂêéÊâç‰øùÂ≠òÔºàÈªòËÆ§Ôºâ]]></content>
      <tags>
        <tag>Cookie</tag>
        <tag>Session</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Nginx_ÈÖçÁΩÆSSLËØÅ‰π¶]]></title>
    <url>%2F2019%2F04%2F05%2FNginx-%E9%85%8D%E7%BD%AESSL%E8%AF%81%E4%B9%A6%2F</url>
    <content type="text"><![CDATA[Ëé∑ÂèñËØÅ‰π¶Âπ∂‰∏ä‰º†Âà∞NgxÊúçÂä°Âô® Ê£ÄÊü•NgxÊòØÂê¶ÂÆâË£Ö‚Äìwith-http_ssl_moduleÊ®°Âùó ‰øÆÊîπnginxÈÖçÁΩÆÊñá‰ª∂ 123456789101112131415161718192021222324252627282930313233server &#123; listen 80; server_name *.zhaohongye.com; #return 301 https://$host$request_uri; return 301 https://zhaohongye.com;&#125;server &#123; listen 443 ssl; server_name zhaohongye.com www.zhaohongye.com; access_log /var/log/nginx/zhy.log main; error_log /var/log/nginx/zhy.error.log; ssl on; #sslÂäüËÉΩÂºÄÂêØ ssl_certificate sslfile/2027481_zhaohongye.com.pem; ssl_certificate_key sslfile/2027481_zhaohongye.com.key; location / &#123; proxy_set_header Host $host:$server_port; proxy_set_header X-Real-IP $remote_addr; proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for; proxy_set_header X-Forwarded-Proto $scheme; proxy_redirect http:// https://; proxy_pass http://127.0.0.1:4000; client_max_body_size 10M; proxy_set_header X-Forwarded-Host $host; proxy_set_header X-Forwarded-Server $host; # Required for new HTTP-based CLI proxy_http_version 1.1; proxy_request_buffering off; &#125;&#125; httpsËÆøÈóÆÈ™åËØÅ]]></content>
      <categories>
        <category>Nginx</category>
      </categories>
      <tags>
        <tag>Nginx</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Archer]]></title>
    <url>%2F2019%2F04%2F05%2FArcher-SQL%E8%87%AA%E5%8A%A8%E5%8C%96%E5%B9%B3%E5%8F%B0%2F</url>
    <content type="text"><![CDATA[ARCHER ‚Äî Ëá™Âä®ÂåñSQLÊìç‰ΩúÂπ≥Âè∞Âü∫‰∫éinceptionÁöÑËá™Âä®ÂåñSQLÊìç‰ΩúÂπ≥Âè∞ÔºåÊîØÊåÅSQLÊâßË°å„ÄÅLDAPËÆ§ËØÅ„ÄÅÂèëÈÇÆ‰ª∂„ÄÅOSC„ÄÅSQLÊü•ËØ¢„ÄÅSQL‰ºòÂåñÂª∫ËÆÆ„ÄÅÊùÉÈôêÁÆ°ÁêÜÁ≠âÂäüËÉΩÔºåÊîØÊåÅdockerÈïúÂÉè„ÄÇ GitHubÈ°πÁõÆÂú∞ÂùÄÔºöhttps://github.com/jly8866/archer ‰∏ªË¶ÅÂäüËÉΩ Ëá™Âä®ÂÆ°Ê†∏ÂèëËµ∑SQL‰∏äÁ∫øÔºåÂ∑•ÂçïÊèê‰∫§ÔºåÁî±inceptionËá™Âä®ÂÆ°Ê†∏ÔºåÂÆ°Ê†∏ÈÄöËøáÂêéÈúÄË¶ÅÁî±ÂÆ°Ê†∏‰∫∫ËøõË°å‰∫∫Â∑•ÂÆ°Ê†∏ ‰∫∫Â∑•ÂÆ°Ê†∏inceptionËá™Âä®ÂÆ°Ê†∏ÈÄöËøáÁöÑÂ∑•ÂçïÔºåÁî±ÂÖ∂‰ªñÁ†îÂèëÂ∑•Á®ãÂ∏àÊàñÁ†îÂèëÁªèÁêÜÊù•ÂÆ°Ê†∏ÔºåDBAÊìç‰ΩúÊâßË°åSQL‰∏∫‰ªÄ‰πàË¶ÅÊúâ‰∫∫Â∑•ÂÆ°Ê†∏ÔºüËøôÊòØÈÅµÂæ™ËøêÁª¥È¢ÜÂüüÁ∫ø‰∏äÊìç‰ΩúÁöÑÊµÅÁ®ãÊÑèËØÜÔºå‰∏Ä‰∏™Â∑•Á®ãÂ∏àË¶ÅËøõË°åÁ∫ø‰∏äÊï∞ÊçÆÂ∫ìSQLÊõ¥Êñ∞ÔºåÊúÄÂ•ΩÁî±Âè¶Â§ñ‰∏Ä‰∏™Â∑•Á®ãÂ∏àÊù•ÊääÂÖ≥ÂæàÂ§öÊó∂ÂÄôDBAÂπ∂‰∏çÁü•ÈÅìSQLÁöÑ‰∏öÂä°Âê´‰πâÔºåÊâÄ‰ª•‰∫∫Â∑•ÂÆ°Ê†∏ÊúÄÂ•ΩÁî±ÂÖ∂‰ªñÁ†îÂèëÂ∑•Á®ãÂ∏àÊàñÁ†îÂèëÁªèÁêÜÊù•ÂÆ°Ê†∏. ËøôÊòØarcherÁöÑËÆæËÆ°ÁêÜÂøµ ÂõûÊªöÊï∞ÊçÆÂ±ïÁ§∫Â∑•ÂçïÂÜÖÂèØÂ±ïÁ§∫ÂõûÊªöËØ≠Âè•ÔºåÊîØÊåÅ‰∏ÄÈîÆÊèê‰∫§ÂõûÊªöÂ∑•Âçï ÂÆöÊó∂ÊâßË°åSQLÂÆ°Ê†∏ÈÄöËøáÁöÑÂ∑•ÂçïÂèØÁî±DBAÈÄâÊã©ÂÆöÊó∂ÊâßË°åÔºåÊâßË°åÂâçÂèØ‰øÆÊîπÊâßË°åÊó∂Èó¥ÔºåÂèØÈöèÊó∂ÁªàÊ≠¢ pt-oscÊâßË°åÊîØÊåÅpt-oscÊâßË°åËøõÂ∫¶Â±ïÁ§∫ÔºåÂπ∂‰∏îÂèØ‰ª•ÁÇπÂáª‰∏≠Ê≠¢pt-oscËøõÁ®ã MySQLÊü•ËØ¢Â∫ì„ÄÅË°®„ÄÅÂÖ≥ÈîÆÂ≠óËá™Âä®Ë°•ÂÖ®Êü•ËØ¢ÁªìÊûúÈõÜÈôêÂà∂„ÄÅÊü•ËØ¢ÁªìÊûúÂØºÂá∫„ÄÅË°®ÁªìÊûÑÂ±ïÁ§∫„ÄÅÂ§öÁªìÊûúÈõÜÂ±ïÁ§∫ MySQLÊü•ËØ¢ÊùÉÈôêÁÆ°ÁêÜÂü∫‰∫éinceptionËß£ÊûêÊü•ËØ¢ËØ≠Âè•ÔºåÊü•ËØ¢ÊùÉÈôêÊîØÊåÅÈôêÂà∂Âà∞Ë°®Á∫ßÊü•ËØ¢ÊùÉÈôêÁî≥ËØ∑„ÄÅÂÆ°Ê†∏ÂíåÁÆ°ÁêÜÔºåÊîØÊåÅÂÆ°Ê†∏ÊµÅÁ®ãÈÖçÁΩÆÔºåÂ§öÁ∫ßÂÆ°Ê†∏ MySQLÊü•ËØ¢Âä®ÊÄÅËÑ±ÊïèÂü∫‰∫éinceptionËß£ÊûêÊü•ËØ¢ËØ≠Âè•ÔºåÈÖçÂêàËÑ±ÊïèÂ≠óÊÆµÈÖçÁΩÆ„ÄÅËÑ±ÊïèËßÑÂàô(Ê≠£ÂàôË°®ËææÂºè)ÂÆûÁé∞ÊïèÊÑüÊï∞ÊçÆÂä®ÊÄÅËÑ±Êïè ÊÖ¢Êó•ÂøóÁÆ°ÁêÜÂü∫‰∫épercona-toolkitÁöÑpt_query_digestÂàÜÊûêÂíåÂ≠òÂÇ®ÊÖ¢Êó•ÂøóÔºåÂπ∂Âú®webÁ´ØÂ±ïÁé∞ ÈÇÆ‰ª∂ÈÄöÁü•ÂèØÈÖçÁΩÆÈÇÆ‰ª∂ÊèêÈÜíÔºåÂØπ‰∏äÁ∫øÁî≥ËØ∑„ÄÅÊùÉÈôêÁî≥ËØ∑„ÄÅÂÆ°Ê†∏ÁªìÊûúÁ≠âËøõË°åÈÄöÁü•ÂØπÂºÇÂ∏∏ÁôªÂΩïËøõË°åÈÄöÁü• ÂÆâË£ÖÂÆâË£Ödocker „ÄÅgit1yum install -y docker git ‰∏ãËΩΩÈïúÂÉè123docker pull hhyo/inceptiondocker pull hhyo/archerdocker pull mysql:5.6.35 ÂàõÂª∫archerÈÖçÁΩÆÊñá‰ª∂ÊúçÂä°ÁõÆÂΩïÂÆö‰∏∫ /vcg/archer/ 1mkdir /vcg/archer/ 123456789101112131415161718192021222324vim /vcg/archer/inc.cnf[inception]general_log=1general_log_file=inception.logport=6669socket=/tmp/inc.socketcharacter-set-client-handshake=0character-set-server=utf8inception_remote_system_password=rootinception_remote_system_user=wzf1inception_remote_backup_port=3306inception_remote_backup_host=127.0.0.1inception_support_charset=utf8,utf8mb4inception_enable_nullable=0inception_check_primary_key=1inception_check_column_comment=1inception_check_table_comment=1inception_osc_on=OFFinception_osc_bin_dir=/usr/bininception_osc_min_table_size=1inception_osc_chunk_time=0.1inception_enable_blob_type=1inception_check_column_default_value=1 12wget https://github.com/jly8866/archer/blob/master/archer/settings.py‰øÆÊîπÂÖ∂‰∏≠ÁöÑÊï∞ÊçÆÂ∫ìÂú∞ÂùÄ„ÄÅÁî®Êà∑Âêç„ÄÅÂØÜÁ†Å ÂêØÂä®ÂÆπÂô®12345docker run --name inception -v /vcg/archer/inc.cnf:/etc/inc.cnf -p 6669:6669 -dti hhyo/inceptiondocker run --name mysql -p 3306:3306 -e MYSQL_ROOT_PASSWORD=123456 -d mysql:5.6.35docker run --name archer -v /vcg/archer/settings.py:/opt/archer/archer/settings.py -e NGINX_PORT=9123 -p 9123:9123 -dti hhyo/archer ÂàõÂª∫Êï∞ÊçÆÂ∫ì123mysql -uroot -pCREATE DATABASE IF NOT EXISTS archer_github DEFAULT CHARSET utf8 COLLATE utf8_general_ci; ÂàùÂßãÂåñÊï∞ÊçÆÂ∫ì12345678docker exec -ti archer /bin/bash cd /opt/archer source /opt/venv4archer/bin/activate # ÂàùÂßãÂåñÊï∞ÊçÆÂ∫ì python3 manage.py makemigrations sql python3 manage.py migrate # ÂàõÂª∫ÁÆ°ÁêÜÂëòË¥¶Âè∑ python3 manage.py createsuperuser ËÆøÈóÆÂú∞ÂùÄÔºö http://xxxx::9123/]]></content>
      <categories>
        <category>Archer</category>
      </categories>
      <tags>
        <tag>Archer</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hexo]]></title>
    <url>%2F2019%2F04%2F05%2FHexo-%E5%8D%9A%E5%AE%A2%2F</url>
    <content type="text"><![CDATA[Âø´ÈÄü„ÄÅÁÆÄÊ¥Å‰∏îÈ´òÊïàÁöÑÂçöÂÆ¢Ê°ÜÊû∂ÂÆòÁΩë: https://hexo.io ÁâπÁÇπË∂ÖÂø´ÈÄüÂ∫¶Node.js ÊâÄÂ∏¶Êù•ÁöÑË∂ÖÂø´ÁîüÊàêÈÄüÂ∫¶ÔºåËÆ©‰∏äÁôæ‰∏™È°µÈù¢Âú®Âá†ÁßíÂÜÖÁû¨Èó¥ÂÆåÊàêÊ∏≤Êüì„ÄÇ ÊîØÊåÅ MarkdownHexo ÊîØÊåÅ GitHub Flavored Markdown ÁöÑÊâÄÊúâÂäüËÉΩÔºåÁîöËá≥ÂèØ‰ª•Êï¥Âêà Octopress ÁöÑÂ§ßÂ§öÊï∞Êèí‰ª∂„ÄÇ ‰∏ÄÈîÆÈÉ®ÁΩ≤Âè™ÈúÄ‰∏ÄÊù°Êåá‰ª§Âç≥ÂèØÈÉ®ÁΩ≤Âà∞ GitHub Pages, Heroku ÊàñÂÖ∂‰ªñÁΩëÁ´ô„ÄÇ ‰∏∞ÂØåÁöÑÊèí‰ª∂Hexo Êã•ÊúâÂº∫Â§ßÁöÑÊèí‰ª∂Á≥ªÁªüÔºåÂÆâË£ÖÊèí‰ª∂ÂèØ‰ª•ËÆ© Hexo ÊîØÊåÅ Jade, CoffeeScript„ÄÇ 12345$ npm install hexo-cli -g$ hexo init blog$ cd blog$ npm install$ hexo server ÊúÄ‰Ω≥ÂÆûË∑µÂëΩ‰ª§Áº©ÂÜôhexoÊîØÊåÅÊåá‰ª§Áº©ÂÜôÔºå‰æãÂ¶ÇÔºöhexo generateÂíåhexo gÊòØÁ≠âÊïàÁöÑ„ÄÇd = deploy ÈÉ®ÁΩ≤g = generate ÁîüÊàêÈùôÊÄÅÈ°µÈù¢l = log ÂêØÂä®Êó•ËÆ∞ËÆ∞ÂΩïÔºå‰ΩøÁî®Ë¶ÜÁõñËÆ∞ÂΩïÊ†ºÂºèn = new Êñ∞Âª∫ÊñáÁ´†o = output ËÆæÁΩÆËæìÂá∫Ë∑ØÂæÑp = port ÈáçËÆæÁ´ØÂè£s = server ÂêØÂä®ÊúçÂä°Âô®w = watch ÁõëËßÜÊñá‰ª∂ÂèòÂä® ÁªÑÂêàÂëΩ‰ª§1hexo clean &amp;&amp; hexo g &amp;&amp; hexo d ‰øÆÊîπÈ¶ñÈ°µÂçöÂÆ¢‰∏∫È¢ÑËßàÊ®°Âºè12345vim themes/next/_config.ymlauto_excerpt: enable: false length: 150 Â∞Ü auto_excerptÁöÑenableÂèÇÊï∞Áî±falseÊîπ‰∏∫true]]></content>
      <categories>
        <category>Hexo</category>
      </categories>
      <tags>
        <tag>Hexo</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Kubernetes_Nginx-Ingress]]></title>
    <url>%2F2019%2F04%2F05%2FKubernetes-Nginx-Ingress%2F</url>
    <content type="text"><![CDATA[For example12345678910111213141516171819202122232425262728293031apiVersion: extensions/v1beta1kind: Ingressmetadata: annotations: nginx.ingress.kubernetes.io/force-ssl-redirect: 'true' #‰ª£Ë°®ÂÖ∂‰∏≠Ë∑≥ËΩ¨ nginx.ingress.kubernetes.io/service-weight: '' nginx.ingress.kubernetes.io/ssl-redirect: 'true' creationTimestamp: '2018-12-25T10:29:36Z' generation: 1 name: boss namespace: default resourceVersion: '21429383' selfLink: /apis/extensions/v1beta1/namespaces/default/ingresses/boss uid: fa56e2a0-082f-11e9-80cf-00163e0e2421spec: rules: - host: boss1.vcg.com http: paths: - backend: serviceName: node-vcg-boss servicePort: 80 path: / tls: - hosts: - boss1.vcg.com secretName: vcg-httpsstatus: loadBalancer: ingress: - ip: 39.97.21.16]]></content>
      <categories>
        <category>Kubernetes</category>
      </categories>
      <tags>
        <tag>Kubernetes</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Hello World]]></title>
    <url>%2F2019%2F04%2F03%2Fhello-world%2F</url>
    <content type="text"><![CDATA[Welcome to Hexo! This is your very first post. Check documentation for more info. If you get any problems when using Hexo, you can find the answer in troubleshooting or you can ask me on GitHub. Quick StartCreate a new post1$ hexo new "My New Post" More info: Writing Run server1$ hexo server More info: Server Generate static files1$ hexo generate More info: Generating Deploy to remote sites1$ hexo deploy More info: Deployment]]></content>
  </entry>
</search>
